2025-03-06 16:04:20,476 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:04:20,476 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:04:20,477 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-06 16:04:20,477 - TrafficRL - INFO - Starting training...
2025-03-06 16:04:20,477 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:04:20,477 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:04:20,881 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:04:21,706 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, Epsilon: 0.3897, LR: 0.000300, Traffic: uniform
2025-03-06 16:04:22,576 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 992.98, Avg Reward: 993.17, Epsilon: 0.1430, LR: 0.000285, Traffic: uniform
2025-03-06 16:04:23,429 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.83, Avg Reward: 994.06, Epsilon: 0.0525, LR: 0.000271, Traffic: uniform
2025-03-06 16:04:24,279 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 993.79, Avg Reward: 993.99, Epsilon: 0.0193, LR: 0.000257, Traffic: uniform
2025-03-06 16:04:25,157 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 995.17, Avg Reward: 994.23, Epsilon: 0.0100, LR: 0.000244, Traffic: uniform
2025-03-06 16:04:26,042 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 993.29, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000232, Traffic: uniform
2025-03-06 16:04:26,955 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 995.27, Avg Reward: 994.24, Epsilon: 0.0100, LR: 0.000221, Traffic: uniform
2025-03-06 16:04:36,670 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:04:36,671 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:04:36,671 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-06 16:04:36,671 - TrafficRL - INFO - Starting training...
2025-03-06 16:04:36,671 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:04:36,671 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:04:37,079 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:04:37,899 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, Epsilon: 0.3897, LR: 0.000300, Traffic: uniform
2025-03-06 16:05:02,947 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:05:02,948 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:05:02,948 - TrafficRL - ERROR - Model file not found: results/training/best_model.pth
2025-03-06 16:05:43,265 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:05:43,266 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:05:43,266 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-06 16:05:43,266 - TrafficRL - INFO - Starting training...
2025-03-06 16:05:43,267 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:05:43,267 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:05:43,707 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:05:44,513 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, Epsilon: 0.3897, LR: 0.000300, Traffic: uniform
2025-03-06 16:05:45,347 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 992.98, Avg Reward: 993.17, Epsilon: 0.1430, LR: 0.000285, Traffic: uniform
2025-03-06 16:05:46,172 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.83, Avg Reward: 994.06, Epsilon: 0.0525, LR: 0.000271, Traffic: uniform
2025-03-06 16:05:47,018 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 993.79, Avg Reward: 993.99, Epsilon: 0.0193, LR: 0.000257, Traffic: uniform
2025-03-06 16:05:47,883 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 995.17, Avg Reward: 994.23, Epsilon: 0.0100, LR: 0.000244, Traffic: uniform
2025-03-06 16:05:48,763 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 993.29, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000232, Traffic: uniform
2025-03-06 16:05:49,685 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 995.27, Avg Reward: 994.24, Epsilon: 0.0100, LR: 0.000221, Traffic: uniform
2025-03-06 16:05:50,600 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 992.59, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000210, Traffic: uniform
2025-03-06 16:05:51,529 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 993.65, Avg Reward: 993.99, Epsilon: 0.0100, LR: 0.000199, Traffic: uniform
2025-03-06 16:05:52,474 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 994.15, Avg Reward: 994.01, Epsilon: 0.0100, LR: 0.000189, Traffic: uniform
2025-03-06 16:05:53,429 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 984.81, Avg Reward: 993.17, Epsilon: 0.0100, LR: 0.000180, Traffic: uniform
2025-03-06 16:05:54,409 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 995.10, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000171, Traffic: uniform
2025-03-06 16:05:55,405 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 987.29, Avg Reward: 992.87, Epsilon: 0.0100, LR: 0.000162, Traffic: uniform
2025-03-06 16:05:56,420 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 966.01, Avg Reward: 990.95, Epsilon: 0.0100, LR: 0.000154, Traffic: uniform
2025-03-06 16:05:57,452 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 989.96, Avg Reward: 990.88, Epsilon: 0.0100, LR: 0.000146, Traffic: uniform
2025-03-06 16:05:58,509 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 992.89, Avg Reward: 991.01, Epsilon: 0.0100, LR: 0.000139, Traffic: uniform
2025-03-06 16:05:59,587 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 805.33, Avg Reward: 980.09, Epsilon: 0.0100, LR: 0.000132, Traffic: uniform
2025-03-06 16:06:00,676 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 508.63, Avg Reward: 953.90, Epsilon: 0.0100, LR: 0.000125, Traffic: uniform
2025-03-06 16:06:01,766 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 981.43, Avg Reward: 955.34, Epsilon: 0.0100, LR: 0.000119, Traffic: uniform
2025-03-06 16:06:02,881 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 992.37, Avg Reward: 957.20, Epsilon: 0.0100, LR: 0.000113, Traffic: uniform
2025-03-06 16:06:02,881 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-06 16:06:04,135 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 360348.29
2025-03-06 16:06:04,143 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-06 16:06:04,143 - TrafficRL.Train - INFO - New best model saved with reward: 360348.29
2025-03-06 16:06:05,286 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 988.27, Avg Reward: 958.68, Epsilon: 0.0100, LR: 0.000108, Traffic: uniform
2025-03-06 16:06:06,490 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 991.52, Avg Reward: 960.17, Epsilon: 0.0100, LR: 0.000102, Traffic: uniform
2025-03-06 16:06:07,656 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 992.39, Avg Reward: 961.57, Epsilon: 0.0100, LR: 0.000097, Traffic: uniform
2025-03-06 16:06:08,835 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 993.85, Avg Reward: 962.91, Epsilon: 0.0100, LR: 0.000092, Traffic: uniform
2025-03-06 16:06:10,037 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 992.81, Avg Reward: 964.11, Epsilon: 0.0100, LR: 0.000088, Traffic: uniform
2025-03-06 16:06:10,044 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_25.pth
2025-03-06 16:06:10,044 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-06 16:06:11,277 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 987.07, Avg Reward: 964.99, Epsilon: 0.0100, LR: 0.000083, Traffic: uniform
2025-03-06 16:06:12,538 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 990.65, Avg Reward: 965.94, Epsilon: 0.0100, LR: 0.000079, Traffic: uniform
2025-03-06 16:06:13,807 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 986.02, Avg Reward: 966.66, Epsilon: 0.0100, LR: 0.000075, Traffic: uniform
2025-03-06 16:06:15,186 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 991.83, Avg Reward: 967.53, Epsilon: 0.0100, LR: 0.000071, Traffic: uniform
2025-03-06 16:06:16,571 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 986.75, Avg Reward: 968.17, Epsilon: 0.0100, LR: 0.000068, Traffic: uniform
2025-03-06 16:06:17,942 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 992.91, Avg Reward: 968.97, Epsilon: 0.0100, LR: 0.000064, Traffic: uniform
2025-03-06 16:06:19,309 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 986.32, Avg Reward: 969.51, Epsilon: 0.0100, LR: 0.000061, Traffic: uniform
2025-03-06 16:06:20,665 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 988.60, Avg Reward: 970.09, Epsilon: 0.0100, LR: 0.000058, Traffic: uniform
2025-03-06 16:06:22,074 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 993.26, Avg Reward: 970.77, Epsilon: 0.0100, LR: 0.000055, Traffic: uniform
2025-03-06 16:06:23,516 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 989.88, Avg Reward: 971.32, Epsilon: 0.0100, LR: 0.000052, Traffic: uniform
2025-03-06 16:06:24,967 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 991.89, Avg Reward: 971.89, Epsilon: 0.0100, LR: 0.000050, Traffic: uniform
2025-03-06 16:06:26,544 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 995.92, Avg Reward: 972.54, Epsilon: 0.0100, LR: 0.000047, Traffic: uniform
2025-03-06 16:06:28,348 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 993.48, Avg Reward: 973.09, Epsilon: 0.0100, LR: 0.000045, Traffic: uniform
2025-03-06 16:06:28,613 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:06:28,613 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:06:28,613 - TrafficRL - INFO - Evaluating on uniform traffic pattern...
2025-03-06 16:06:28,614 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:06:28,614 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:06:29,060 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:06:29,066 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:06:29,983 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 982.94, Avg Reward: 973.34, Epsilon: 0.0100, LR: 0.000043, Traffic: uniform
2025-03-06 16:06:31,664 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 990.59, Avg Reward: 973.77, Epsilon: 0.0100, LR: 0.000041, Traffic: uniform
2025-03-06 16:06:31,665 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-06 16:06:32,958 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 230516.59
2025-03-06 16:06:32,958 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-06 16:06:34,426 - TrafficRL - INFO - Evaluation results for uniform:
2025-03-06 16:06:34,426 - TrafficRL - INFO -   Average Reward: 359948.58 ± 7117.86
2025-03-06 16:06:34,426 - TrafficRL - INFO -   Average Waiting Time: 134.51
2025-03-06 16:06:34,426 - TrafficRL - INFO -   Average Throughput: 11653751.31
2025-03-06 16:06:34,427 - TrafficRL - INFO - Evaluation results saved to results/evaluation/evaluation_results.json
2025-03-06 16:06:34,463 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 990.84, Avg Reward: 974.19, Epsilon: 0.0100, LR: 0.000039, Traffic: uniform
2025-03-06 16:06:36,001 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 990.92, Avg Reward: 974.59, Epsilon: 0.0100, LR: 0.000037, Traffic: uniform
2025-03-06 16:06:37,551 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 984.69, Avg Reward: 974.82, Epsilon: 0.0100, LR: 0.000035, Traffic: uniform
2025-03-06 16:06:39,222 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 994.76, Avg Reward: 975.27, Epsilon: 0.0100, LR: 0.000033, Traffic: uniform
2025-03-06 16:06:40,951 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 991.89, Avg Reward: 975.64, Epsilon: 0.0100, LR: 0.000031, Traffic: uniform
2025-03-06 16:06:42,613 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 995.96, Avg Reward: 976.09, Epsilon: 0.0100, LR: 0.000030, Traffic: uniform
2025-03-06 16:06:44,516 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 990.84, Avg Reward: 976.40, Epsilon: 0.0100, LR: 0.000028, Traffic: uniform
2025-03-06 16:06:46,174 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 990.75, Avg Reward: 976.70, Epsilon: 0.0100, LR: 0.000027, Traffic: uniform
2025-03-06 16:06:47,826 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 983.31, Avg Reward: 976.83, Epsilon: 0.0100, LR: 0.000026, Traffic: uniform
2025-03-06 16:06:49,604 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 993.68, Avg Reward: 977.17, Epsilon: 0.0100, LR: 0.000024, Traffic: uniform
2025-03-06 16:06:49,612 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_50.pth
2025-03-06 16:06:49,612 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-06 16:06:51,707 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 991.14, Avg Reward: 977.44, Epsilon: 0.0100, LR: 0.000023, Traffic: uniform
2025-03-06 16:06:53,538 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 991.89, Avg Reward: 977.72, Epsilon: 0.0100, LR: 0.000022, Traffic: uniform
2025-03-06 16:06:55,341 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 992.79, Avg Reward: 978.01, Epsilon: 0.0100, LR: 0.000021, Traffic: uniform
2025-03-06 16:06:57,092 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 995.05, Avg Reward: 978.32, Epsilon: 0.0100, LR: 0.000020, Traffic: uniform
2025-03-06 16:06:58,940 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 990.23, Avg Reward: 978.54, Epsilon: 0.0100, LR: 0.000019, Traffic: uniform
2025-03-06 16:07:00,728 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 995.68, Avg Reward: 978.84, Epsilon: 0.0100, LR: 0.000018, Traffic: uniform
2025-03-06 16:07:02,606 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 993.55, Avg Reward: 979.10, Epsilon: 0.0100, LR: 0.000017, Traffic: uniform
2025-03-06 16:07:04,470 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 988.77, Avg Reward: 979.27, Epsilon: 0.0100, LR: 0.000016, Traffic: uniform
2025-03-06 16:07:06,331 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 991.02, Avg Reward: 979.47, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-06 16:07:08,184 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 995.73, Avg Reward: 979.74, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-06 16:07:08,185 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-06 16:07:09,470 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 155853.52
2025-03-06 16:07:09,470 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-06 16:07:11,482 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 985.28, Avg Reward: 979.83, Epsilon: 0.0100, LR: 0.000014, Traffic: uniform
2025-03-06 16:07:13,525 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.21, Avg Reward: 980.05, Epsilon: 0.0100, LR: 0.000013, Traffic: uniform
2025-03-06 16:07:15,525 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 985.43, Avg Reward: 980.13, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-06 16:07:17,591 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 993.30, Avg Reward: 980.34, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-06 16:07:19,602 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 989.39, Avg Reward: 980.48, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-06 16:07:21,638 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 992.13, Avg Reward: 980.65, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-06 16:07:23,641 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 993.89, Avg Reward: 980.85, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-06 16:07:25,723 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 988.97, Avg Reward: 980.97, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-06 16:07:27,777 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 994.94, Avg Reward: 981.17, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-06 16:07:29,846 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 984.68, Avg Reward: 981.22, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-06 16:07:31,962 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 987.38, Avg Reward: 981.31, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-06 16:07:34,076 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 978.21, Avg Reward: 981.27, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-06 16:07:36,179 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 989.65, Avg Reward: 981.38, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-06 16:07:38,356 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 985.40, Avg Reward: 981.44, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-06 16:07:40,848 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 992.40, Avg Reward: 981.58, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-06 16:07:40,858 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_75.pth
2025-03-06 16:07:40,858 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-06 16:07:43,055 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 990.90, Avg Reward: 981.70, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-06 16:07:45,259 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 981.89, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-06 16:07:47,427 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 991.79, Avg Reward: 982.02, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-06 16:07:50,184 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 991.86, Avg Reward: 982.14, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-06 16:07:52,467 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 990.12, Avg Reward: 982.24, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-06 16:07:52,467 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-06 16:07:53,752 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 194654.10
2025-03-06 16:07:53,752 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-06 16:07:56,020 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 994.00, Avg Reward: 982.39, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-06 16:07:58,359 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 988.14, Avg Reward: 982.46, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-06 16:08:00,798 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 990.70, Avg Reward: 982.56, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-06 16:08:03,168 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 995.05, Avg Reward: 982.71, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-06 16:08:05,544 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 993.68, Avg Reward: 982.84, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-06 16:08:07,932 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 980.68, Avg Reward: 982.81, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-06 16:08:10,395 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 991.66, Avg Reward: 982.91, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-06 16:08:12,840 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 994.92, Avg Reward: 983.05, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:15,380 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 996.73, Avg Reward: 983.20, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:17,893 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 988.57, Avg Reward: 983.26, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:20,533 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 993.76, Avg Reward: 983.38, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:23,119 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 993.96, Avg Reward: 983.49, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:25,706 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 990.63, Avg Reward: 983.57, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:28,394 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 993.85, Avg Reward: 983.68, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-06 16:08:31,102 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 990.86, Avg Reward: 983.75, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-06 16:08:33,707 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 994.70, Avg Reward: 983.87, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-06 16:08:36,449 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 992.37, Avg Reward: 983.96, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-06 16:08:39,447 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 995.14, Avg Reward: 984.07, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-06 16:08:42,110 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 994.91, Avg Reward: 984.18, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-06 16:08:42,110 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-06 16:08:44,782 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 995.46, Avg Reward: 984.29, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-06 16:08:44,782 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-06 16:08:46,051 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 98443.74
2025-03-06 16:08:46,051 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-06 16:08:46,061 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_100.pth
2025-03-06 16:08:46,061 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-06 16:08:48,740 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 993.27, Avg Reward: 984.29, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-06 16:08:51,330 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 996.71, Avg Reward: 984.33, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-06 16:08:53,942 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 990.11, Avg Reward: 984.27, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-06 16:08:56,497 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 994.55, Avg Reward: 984.28, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-06 16:08:58,520 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:08:58,521 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:08:58,521 - TrafficRL - INFO - No model provided, using random actions
2025-03-06 16:08:58,521 - TrafficRL - INFO - Creating environment visualization: results/visualizations/traffic_sim_uniform_random_20250306_160858.mp4
2025-03-06 16:08:59,725 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 991.80, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:02,551 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 993.02, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:05,256 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 995.33, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:07,992 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 994.78, Avg Reward: 984.26, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:10,688 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 993.29, Avg Reward: 984.26, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:13,347 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 994.69, Avg Reward: 984.27, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:15,981 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 992.72, Avg Reward: 984.35, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:18,571 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 990.72, Avg Reward: 984.30, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:21,269 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 993.27, Avg Reward: 984.36, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:23,909 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 994.23, Avg Reward: 984.64, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:26,562 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 992.33, Avg Reward: 984.67, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:29,137 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 987.03, Avg Reward: 984.61, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:31,748 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 996.74, Avg Reward: 986.52, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:34,427 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 995.74, Avg Reward: 991.39, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:37,137 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 992.98, Avg Reward: 991.51, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:39,888 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 991.13, Avg Reward: 991.50, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:39,888 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-06 16:09:41,113 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 106344.63
2025-03-06 16:09:41,113 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-06 16:09:43,782 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 989.46, Avg Reward: 991.51, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:46,508 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 993.89, Avg Reward: 991.53, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:49,154 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 993.88, Avg Reward: 991.55, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:51,850 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 995.06, Avg Reward: 991.56, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:54,478 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 995.11, Avg Reward: 991.58, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-06 16:09:54,488 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_125.pth
2025-03-06 16:09:54,488 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-06 16:09:57,117 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 993.61, Avg Reward: 991.65, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:09:59,808 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 991.95, Avg Reward: 991.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:02,521 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 991.42, Avg Reward: 991.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:05,116 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 996.12, Avg Reward: 991.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:07,764 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 990.08, Avg Reward: 991.79, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:10,459 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 994.82, Avg Reward: 991.81, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:13,054 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 996.54, Avg Reward: 991.91, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:15,809 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 993.42, Avg Reward: 991.96, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:18,514 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 994.95, Avg Reward: 991.98, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:21,169 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 990.28, Avg Reward: 991.98, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:24,196 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 993.89, Avg Reward: 992.00, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:26,811 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 996.54, Avg Reward: 992.01, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:29,421 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 994.40, Avg Reward: 992.02, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:32,131 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 996.64, Avg Reward: 992.15, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:35,373 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 994.57, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:35,374 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-06 16:10:36,629 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 129038.54
2025-03-06 16:10:36,629 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-06 16:10:39,508 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 993.92, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:42,209 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 991.50, Avg Reward: 992.23, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:44,808 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 994.74, Avg Reward: 992.33, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:47,448 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 995.70, Avg Reward: 992.34, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:50,071 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 994.72, Avg Reward: 992.37, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:52,721 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 996.32, Avg Reward: 992.37, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:55,322 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 995.43, Avg Reward: 992.42, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:10:58,005 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:10:58,006 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:10:58,006 - TrafficRL - INFO - No model provided, using random actions
2025-03-06 16:10:58,006 - TrafficRL - INFO - Creating environment visualization: results/visualizations/traffic_sim_uniform_random_20250306_161058.mp4
2025-03-06 16:10:58,753 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 995.56, Avg Reward: 992.47, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:01,884 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 990.16, Avg Reward: 992.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:04,608 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 990.50, Avg Reward: 992.50, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:04,618 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_150.pth
2025-03-06 16:11:04,618 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-06 16:11:07,568 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 993.10, Avg Reward: 992.52, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:10,424 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.22, Avg Reward: 992.55, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:13,125 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 995.92, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:15,974 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 995.96, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:18,640 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 992.21, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:21,308 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 990.03, Avg Reward: 992.55, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:24,111 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 995.35, Avg Reward: 992.57, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:26,820 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 989.34, Avg Reward: 992.57, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:29,527 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 995.40, Avg Reward: 992.62, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:30,631 - TrafficRL - INFO - Animation saved to results/visualizations/traffic_sim_uniform_random_20250306_161058.mp4 with FFMpegWriter
2025-03-06 16:11:30,632 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_random_20250306_161058.mp4
2025-03-06 16:11:30,632 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_random_20250306_161058.mp4
2025-03-06 16:11:32,444 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 993.00, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:32,445 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-06 16:11:33,687 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 101362.45
2025-03-06 16:11:33,687 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-06 16:11:36,347 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 992.70, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:39,269 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 994.39, Avg Reward: 992.68, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:41,950 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 994.45, Avg Reward: 992.77, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:44,552 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 992.60, Avg Reward: 992.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:47,169 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 996.95, Avg Reward: 992.83, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:49,945 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 995.65, Avg Reward: 992.87, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:52,644 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 995.67, Avg Reward: 992.89, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:55,311 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 994.09, Avg Reward: 992.94, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:11:57,968 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 994.03, Avg Reward: 992.93, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:00,675 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 993.03, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:03,354 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 991.94, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:05,963 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 995.27, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:08,573 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.73, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:10,755 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:12:10,757 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:12:10,757 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:12:10,757 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:12:11,402 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:12:11,409 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:12:11,409 - TrafficRL - INFO - Model loaded from results/training/best_model.pth
2025-03-06 16:12:11,409 - TrafficRL - INFO - Creating environment visualization: results/visualizations/traffic_sim_uniform_trained_20250306_161211.mp4
2025-03-06 16:12:12,025 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 995.39, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:14,186 - TrafficRL - INFO - Animation saved to results/visualizations/traffic_sim_uniform_random_20250306_160858.mp4 with FFMpegWriter
2025-03-06 16:12:14,186 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_random_20250306_160858.mp4
2025-03-06 16:12:14,186 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_random_20250306_160858.mp4
2025-03-06 16:12:15,127 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 994.43, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:15,139 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_175.pth
2025-03-06 16:12:15,139 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-06 16:12:17,811 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 995.99, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:21,079 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 996.36, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:24,028 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 996.30, Avg Reward: 993.51, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:27,075 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 994.46, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:30,113 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 993.17, Avg Reward: 993.56, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:30,113 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-06 16:12:31,333 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 110604.08
2025-03-06 16:12:31,333 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-06 16:12:34,023 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 996.53, Avg Reward: 993.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:36,627 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 992.07, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:39,243 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 991.25, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:41,877 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 991.62, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:44,465 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 994.05, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:45,193 - TrafficRL - INFO - Animation saved to results/visualizations/traffic_sim_uniform_trained_20250306_161211.mp4 with FFMpegWriter
2025-03-06 16:12:45,193 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_trained_20250306_161211.mp4
2025-03-06 16:12:45,193 - TrafficRL - INFO - Visualization saved to results/visualizations/traffic_sim_uniform_trained_20250306_161211.mp4
2025-03-06 16:12:47,279 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 989.85, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:50,041 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 993.60, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:52,702 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 994.91, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:55,397 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 992.07, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:12:57,974 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 992.99, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:00,697 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 989.28, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:03,278 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 996.63, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:06,031 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 993.72, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:08,826 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 994.74, Avg Reward: 993.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:11,463 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 994.54, Avg Reward: 993.77, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:14,080 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 992.55, Avg Reward: 993.75, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:16,728 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 991.08, Avg Reward: 993.74, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:19,406 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 993.70, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:22,121 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 995.42, Avg Reward: 993.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-06 16:13:22,121 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-06 16:13:24,746 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 989.71, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:24,746 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-06 16:13:26,016 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 566000.76
2025-03-06 16:13:26,027 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-06 16:13:26,027 - TrafficRL.Train - INFO - New best model saved with reward: 566000.76
2025-03-06 16:13:26,038 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_200.pth
2025-03-06 16:13:26,038 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-06 16:13:28,737 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 993.83, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:31,318 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:13:31,319 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:13:31,319 - TrafficRL - INFO - Evaluating on uniform traffic pattern...
2025-03-06 16:13:31,319 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:13:31,319 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:13:31,655 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 993.05, Avg Reward: 993.64, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:31,752 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:13:31,759 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:13:34,538 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 994.46, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:37,222 - TrafficRL - INFO - Evaluation results for uniform:
2025-03-06 16:13:37,222 - TrafficRL - INFO -   Average Reward: 425980.29 ± 152201.22
2025-03-06 16:13:37,222 - TrafficRL - INFO -   Average Waiting Time: 114.90
2025-03-06 16:13:37,222 - TrafficRL - INFO -   Average Throughput: 12285538.45
2025-03-06 16:13:37,222 - TrafficRL - INFO - Evaluation results saved to results/evaluation/evaluation_results.json
2025-03-06 16:13:37,543 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 994.60, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:40,350 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 989.40, Avg Reward: 993.66, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:43,200 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 991.30, Avg Reward: 993.64, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:46,066 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 993.84, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:48,985 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 990.68, Avg Reward: 993.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:49,740 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:13:49,740 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:13:49,741 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:13:49,741 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:13:50,202 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:13:50,209 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:13:50,209 - TrafficRL - INFO - Model loaded from results/training/best_model.pth
2025-03-06 16:13:50,209 - TrafficRL - INFO - Creating environment visualization: results/videos/traffic_sim_uniform_trained_20250306_161350.mp4
2025-03-06 16:13:52,273 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 990.47, Avg Reward: 993.56, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:55,284 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 990.61, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:13:58,354 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 994.33, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:01,315 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 989.67, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:04,352 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 991.58, Avg Reward: 993.50, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:07,483 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 989.71, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:10,221 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 992.58, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:12,725 - TrafficRL - WARNING - FFmpeg writer failed: Command '['ffmpeg', '-f', 'rawvideo', '-vcodec', 'rawvideo', '-s', '3200x2000', '-pix_fmt', 'rgba', '-framerate', '30', '-loglevel', 'error', '-i', 'pipe:', '-vcodec', 'h264', '-pix_fmt', 'yuv420p', '-b', '5000k', '-metadata', 'title=Traffic Simulation', '-metadata', 'artist=RL Agent', '-y', 'results/videos/traffic_sim_uniform_trained_20250306_161350.mp4']' returned non-zero exit status 255.. Trying a different approach.
2025-03-06 16:14:12,725 - TrafficRL - ERROR - Failed to save animation: [Errno 2] No such file or directory: 'results/videos'
2025-03-06 16:14:12,725 - TrafficRL - INFO - Saving individual frames to results/videos/frames...
2025-03-06 16:14:13,074 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 991.89, Avg Reward: 993.51, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:15,781 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 991.52, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:18,561 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 994.02, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:21,538 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 991.01, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:24,303 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 990.65, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:24,303 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-06 16:14:25,569 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 567757.29
2025-03-06 16:14:25,580 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-06 16:14:25,580 - TrafficRL.Train - INFO - New best model saved with reward: 567757.29
2025-03-06 16:14:28,232 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 991.86, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:30,845 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 991.50, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:33,465 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 996.10, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:36,077 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 993.71, Avg Reward: 993.43, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:38,727 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 991.03, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:38,740 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_225.pth
2025-03-06 16:14:38,740 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-06 16:14:41,426 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 991.98, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:44,294 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 991.30, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:47,200 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 987.84, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:49,921 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 995.41, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:52,737 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 988.21, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:55,547 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 990.65, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:14:58,349 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 994.30, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:01,055 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 992.16, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:03,922 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 990.73, Avg Reward: 993.18, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:06,572 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 992.28, Avg Reward: 993.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:09,369 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 992.88, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:12,111 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 992.38, Avg Reward: 993.15, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:14,749 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 989.49, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:17,458 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 991.89, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:19,904 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:15:19,904 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:15:19,905 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:15:19,905 - TrafficRL - INFO -   TrainedDQN: results/training/best_model.pth
2025-03-06 16:15:19,919 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:15:19,919 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:15:20,378 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:15:20,385 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:15:20,564 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 993.85, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:20,564 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-06 16:15:21,901 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 563523.16
2025-03-06 16:15:21,901 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-06 16:15:24,455 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:15:24,455 - TrafficRL.Benchmark - INFO -   Average Reward: 414228.19 ± 146561.05
2025-03-06 16:15:24,455 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.98
2025-03-06 16:15:24,455 - TrafficRL.Benchmark - INFO -   Average Throughput: 12184889.42
2025-03-06 16:15:24,455 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=41.7%, EW=58.3%
2025-03-06 16:15:24,456 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:15:24,456 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:15:24,461 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:15:24,466 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:15:24,893 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 992.24, Avg Reward: 993.03, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:27,757 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 994.67, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:28,385 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:15:28,385 - TrafficRL.Benchmark - INFO -   Average Reward: 102270.83 ± 21975.98
2025-03-06 16:15:28,385 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 223.39
2025-03-06 16:15:28,385 - TrafficRL.Benchmark - INFO -   Average Throughput: 9210352.31
2025-03-06 16:15:28,385 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.4%, EW=89.6%
2025-03-06 16:15:28,386 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:15:28,386 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:15:28,391 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:15:28,397 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:15:30,593 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 994.56, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:32,422 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:15:32,422 - TrafficRL.Benchmark - INFO -   Average Reward: 549818.29 ± 46599.55
2025-03-06 16:15:32,422 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 80.71
2025-03-06 16:15:32,422 - TrafficRL.Benchmark - INFO -   Average Throughput: 13604102.28
2025-03-06 16:15:32,422 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.9%, EW=66.1%
2025-03-06 16:15:32,438 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_161519/benchmark_results.json
2025-03-06 16:15:33,790 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 993.93, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:35,069 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_161519/plots
2025-03-06 16:15:35,069 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:15:35,069 - TrafficRL - INFO -   TrainedDQN_uniform:
2025-03-06 16:15:35,069 - TrafficRL - INFO -     Reward: 414228.19 ± 146561.05
2025-03-06 16:15:35,069 - TrafficRL - INFO -     Waiting Time: 118.98
2025-03-06 16:15:35,069 - TrafficRL - INFO -     Throughput: 12184889.42
2025-03-06 16:15:35,069 - TrafficRL - INFO -   TrainedDQN_rush_hour:
2025-03-06 16:15:35,069 - TrafficRL - INFO -     Reward: 102270.83 ± 21975.98
2025-03-06 16:15:35,069 - TrafficRL - INFO -     Waiting Time: 223.39
2025-03-06 16:15:35,070 - TrafficRL - INFO -     Throughput: 9210352.31
2025-03-06 16:15:35,070 - TrafficRL - INFO -   TrainedDQN_weekend:
2025-03-06 16:15:35,070 - TrafficRL - INFO -     Reward: 549818.29 ± 46599.55
2025-03-06 16:15:35,070 - TrafficRL - INFO -     Waiting Time: 80.71
2025-03-06 16:15:35,070 - TrafficRL - INFO -     Throughput: 13604102.28
2025-03-06 16:15:36,482 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 994.46, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:39,306 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 989.88, Avg Reward: 992.97, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:42,002 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 989.17, Avg Reward: 992.91, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:44,790 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 984.80, Avg Reward: 992.80, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:47,457 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 991.55, Avg Reward: 992.82, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:50,218 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 992.04, Avg Reward: 992.83, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:50,232 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_250.pth
2025-03-06 16:15:50,232 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-06 16:15:52,900 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 987.78, Avg Reward: 992.78, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:55,516 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 988.23, Avg Reward: 992.72, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:15:58,273 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 993.38, Avg Reward: 992.70, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:00,954 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 987.60, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:03,685 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 990.94, Avg Reward: 992.60, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:06,344 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 991.15, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:09,119 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 988.73, Avg Reward: 992.54, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:11,827 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 993.39, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:14,562 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 994.60, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:17,248 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 993.94, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:16:17,248 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-06 16:16:18,579 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 559163.98
2025-03-06 16:16:18,579 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-06 16:16:21,239 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 991.64, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-06 16:18:12,884 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:18:12,885 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:18:12,885 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:18:12,885 - TrafficRL - INFO -   Random: random
2025-03-06 16:18:12,885 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:18:12,885 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:18:12,885 - TrafficRL - INFO -   TrainedDQN: results/training/best_model.pth
2025-03-06 16:18:12,896 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:12,896 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,306 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,307 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:18:13,307 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:18:13,308 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,308 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,312 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,312 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:18:13,312 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:18:13,313 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,313 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,317 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,317 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:18:13,317 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:18:13,318 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,318 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,322 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,323 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:18:13,323 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:18:13,324 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,324 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,328 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,328 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:18:13,328 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:18:13,329 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,329 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,333 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,333 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:18:13,333 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:18:13,333 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,333 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,338 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,338 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:18:13,338 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:18:13,338 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,338 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,343 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,343 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:18:13,343 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:18:13,343 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,343 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,348 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,348 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:18:13,348 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:18:13,348 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:13,348 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:13,352 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:13,359 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:18:17,174 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:18:17,174 - TrafficRL.Benchmark - INFO -   Average Reward: 414228.19 ± 146561.05
2025-03-06 16:18:17,174 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.98
2025-03-06 16:18:17,174 - TrafficRL.Benchmark - INFO -   Average Throughput: 12184889.42
2025-03-06 16:18:17,174 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=41.7%, EW=58.3%
2025-03-06 16:18:17,175 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:17,175 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:17,179 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:17,185 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:18:20,833 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:18:20,833 - TrafficRL.Benchmark - INFO -   Average Reward: 102270.83 ± 21975.98
2025-03-06 16:18:20,833 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 223.39
2025-03-06 16:18:20,833 - TrafficRL.Benchmark - INFO -   Average Throughput: 9210352.31
2025-03-06 16:18:20,833 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.4%, EW=89.6%
2025-03-06 16:18:20,834 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:18:20,834 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:18:20,838 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:18:20,844 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:18:24,676 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:18:24,677 - TrafficRL.Benchmark - INFO -   Average Reward: 549818.29 ± 46599.55
2025-03-06 16:18:24,677 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 80.71
2025-03-06 16:18:24,677 - TrafficRL.Benchmark - INFO -   Average Throughput: 13604102.28
2025-03-06 16:18:24,677 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.9%, EW=66.1%
2025-03-06 16:18:24,681 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_161812/benchmark_results.json
2025-03-06 16:18:27,240 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_161812/plots
2025-03-06 16:18:27,240 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:18:27,240 - TrafficRL - INFO -   TrainedDQN_uniform:
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Reward: 414228.19 ± 146561.05
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Waiting Time: 118.98
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Throughput: 12184889.42
2025-03-06 16:18:27,240 - TrafficRL - INFO -   TrainedDQN_rush_hour:
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Reward: 102270.83 ± 21975.98
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Waiting Time: 223.39
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Throughput: 9210352.31
2025-03-06 16:18:27,240 - TrafficRL - INFO -   TrainedDQN_weekend:
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Reward: 549818.29 ± 46599.55
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Waiting Time: 80.71
2025-03-06 16:18:27,240 - TrafficRL - INFO -     Throughput: 13604102.28
2025-03-06 16:20:16,867 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:20:16,868 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:20:21,930 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:20:21,931 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:21:22,051 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:21:22,052 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:21:22,052 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:21:22,052 - TrafficRL - INFO -   Random: random
2025-03-06 16:21:22,052 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:21:22,052 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:21:22,052 - TrafficRL - INFO -   TrainedDQN: results/training/best_model.pth
2025-03-06 16:21:22,064 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,064 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,498 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,498 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:21:22,498 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:21:22,499 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,499 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,503 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,503 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:21:22,503 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:21:22,504 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,504 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,509 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,509 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:21:22,509 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:21:22,509 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,509 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,514 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,515 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:21:22,515 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:21:22,515 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,515 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,520 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,520 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:21:22,520 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:21:22,520 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,520 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,525 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,525 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:21:22,525 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:21:22,525 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,526 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,530 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,531 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:21:22,531 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:21:22,531 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,531 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,536 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,536 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:21:22,536 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:21:22,537 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,537 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,541 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,541 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:21:22,541 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:21:22,542 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:22,542 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:22,547 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:22,552 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:21:26,373 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:21:26,373 - TrafficRL.Benchmark - INFO -   Average Reward: 414228.19 ± 146561.05
2025-03-06 16:21:26,373 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.98
2025-03-06 16:21:26,373 - TrafficRL.Benchmark - INFO -   Average Throughput: 12184889.42
2025-03-06 16:21:26,373 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=41.7%, EW=58.3%
2025-03-06 16:21:26,374 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:26,374 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:26,379 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:26,385 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:21:30,080 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:21:30,080 - TrafficRL.Benchmark - INFO -   Average Reward: 102270.83 ± 21975.98
2025-03-06 16:21:30,080 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 223.39
2025-03-06 16:21:30,080 - TrafficRL.Benchmark - INFO -   Average Throughput: 9210352.31
2025-03-06 16:21:30,080 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.4%, EW=89.6%
2025-03-06 16:21:30,080 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:21:30,080 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:21:30,085 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:21:30,091 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:21:33,868 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:21:33,868 - TrafficRL.Benchmark - INFO -   Average Reward: 549818.29 ± 46599.55
2025-03-06 16:21:33,868 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 80.71
2025-03-06 16:21:33,868 - TrafficRL.Benchmark - INFO -   Average Throughput: 13604102.28
2025-03-06 16:21:33,868 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.9%, EW=66.1%
2025-03-06 16:21:33,872 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162122/benchmark_results.json
2025-03-06 16:21:36,431 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_162122/plots
2025-03-06 16:21:36,432 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:21:36,432 - TrafficRL - INFO -   TrainedDQN_uniform:
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Reward: 414228.19 ± 146561.05
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Waiting Time: 118.98
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Throughput: 12184889.42
2025-03-06 16:21:36,432 - TrafficRL - INFO -   TrainedDQN_rush_hour:
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Reward: 102270.83 ± 21975.98
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Waiting Time: 223.39
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Throughput: 9210352.31
2025-03-06 16:21:36,432 - TrafficRL - INFO -   TrainedDQN_weekend:
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Reward: 549818.29 ± 46599.55
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Waiting Time: 80.71
2025-03-06 16:21:36,432 - TrafficRL - INFO -     Throughput: 13604102.28
2025-03-06 16:22:42,389 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:22:42,389 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:22:42,389 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:22:42,389 - TrafficRL - INFO -   Random: random
2025-03-06 16:22:42,389 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:22:42,389 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:22:42,401 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,401 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,827 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,827 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:42,827 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:42,828 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,828 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,833 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,833 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:42,833 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:42,834 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,834 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,838 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,838 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:42,838 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:42,838 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,838 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,843 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,844 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:42,844 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:42,844 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,844 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,848 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,849 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:42,849 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:42,849 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,849 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,853 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,853 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:42,853 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:42,854 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,854 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,858 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,859 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:42,859 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:42,859 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,859 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,864 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,864 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:42,864 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:42,864 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:42,864 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:42,868 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:42,868 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:42,868 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:42,872 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162242/benchmark_results.json
2025-03-06 16:22:42,961 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:22:42,961 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:22:42,962 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:22:55,426 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:22:55,428 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:22:55,428 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:22:55,428 - TrafficRL - INFO -   Random: random
2025-03-06 16:22:55,428 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:22:55,428 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:22:55,439 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,440 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,852 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,853 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:55,853 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:55,853 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,853 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,858 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,858 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:55,858 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:55,858 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,858 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,863 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,863 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:22:55,863 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:22:55,864 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,864 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,868 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,869 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:55,869 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:55,870 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,870 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,874 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,874 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:55,874 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:55,875 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,875 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,879 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,879 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:22:55,879 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:22:55,880 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,880 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,884 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,885 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:55,885 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:55,885 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,885 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,890 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,890 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:55,890 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:55,890 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:22:55,890 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:22:55,895 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:22:55,895 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:22:55,895 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:22:55,899 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162255/benchmark_results.json
2025-03-06 16:22:55,987 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:22:55,987 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:22:55,987 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:23:04,363 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:23:04,363 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:23:04,363 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:23:04,363 - TrafficRL - INFO -   Random: random
2025-03-06 16:23:04,363 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:23:04,363 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:23:04,375 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,375 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,792 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,792 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:04,792 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:04,793 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,793 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,797 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,797 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:04,797 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:04,798 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,798 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,802 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,802 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:04,802 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:04,803 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,803 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,808 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,809 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:04,809 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:04,809 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,809 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,813 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,814 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:04,814 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:04,814 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,814 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,818 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,818 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:04,818 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:04,819 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,819 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,823 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,823 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:04,823 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:04,824 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,824 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,828 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,828 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:04,828 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:04,829 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:04,829 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:04,833 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:04,833 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:04,833 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:04,838 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162304/benchmark_results.json
2025-03-06 16:23:04,928 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:23:04,928 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:23:04,929 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:23:24,424 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:23:24,425 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:23:24,425 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:23:24,425 - TrafficRL - INFO -   Random: random
2025-03-06 16:23:24,425 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:23:24,425 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:23:24,437 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,437 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,856 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,856 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:24,856 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:24,857 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,857 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,861 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,861 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:24,862 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:24,862 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,862 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,866 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,867 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:24,867 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:24,867 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,867 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,872 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,873 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:24,873 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:24,873 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,873 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,877 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,878 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:24,878 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:24,878 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,878 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,882 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,883 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:24,883 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:24,883 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,883 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,887 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,887 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:24,887 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:24,888 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,888 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,892 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,893 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:24,893 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:24,893 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:24,893 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:24,897 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:24,897 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:24,897 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:24,908 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162324/benchmark_results.json
2025-03-06 16:23:25,005 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:23:25,005 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:23:25,006 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:23:50,009 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:23:50,010 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:23:50,010 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:23:50,010 - TrafficRL - INFO -   Random: random
2025-03-06 16:23:50,010 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:23:50,010 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:23:50,022 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,022 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,431 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,431 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:50,431 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:50,432 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,432 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,436 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,437 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:50,437 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:50,437 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,437 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,441 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,442 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:23:50,442 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:23:50,442 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,442 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,447 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,448 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:50,448 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:50,448 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,448 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,453 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,453 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:50,453 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:50,453 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,453 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,457 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,457 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:23:50,458 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:23:50,458 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,458 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,462 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,462 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:50,462 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:50,462 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,462 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,467 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,467 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:50,467 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:50,467 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:23:50,467 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:23:50,471 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:23:50,471 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:23:50,471 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:23:50,476 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162350/benchmark_results.json
2025-03-06 16:23:50,563 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:23:50,563 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:23:50,564 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:24:06,284 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:24:06,285 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:24:06,285 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:24:06,285 - TrafficRL - INFO -   Random: random
2025-03-06 16:24:06,285 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:24:06,285 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:24:06,297 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,297 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,721 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,721 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:06,721 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:06,722 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,722 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,727 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,727 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:06,727 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:06,727 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,727 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,732 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,732 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:06,732 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:06,733 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,733 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,737 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,738 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:06,738 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:06,738 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,738 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,743 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,743 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:06,743 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:06,743 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,743 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,747 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,747 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:06,747 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:06,748 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,748 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,752 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,753 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:06,753 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:06,753 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,753 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,759 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,759 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:06,759 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:06,759 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:06,759 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:06,764 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:06,764 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:06,764 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:06,768 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162406/benchmark_results.json
2025-03-06 16:24:06,859 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:24:06,859 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:24:06,859 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:24:32,293 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:24:32,294 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:24:32,294 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:24:32,294 - TrafficRL - INFO -   Random: random
2025-03-06 16:24:32,294 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:24:32,294 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:24:32,305 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,305 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,752 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,753 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:32,753 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:32,753 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,753 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,758 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,758 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:32,758 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:32,758 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,758 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,763 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,763 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:32,763 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:32,763 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,763 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,768 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,769 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:32,769 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:32,769 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,770 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,774 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,774 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:32,774 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:32,774 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,775 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,779 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,779 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:32,779 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:32,780 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,780 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,784 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,784 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:32,784 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:32,785 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,785 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,789 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,789 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:32,789 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:32,790 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:32,790 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:32,794 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:32,795 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:32,795 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:32,799 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162432/benchmark_results.json
2025-03-06 16:24:32,886 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:24:32,887 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 294, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:24:32,887 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:24:44,478 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:24:44,478 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:24:44,478 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:24:44,478 - TrafficRL - INFO -   Random: random
2025-03-06 16:24:44,478 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:24:44,478 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:24:44,490 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,490 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,904 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,904 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:44,904 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:44,905 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,905 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,909 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,909 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:44,909 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:44,910 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,910 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,914 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,914 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:24:44,914 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:24:44,915 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,915 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,919 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,920 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:44,920 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:44,920 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,921 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,925 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,925 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:44,925 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:44,925 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,925 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,929 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,930 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:24:44,930 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:24:44,930 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,930 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,935 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,935 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:44,935 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:44,935 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,935 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,939 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,940 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:44,940 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:44,940 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:24:44,940 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:24:44,945 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:24:44,945 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:24:44,945 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:24:44,949 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162444/benchmark_results.json
2025-03-06 16:24:45,039 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:24:45,039 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 294, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:24:45,039 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:26:14,825 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:26:14,825 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:26:14,826 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:26:14,826 - TrafficRL - INFO -   Random: random
2025-03-06 16:26:14,826 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:26:14,826 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:26:14,837 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:14,837 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,266 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,266 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:26:15,266 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:26:15,267 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,267 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,272 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,272 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:26:15,272 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:26:15,272 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,272 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,276 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,277 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:26:15,277 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:26:15,277 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,277 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,281 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,282 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:26:15,283 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:26:15,283 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,283 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,287 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,288 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:26:15,288 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:26:15,288 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,288 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,292 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,293 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:26:15,293 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:26:15,293 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,293 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,298 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,298 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:26:15,298 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:26:15,298 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,298 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,302 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,303 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:26:15,303 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:26:15,303 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:26:15,303 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:26:15,308 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:26:15,308 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:26:15,308 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:26:15,311 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162614/benchmark_results.json
2025-03-06 16:26:15,404 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:26:15,404 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 294, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:26:15,404 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:27:15,007 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:27:15,008 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:27:15,008 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:27:15,008 - TrafficRL - INFO -   Random: random
2025-03-06 16:27:15,008 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:27:15,008 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:27:15,019 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,019 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,456 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,456 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:15,456 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:15,457 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,457 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,462 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,462 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:15,462 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:15,462 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,462 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,467 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,467 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:15,467 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:15,467 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,467 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,471 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,472 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:15,473 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:15,473 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,473 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,478 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,478 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:15,478 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:15,478 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,478 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,483 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,483 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:15,483 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:15,484 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,484 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,488 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,488 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:15,488 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:15,488 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,488 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,493 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,493 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:15,493 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:15,493 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:15,493 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:15,498 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:15,498 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:15,498 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:15,502 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162715/benchmark_results.json
2025-03-06 16:27:15,596 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:27:15,596 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 293, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:27:15,596 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:27:53,070 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:27:53,070 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:27:53,070 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:27:53,070 - TrafficRL - INFO -   Random: random
2025-03-06 16:27:53,070 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:27:53,070 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:27:53,082 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,082 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,510 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,510 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:53,510 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:53,511 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,511 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,516 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,516 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:53,516 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:53,517 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,517 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,521 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,521 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:27:53,521 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:27:53,522 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,522 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,526 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,527 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:53,527 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:53,527 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,527 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,532 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,532 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:53,532 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:53,533 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,533 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,537 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,537 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:27:53,537 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:27:53,538 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,538 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,542 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,542 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:53,542 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:53,542 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,542 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,547 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,547 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:53,547 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:53,547 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:27:53,547 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:27:53,552 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:27:53,552 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:27:53,552 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:27:53,557 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162753/benchmark_results.json
2025-03-06 16:27:53,650 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:27:53,651 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 294, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:27:53,651 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:28:05,374 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:28:05,375 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:28:05,375 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:28:05,375 - TrafficRL - INFO -   Random: random
2025-03-06 16:28:05,375 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:28:05,375 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:28:05,387 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,387 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,819 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,819 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:28:05,819 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:28:05,820 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,820 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,824 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,824 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:28:05,824 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:28:05,825 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,825 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,830 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,830 - TrafficRL.Agent - WARNING - Model file random not found
2025-03-06 16:28:05,830 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'Random' from random
2025-03-06 16:28:05,830 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,830 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,834 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,835 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:28:05,835 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:28:05,836 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,836 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,840 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,840 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:28:05,841 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:28:05,841 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,841 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,845 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,845 - TrafficRL.Agent - WARNING - Model file fixed not found
2025-03-06 16:28:05,845 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'FixedTiming' from fixed
2025-03-06 16:28:05,846 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,846 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,850 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,851 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:28:05,851 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:28:05,851 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,851 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,855 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,855 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:28:05,855 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:28:05,856 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:28:05,856 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:28:05,861 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:28:05,861 - TrafficRL.Agent - WARNING - Model file adaptive not found
2025-03-06 16:28:05,861 - TrafficRL.Benchmark - ERROR - Failed to load model for agent 'AdaptiveTiming' from adaptive
2025-03-06 16:28:05,865 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_162805/benchmark_results.json
2025-03-06 16:28:05,959 - TrafficRL.Benchmark - ERROR - Error creating benchmark visualizations: float division by zero
2025-03-06 16:28:05,959 - TrafficRL.Benchmark - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 294, in create_benchmark_visualizations
    width = 0.8 / len(agents)
            ~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-03-06 16:28:05,959 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:30:05,180 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:30:05,181 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:30:05,181 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:30:05,181 - TrafficRL - INFO -   Random: random
2025-03-06 16:30:05,181 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:30:05,181 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:30:05,181 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:30:05,181 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:30:05,181 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:30:05,181 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:32:25,725 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:32:25,725 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:32:25,726 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:32:25,726 - TrafficRL - INFO -   Random: random
2025-03-06 16:32:25,726 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:32:25,726 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:32:25,726 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:32:25,726 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:32:25,726 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:32:25,726 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:32:27,037 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-06 16:32:27,037 - TrafficRL.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-06 16:32:27,037 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-06 16:32:27,037 - TrafficRL.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-06 16:32:27,037 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:32:28,251 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-06 16:32:28,251 - TrafficRL.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-06 16:32:28,252 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-06 16:32:28,252 - TrafficRL.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-06 16:32:28,252 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:32:29,542 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-06 16:32:29,543 - TrafficRL.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-06 16:32:29,543 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-06 16:32:29,543 - TrafficRL.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-06 16:32:29,543 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:32:30,809 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-06 16:32:30,810 - TrafficRL.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-06 16:32:30,810 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-06 16:32:30,810 - TrafficRL.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-06 16:32:30,810 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-06 16:32:32,012 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-06 16:32:32,012 - TrafficRL.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-06 16:32:32,012 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-06 16:32:32,012 - TrafficRL.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-06 16:32:32,012 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-06 16:32:33,356 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-06 16:32:33,356 - TrafficRL.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-06 16:32:33,356 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-06 16:32:33,356 - TrafficRL.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-06 16:32:33,356 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:32:34,665 - TrafficRL.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-06 16:32:34,665 - TrafficRL.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-06 16:32:34,665 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-06 16:32:34,665 - TrafficRL.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-06 16:32:34,665 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:32:35,926 - TrafficRL.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-06 16:32:35,926 - TrafficRL.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-06 16:32:35,926 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-06 16:32:35,926 - TrafficRL.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-06 16:32:35,926 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:32:37,187 - TrafficRL.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-06 16:32:37,188 - TrafficRL.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-06 16:32:37,188 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-06 16:32:37,188 - TrafficRL.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-06 16:32:37,188 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:32:37,188 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:32:37,188 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:32:37,611 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:32:37,618 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:32:40,193 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:32:40,193 - TrafficRL.Benchmark - INFO -   Average Reward: 417194.73 ± 166931.45
2025-03-06 16:32:40,193 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.55
2025-03-06 16:32:40,193 - TrafficRL.Benchmark - INFO -   Average Throughput: 12220597.59
2025-03-06 16:32:40,193 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=43.4%, EW=56.6%
2025-03-06 16:32:40,194 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:32:40,194 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:32:40,198 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:32:40,204 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:32:42,624 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:32:42,624 - TrafficRL.Benchmark - INFO -   Average Reward: 108445.99 ± 23929.26
2025-03-06 16:32:42,624 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 222.37
2025-03-06 16:32:42,624 - TrafficRL.Benchmark - INFO -   Average Throughput: 9301348.74
2025-03-06 16:32:42,624 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.3%, EW=89.7%
2025-03-06 16:32:42,625 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:32:42,625 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:32:42,630 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:32:42,635 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:32:45,146 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:32:45,146 - TrafficRL.Benchmark - INFO -   Average Reward: 561659.41 ± 6898.47
2025-03-06 16:32:45,146 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 77.62
2025-03-06 16:32:45,146 - TrafficRL.Benchmark - INFO -   Average Throughput: 13740053.80
2025-03-06 16:32:45,146 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.6%, EW=66.4%
2025-03-06 16:32:45,151 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_163225/benchmark_results.json
2025-03-06 16:32:47,964 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_163225/plots
2025-03-06 16:32:47,965 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:33:17,313 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:33:17,314 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:33:17,314 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:33:17,314 - TrafficRL - INFO -   Random: random
2025-03-06 16:33:17,314 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:33:17,314 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:33:17,314 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:33:17,314 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:33:17,314 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:33:17,314 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:33:18,604 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-06 16:33:18,604 - TrafficRL.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-06 16:33:18,604 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-06 16:33:18,604 - TrafficRL.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-06 16:33:18,604 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:33:19,820 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-06 16:33:19,820 - TrafficRL.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-06 16:33:19,820 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-06 16:33:19,820 - TrafficRL.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-06 16:33:19,820 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:33:21,087 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-06 16:33:21,087 - TrafficRL.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-06 16:33:21,087 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-06 16:33:21,087 - TrafficRL.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-06 16:33:21,087 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:33:22,393 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-06 16:33:22,393 - TrafficRL.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-06 16:33:22,393 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-06 16:33:22,393 - TrafficRL.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-06 16:33:22,393 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-06 16:33:23,628 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-06 16:33:23,628 - TrafficRL.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-06 16:33:23,628 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-06 16:33:23,628 - TrafficRL.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-06 16:33:23,628 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-06 16:33:24,929 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-06 16:33:24,929 - TrafficRL.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-06 16:33:24,929 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-06 16:33:24,929 - TrafficRL.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-06 16:33:24,929 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:33:26,259 - TrafficRL.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-06 16:33:26,260 - TrafficRL.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-06 16:33:26,260 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-06 16:33:26,260 - TrafficRL.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-06 16:33:26,260 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:33:27,551 - TrafficRL.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-06 16:33:27,551 - TrafficRL.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-06 16:33:27,551 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-06 16:33:27,551 - TrafficRL.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-06 16:33:27,551 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:33:28,879 - TrafficRL.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-06 16:33:28,879 - TrafficRL.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-06 16:33:28,879 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-06 16:33:28,879 - TrafficRL.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-06 16:33:28,879 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:33:28,880 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:33:28,880 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:33:29,323 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:33:29,330 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:33:31,859 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:33:31,859 - TrafficRL.Benchmark - INFO -   Average Reward: 417194.73 ± 166931.45
2025-03-06 16:33:31,859 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.55
2025-03-06 16:33:31,859 - TrafficRL.Benchmark - INFO -   Average Throughput: 12220597.59
2025-03-06 16:33:31,859 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=43.4%, EW=56.6%
2025-03-06 16:33:31,860 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:33:31,860 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:33:31,865 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:33:31,870 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:33:34,331 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:33:34,332 - TrafficRL.Benchmark - INFO -   Average Reward: 108445.99 ± 23929.26
2025-03-06 16:33:34,332 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 222.37
2025-03-06 16:33:34,332 - TrafficRL.Benchmark - INFO -   Average Throughput: 9301348.74
2025-03-06 16:33:34,332 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.3%, EW=89.7%
2025-03-06 16:33:34,332 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:33:34,333 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:33:34,337 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:33:34,342 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:33:36,886 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:33:36,886 - TrafficRL.Benchmark - INFO -   Average Reward: 561659.41 ± 6898.47
2025-03-06 16:33:36,886 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 77.62
2025-03-06 16:33:36,886 - TrafficRL.Benchmark - INFO -   Average Throughput: 13740053.80
2025-03-06 16:33:36,886 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.6%, EW=66.4%
2025-03-06 16:33:36,891 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_163317/benchmark_results.json
2025-03-06 16:33:39,721 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_163317/plots
2025-03-06 16:33:39,722 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:33:39,722 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-06 16:33:39,722 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-06 16:33:39,722 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296203.02, Waiting=149.49
2025-03-06 16:33:39,722 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-06 16:33:39,722 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-06 16:33:39,722 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=234542.63, Waiting=162.97
2025-03-06 16:33:39,722 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-06 16:33:39,722 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-06 16:33:39,722 - TrafficRL - INFO -   Random_weekend: Reward=237832.00, Waiting=165.40
2025-03-06 16:33:39,722 - TrafficRL - INFO -   TrainedDQN_uniform: Reward=417194.73, Waiting=118.55
2025-03-06 16:33:39,722 - TrafficRL - INFO -   TrainedDQN_rush_hour: Reward=108445.99, Waiting=222.37
2025-03-06 16:33:39,722 - TrafficRL - INFO -   TrainedDQN_weekend: Reward=561659.41, Waiting=77.62
2025-03-06 16:34:11,438 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:34:11,439 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:34:11,439 - TrafficRL - INFO - Benchmarking agents:
2025-03-06 16:34:11,439 - TrafficRL - INFO -   Random: random
2025-03-06 16:34:11,439 - TrafficRL - INFO -   FixedTiming: fixed
2025-03-06 16:34:11,439 - TrafficRL - INFO -   AdaptiveTiming: adaptive
2025-03-06 16:34:11,439 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:34:11,439 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:34:11,439 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:34:11,439 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:34:12,760 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-06 16:34:12,761 - TrafficRL.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-06 16:34:12,761 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-06 16:34:12,761 - TrafficRL.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-06 16:34:12,761 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:34:14,014 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-06 16:34:14,014 - TrafficRL.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-06 16:34:14,014 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-06 16:34:14,014 - TrafficRL.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-06 16:34:14,014 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:34:15,314 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-06 16:34:15,314 - TrafficRL.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-06 16:34:15,314 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-06 16:34:15,314 - TrafficRL.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-06 16:34:15,314 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:34:16,654 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-06 16:34:16,654 - TrafficRL.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-06 16:34:16,654 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-06 16:34:16,655 - TrafficRL.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-06 16:34:16,655 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-06 16:34:17,902 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-06 16:34:17,902 - TrafficRL.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-06 16:34:17,902 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-06 16:34:17,902 - TrafficRL.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-06 16:34:17,902 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-06 16:34:19,204 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-06 16:34:19,204 - TrafficRL.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-06 16:34:19,204 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-06 16:34:19,204 - TrafficRL.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-06 16:34:19,204 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:34:20,509 - TrafficRL.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-06 16:34:20,509 - TrafficRL.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-06 16:34:20,509 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-06 16:34:20,509 - TrafficRL.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-06 16:34:20,509 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:34:21,790 - TrafficRL.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-06 16:34:21,790 - TrafficRL.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-06 16:34:21,790 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-06 16:34:21,790 - TrafficRL.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-06 16:34:21,790 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:34:23,091 - TrafficRL.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-06 16:34:23,091 - TrafficRL.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-06 16:34:23,091 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-06 16:34:23,091 - TrafficRL.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-06 16:34:23,091 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:34:23,092 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:34:23,092 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:34:23,499 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:34:23,506 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:34:26,017 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:34:26,017 - TrafficRL.Benchmark - INFO -   Average Reward: 417194.73 ± 166931.45
2025-03-06 16:34:26,017 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.55
2025-03-06 16:34:26,017 - TrafficRL.Benchmark - INFO -   Average Throughput: 12220597.59
2025-03-06 16:34:26,017 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=43.4%, EW=56.6%
2025-03-06 16:34:26,018 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:34:26,018 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:34:26,023 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:34:26,028 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:34:28,474 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:34:28,475 - TrafficRL.Benchmark - INFO -   Average Reward: 108445.99 ± 23929.26
2025-03-06 16:34:28,475 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 222.37
2025-03-06 16:34:28,475 - TrafficRL.Benchmark - INFO -   Average Throughput: 9301348.74
2025-03-06 16:34:28,475 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.3%, EW=89.7%
2025-03-06 16:34:28,475 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:34:28,475 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:34:28,480 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:34:28,485 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:34:31,035 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:34:31,035 - TrafficRL.Benchmark - INFO -   Average Reward: 561659.41 ± 6898.47
2025-03-06 16:34:31,035 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 77.62
2025-03-06 16:34:31,035 - TrafficRL.Benchmark - INFO -   Average Throughput: 13740053.80
2025-03-06 16:34:31,035 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.6%, EW=66.4%
2025-03-06 16:34:31,040 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_163411/benchmark_results.json
2025-03-06 16:34:33,890 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_163411/plots
2025-03-06 16:34:33,890 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:34:33,890 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-06 16:34:33,890 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-06 16:34:33,890 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296203.02, Waiting=149.49
2025-03-06 16:34:33,890 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-06 16:34:33,890 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-06 16:34:33,890 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=234542.63, Waiting=162.97
2025-03-06 16:34:33,890 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-06 16:34:33,890 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-06 16:34:33,890 - TrafficRL - INFO -   Random_weekend: Reward=237832.00, Waiting=165.40
2025-03-06 16:34:33,890 - TrafficRL - INFO -   TrainedDQN_uniform: Reward=417194.73, Waiting=118.55
2025-03-06 16:34:33,890 - TrafficRL - INFO -   TrainedDQN_rush_hour: Reward=108445.99, Waiting=222.37
2025-03-06 16:34:33,891 - TrafficRL - INFO -   TrainedDQN_weekend: Reward=561659.41, Waiting=77.62
2025-03-06 16:36:51,046 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:36:51,047 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:37:07,690 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:37:07,691 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:37:17,470 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:37:17,471 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:37:17,471 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:37:17,471 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:37:17,471 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:37:17,471 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:37:18,766 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-06 16:37:18,766 - TrafficRL.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-06 16:37:18,767 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-06 16:37:18,767 - TrafficRL.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-06 16:37:18,767 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:37:19,993 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-06 16:37:19,993 - TrafficRL.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-06 16:37:19,993 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-06 16:37:19,993 - TrafficRL.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-06 16:37:19,993 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:37:21,277 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-06 16:37:21,277 - TrafficRL.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-06 16:37:21,277 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-06 16:37:21,277 - TrafficRL.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-06 16:37:21,277 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:37:22,591 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-06 16:37:22,591 - TrafficRL.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-06 16:37:22,591 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-06 16:37:22,591 - TrafficRL.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-06 16:37:22,591 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-06 16:37:23,824 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-06 16:37:23,824 - TrafficRL.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-06 16:37:23,824 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-06 16:37:23,824 - TrafficRL.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-06 16:37:23,824 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-06 16:37:25,108 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-06 16:37:25,108 - TrafficRL.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-06 16:37:25,108 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-06 16:37:25,108 - TrafficRL.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-06 16:37:25,108 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:37:26,402 - TrafficRL.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-06 16:37:26,402 - TrafficRL.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-06 16:37:26,402 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-06 16:37:26,402 - TrafficRL.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-06 16:37:26,402 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:37:27,666 - TrafficRL.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-06 16:37:27,667 - TrafficRL.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-06 16:37:27,667 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-06 16:37:27,667 - TrafficRL.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-06 16:37:27,667 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:37:28,986 - TrafficRL.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-06 16:37:28,987 - TrafficRL.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-06 16:37:28,987 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-06 16:37:28,987 - TrafficRL.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-06 16:37:28,987 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:37:28,987 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:37:28,987 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:37:29,407 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:37:29,414 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:37:31,914 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on uniform:
2025-03-06 16:37:31,914 - TrafficRL.Benchmark - INFO -   Average Reward: 417194.73 ± 166931.45
2025-03-06 16:37:31,914 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.55
2025-03-06 16:37:31,914 - TrafficRL.Benchmark - INFO -   Average Throughput: 12220597.59
2025-03-06 16:37:31,914 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=43.4%, EW=56.6%
2025-03-06 16:37:31,915 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:37:31,915 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:37:31,920 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:37:31,925 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:37:34,348 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on rush_hour:
2025-03-06 16:37:34,348 - TrafficRL.Benchmark - INFO -   Average Reward: 108445.99 ± 23929.26
2025-03-06 16:37:34,348 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 222.37
2025-03-06 16:37:34,348 - TrafficRL.Benchmark - INFO -   Average Throughput: 9301348.74
2025-03-06 16:37:34,348 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.3%, EW=89.7%
2025-03-06 16:37:34,349 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:37:34,349 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:37:34,353 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:37:34,358 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:37:36,849 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedDQN on weekend:
2025-03-06 16:37:36,849 - TrafficRL.Benchmark - INFO -   Average Reward: 561659.41 ± 6898.47
2025-03-06 16:37:36,849 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 77.62
2025-03-06 16:37:36,849 - TrafficRL.Benchmark - INFO -   Average Throughput: 13740053.80
2025-03-06 16:37:36,849 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.6%, EW=66.4%
2025-03-06 16:37:36,854 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250306_163717/benchmark_results.json
2025-03-06 16:37:39,672 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250306_163717/plots
2025-03-06 16:37:39,672 - TrafficRL - INFO - Benchmark Summary:
2025-03-06 16:37:39,672 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-06 16:37:39,672 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-06 16:37:39,672 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296203.02, Waiting=149.49
2025-03-06 16:37:39,672 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-06 16:37:39,672 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-06 16:37:39,672 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=234542.63, Waiting=162.97
2025-03-06 16:37:39,672 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-06 16:37:39,673 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-06 16:37:39,673 - TrafficRL - INFO -   Random_weekend: Reward=237832.00, Waiting=165.40
2025-03-06 16:37:39,673 - TrafficRL - INFO -   TrainedDQN_uniform: Reward=417194.73, Waiting=118.55
2025-03-06 16:37:39,673 - TrafficRL - INFO -   TrainedDQN_rush_hour: Reward=108445.99, Waiting=222.37
2025-03-06 16:37:39,673 - TrafficRL - INFO -   TrainedDQN_weekend: Reward=561659.41, Waiting=77.62
2025-03-06 16:38:12,628 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:38:12,629 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:41:20,167 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:41:20,168 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:41:47,204 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:41:47,205 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:41:59,486 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:41:59,487 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:47:41,244 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:47:41,244 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:47:54,601 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:47:54,601 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:47:54,603 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:47:54,603 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:47:54,603 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:47:54,603 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-06 16:47:55,881 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-06 16:47:55,881 - TrafficRL.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-06 16:47:55,881 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-06 16:47:55,881 - TrafficRL.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-06 16:47:55,881 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:47:57,091 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-06 16:47:57,091 - TrafficRL.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-06 16:47:57,091 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-06 16:47:57,091 - TrafficRL.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-06 16:47:57,091 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:47:58,366 - TrafficRL.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-06 16:47:58,366 - TrafficRL.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-06 16:47:58,366 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-06 16:47:58,366 - TrafficRL.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-06 16:47:58,366 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-06 16:47:59,681 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-06 16:47:59,682 - TrafficRL.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-06 16:47:59,682 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-06 16:47:59,682 - TrafficRL.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-06 16:47:59,682 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-06 16:48:00,892 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-06 16:48:00,892 - TrafficRL.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-06 16:48:00,892 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-06 16:48:00,892 - TrafficRL.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-06 16:48:00,892 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-06 16:48:02,144 - TrafficRL.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-06 16:48:02,145 - TrafficRL.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-06 16:48:02,145 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-06 16:48:02,145 - TrafficRL.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-06 16:48:02,145 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:48:03,411 - TrafficRL.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-06 16:48:03,411 - TrafficRL.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-06 16:48:03,411 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-06 16:48:03,411 - TrafficRL.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-06 16:48:03,411 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:48:04,638 - TrafficRL.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-06 16:48:04,638 - TrafficRL.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-06 16:48:04,638 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-06 16:48:04,638 - TrafficRL.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-06 16:48:04,638 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-06 16:48:05,906 - TrafficRL.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-06 16:48:05,906 - TrafficRL.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-06 16:48:05,906 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-06 16:48:05,906 - TrafficRL.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-06 16:48:05,906 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-06 16:48:05,906 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:48:05,906 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:48:06,313 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:48:06,320 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:48:08,822 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-06 16:48:08,822 - TrafficRL.Benchmark - INFO -   Average Reward: 417194.73 ± 166931.45
2025-03-06 16:48:08,822 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 118.55
2025-03-06 16:48:08,822 - TrafficRL.Benchmark - INFO -   Average Throughput: 12220597.59
2025-03-06 16:48:08,822 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=43.4%, EW=56.6%
2025-03-06 16:48:08,823 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:48:08,823 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:48:08,828 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:48:08,833 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:48:11,296 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-06 16:48:11,296 - TrafficRL.Benchmark - INFO -   Average Reward: 108445.99 ± 23929.26
2025-03-06 16:48:11,297 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 222.37
2025-03-06 16:48:11,297 - TrafficRL.Benchmark - INFO -   Average Throughput: 9301348.74
2025-03-06 16:48:11,297 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=10.3%, EW=89.7%
2025-03-06 16:48:11,297 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-06 16:48:11,297 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-06 16:48:11,302 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-06 16:48:11,307 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-06 16:48:13,804 - TrafficRL.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-06 16:48:13,804 - TrafficRL.Benchmark - INFO -   Average Reward: 561659.41 ± 6898.47
2025-03-06 16:48:13,804 - TrafficRL.Benchmark - INFO -   Average Waiting Time: 77.62
2025-03-06 16:48:13,804 - TrafficRL.Benchmark - INFO -   Average Throughput: 13740053.80
2025-03-06 16:48:13,804 - TrafficRL.Benchmark - INFO -   Action Distribution: NS=33.6%, EW=66.4%
2025-03-06 16:48:13,811 - TrafficRL.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250306_164754/benchmark/benchmark_20250306_164754/benchmark_results.json
2025-03-06 16:48:16,618 - TrafficRL.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250306_164754/benchmark/benchmark_20250306_164754/plots
2025-03-06 16:48:16,774 - TrafficRL.Utils.Analysis - INFO - Comparative analysis completed and saved to results/analysis/analysis_20250306_164754/comparative
2025-03-06 16:48:16,774 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250306_164754/report/analysis_report.html
2025-03-06 16:48:16,775 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250306_164754
2025-03-06 16:48:16,775 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250306_164754/report/analysis_report.html
2025-03-06 16:50:18,713 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-06 16:50:18,713 - TrafficRL - INFO - Random seed set to 42
2025-03-06 16:50:18,714 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-06 16:50:18,714 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-06 16:50:18,714 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-06 16:50:18,714 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 20:14:38,420 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 20:14:38,424 - TrafficRL - INFO - Random seed set to 42
2025-03-08 20:14:38,425 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-08 20:14:38,425 - TrafficRL - INFO - Starting training...
2025-03-08 20:14:38,426 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 20:14:38,426 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 20:14:40,688 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 20:14:43,585 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, Epsilon: 0.3897, LR: 0.000300, Traffic: uniform
2025-03-08 20:14:46,428 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 992.98, Avg Reward: 993.17, Epsilon: 0.1430, LR: 0.000285, Traffic: uniform
2025-03-08 20:14:49,207 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.73, Avg Reward: 994.02, Epsilon: 0.0525, LR: 0.000271, Traffic: uniform
2025-03-08 20:14:51,875 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 855.52, Avg Reward: 959.40, Epsilon: 0.0193, LR: 0.000257, Traffic: uniform
2025-03-08 20:14:54,624 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 960.43, Avg Reward: 959.60, Epsilon: 0.0100, LR: 0.000244, Traffic: uniform
2025-03-08 20:14:57,403 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 900.34, Avg Reward: 949.73, Epsilon: 0.0100, LR: 0.000232, Traffic: uniform
2025-03-08 20:15:00,477 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 961.25, Avg Reward: 951.37, Epsilon: 0.0100, LR: 0.000221, Traffic: uniform
2025-03-08 20:15:03,456 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 983.22, Avg Reward: 955.35, Epsilon: 0.0100, LR: 0.000210, Traffic: uniform
2025-03-08 20:15:06,416 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 979.63, Avg Reward: 958.05, Epsilon: 0.0100, LR: 0.000199, Traffic: uniform
2025-03-08 20:15:09,484 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 989.09, Avg Reward: 961.15, Epsilon: 0.0100, LR: 0.000189, Traffic: uniform
2025-03-08 20:15:12,575 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 987.55, Avg Reward: 963.55, Epsilon: 0.0100, LR: 0.000180, Traffic: uniform
2025-03-08 20:15:15,970 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 994.16, Avg Reward: 966.11, Epsilon: 0.0100, LR: 0.000171, Traffic: uniform
2025-03-08 20:15:19,388 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 987.29, Avg Reward: 967.73, Epsilon: 0.0100, LR: 0.000162, Traffic: uniform
2025-03-08 20:15:22,705 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 989.86, Avg Reward: 969.32, Epsilon: 0.0100, LR: 0.000154, Traffic: uniform
2025-03-08 20:15:26,046 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 986.01, Avg Reward: 970.43, Epsilon: 0.0100, LR: 0.000146, Traffic: uniform
2025-03-08 20:15:29,507 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 990.35, Avg Reward: 971.67, Epsilon: 0.0100, LR: 0.000139, Traffic: uniform
2025-03-08 20:15:32,938 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 989.93, Avg Reward: 972.75, Epsilon: 0.0100, LR: 0.000132, Traffic: uniform
2025-03-08 20:15:36,431 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 992.79, Avg Reward: 973.86, Epsilon: 0.0100, LR: 0.000125, Traffic: uniform
2025-03-08 20:15:39,959 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 993.63, Avg Reward: 974.90, Epsilon: 0.0100, LR: 0.000119, Traffic: uniform
2025-03-08 20:15:43,619 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 989.49, Avg Reward: 975.63, Epsilon: 0.0100, LR: 0.000113, Traffic: uniform
2025-03-08 20:15:43,620 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-08 20:15:48,578 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 45680.13
2025-03-08 20:15:48,610 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:15:48,611 - TrafficRL.Train - INFO - New best model saved with reward: 45680.13
2025-03-08 20:15:52,453 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 988.27, Avg Reward: 976.23, Epsilon: 0.0100, LR: 0.000108, Traffic: uniform
2025-03-08 20:15:56,603 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 994.38, Avg Reward: 977.06, Epsilon: 0.0100, LR: 0.000102, Traffic: uniform
2025-03-08 20:16:00,874 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 992.39, Avg Reward: 977.72, Epsilon: 0.0100, LR: 0.000097, Traffic: uniform
2025-03-08 20:16:04,646 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 994.41, Avg Reward: 978.42, Epsilon: 0.0100, LR: 0.000092, Traffic: uniform
2025-03-08 20:16:08,400 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 988.22, Avg Reward: 978.81, Epsilon: 0.0100, LR: 0.000088, Traffic: uniform
2025-03-08 20:16:08,430 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_25.pth
2025-03-08 20:16:08,430 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-08 20:16:12,709 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 994.25, Avg Reward: 979.41, Epsilon: 0.0100, LR: 0.000083, Traffic: uniform
2025-03-08 20:16:17,291 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 994.92, Avg Reward: 979.98, Epsilon: 0.0100, LR: 0.000079, Traffic: uniform
2025-03-08 20:16:22,124 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 992.77, Avg Reward: 980.44, Epsilon: 0.0100, LR: 0.000075, Traffic: uniform
2025-03-08 20:16:26,214 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 990.01, Avg Reward: 980.77, Epsilon: 0.0100, LR: 0.000071, Traffic: uniform
2025-03-08 20:16:30,765 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 986.75, Avg Reward: 980.97, Epsilon: 0.0100, LR: 0.000068, Traffic: uniform
2025-03-08 20:16:35,090 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 993.95, Avg Reward: 981.39, Epsilon: 0.0100, LR: 0.000064, Traffic: uniform
2025-03-08 20:16:39,461 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 992.82, Avg Reward: 981.74, Epsilon: 0.0100, LR: 0.000061, Traffic: uniform
2025-03-08 20:16:43,897 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 991.74, Avg Reward: 982.05, Epsilon: 0.0100, LR: 0.000058, Traffic: uniform
2025-03-08 20:16:48,435 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 994.33, Avg Reward: 982.41, Epsilon: 0.0100, LR: 0.000055, Traffic: uniform
2025-03-08 20:16:53,226 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 993.37, Avg Reward: 982.72, Epsilon: 0.0100, LR: 0.000052, Traffic: uniform
2025-03-08 20:16:58,659 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 991.89, Avg Reward: 982.98, Epsilon: 0.0100, LR: 0.000050, Traffic: uniform
2025-03-08 20:17:06,672 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 995.92, Avg Reward: 983.32, Epsilon: 0.0100, LR: 0.000047, Traffic: uniform
2025-03-08 20:17:13,669 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 994.12, Avg Reward: 983.61, Epsilon: 0.0100, LR: 0.000045, Traffic: uniform
2025-03-08 20:17:21,103 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 988.43, Avg Reward: 983.73, Epsilon: 0.0100, LR: 0.000043, Traffic: uniform
2025-03-08 20:17:26,179 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 993.67, Avg Reward: 983.98, Epsilon: 0.0100, LR: 0.000041, Traffic: uniform
2025-03-08 20:17:26,180 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-08 20:17:30,923 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 41770.31
2025-03-08 20:17:30,923 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-08 20:17:35,924 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 992.78, Avg Reward: 984.20, Epsilon: 0.0100, LR: 0.000039, Traffic: uniform
2025-03-08 20:17:42,104 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 992.79, Avg Reward: 984.40, Epsilon: 0.0100, LR: 0.000037, Traffic: uniform
2025-03-08 20:17:48,025 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 989.47, Avg Reward: 984.52, Epsilon: 0.0100, LR: 0.000035, Traffic: uniform
2025-03-08 20:17:53,586 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 994.76, Avg Reward: 984.75, Epsilon: 0.0100, LR: 0.000033, Traffic: uniform
2025-03-08 20:17:59,020 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 991.89, Avg Reward: 984.91, Epsilon: 0.0100, LR: 0.000031, Traffic: uniform
2025-03-08 20:18:04,612 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 995.96, Avg Reward: 985.15, Epsilon: 0.0100, LR: 0.000030, Traffic: uniform
2025-03-08 20:18:10,197 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 992.83, Avg Reward: 985.31, Epsilon: 0.0100, LR: 0.000028, Traffic: uniform
2025-03-08 20:18:15,725 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 992.89, Avg Reward: 985.47, Epsilon: 0.0100, LR: 0.000027, Traffic: uniform
2025-03-08 20:18:21,092 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 992.62, Avg Reward: 985.62, Epsilon: 0.0100, LR: 0.000026, Traffic: uniform
2025-03-08 20:18:26,480 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 993.68, Avg Reward: 985.78, Epsilon: 0.0100, LR: 0.000024, Traffic: uniform
2025-03-08 20:18:26,519 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_50.pth
2025-03-08 20:18:26,519 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-08 20:18:32,263 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 992.94, Avg Reward: 985.92, Epsilon: 0.0100, LR: 0.000023, Traffic: uniform
2025-03-08 20:18:38,559 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 991.89, Avg Reward: 986.03, Epsilon: 0.0100, LR: 0.000022, Traffic: uniform
2025-03-08 20:18:44,684 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 992.79, Avg Reward: 986.16, Epsilon: 0.0100, LR: 0.000021, Traffic: uniform
2025-03-08 20:18:51,139 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 995.05, Avg Reward: 986.33, Epsilon: 0.0100, LR: 0.000020, Traffic: uniform
2025-03-08 20:18:57,102 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 993.73, Avg Reward: 986.46, Epsilon: 0.0100, LR: 0.000019, Traffic: uniform
2025-03-08 20:19:02,851 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 995.68, Avg Reward: 986.62, Epsilon: 0.0100, LR: 0.000018, Traffic: uniform
2025-03-08 20:19:08,960 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 990.65, Avg Reward: 986.70, Epsilon: 0.0100, LR: 0.000017, Traffic: uniform
2025-03-08 20:19:14,920 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 988.77, Avg Reward: 986.73, Epsilon: 0.0100, LR: 0.000016, Traffic: uniform
2025-03-08 20:19:21,724 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 993.48, Avg Reward: 986.85, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-08 20:19:28,409 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 995.93, Avg Reward: 987.00, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-08 20:19:28,409 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-08 20:19:33,797 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 60173.50
2025-03-08 20:19:33,828 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:19:33,828 - TrafficRL.Train - INFO - New best model saved with reward: 60173.50
2025-03-08 20:19:41,293 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 992.86, Avg Reward: 987.09, Epsilon: 0.0100, LR: 0.000014, Traffic: uniform
2025-03-08 20:19:48,054 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.82, Avg Reward: 987.20, Epsilon: 0.0100, LR: 0.000013, Traffic: uniform
2025-03-08 20:19:55,540 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 989.64, Avg Reward: 987.24, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-08 20:20:02,926 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 993.30, Avg Reward: 987.34, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-08 20:20:10,224 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 993.06, Avg Reward: 987.42, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-08 20:20:17,957 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 993.55, Avg Reward: 987.52, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-08 20:20:27,793 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 994.94, Avg Reward: 987.63, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-08 20:20:35,539 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 992.95, Avg Reward: 987.71, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-08 20:20:43,486 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 995.50, Avg Reward: 987.82, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-08 20:20:51,820 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 993.10, Avg Reward: 987.89, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-08 20:20:59,766 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 990.73, Avg Reward: 987.93, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-08 20:21:07,697 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 990.93, Avg Reward: 987.98, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-08 20:21:16,382 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 993.23, Avg Reward: 988.05, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-08 20:21:24,936 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 993.47, Avg Reward: 988.12, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-08 20:21:33,704 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 993.49, Avg Reward: 988.19, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-08 20:21:33,742 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_75.pth
2025-03-08 20:21:33,742 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-08 20:21:43,014 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 992.64, Avg Reward: 988.25, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-08 20:21:51,628 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 988.35, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-08 20:22:00,492 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 991.79, Avg Reward: 988.40, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-08 20:22:09,209 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 994.88, Avg Reward: 988.48, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-08 20:22:17,954 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 994.60, Avg Reward: 988.56, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-08 20:22:17,956 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-08 20:22:22,955 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 63624.25
2025-03-08 20:22:22,987 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:22:22,987 - TrafficRL.Train - INFO - New best model saved with reward: 63624.25
2025-03-08 20:22:31,579 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 994.00, Avg Reward: 988.62, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-08 20:22:40,060 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 992.34, Avg Reward: 988.67, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-08 20:22:48,275 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 992.52, Avg Reward: 988.71, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-08 20:22:57,652 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 995.05, Avg Reward: 988.79, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-08 20:23:07,014 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 994.84, Avg Reward: 988.86, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-08 20:23:16,030 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 991.87, Avg Reward: 988.90, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-08 20:23:24,924 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 991.66, Avg Reward: 988.93, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-08 20:23:34,260 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 995.54, Avg Reward: 989.00, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:23:44,383 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 996.73, Avg Reward: 989.09, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:23:53,548 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 992.71, Avg Reward: 989.13, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:24:03,054 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 994.33, Avg Reward: 989.19, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:24:11,643 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 995.06, Avg Reward: 989.25, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:24:21,477 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 993.65, Avg Reward: 989.30, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:24:30,905 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 994.08, Avg Reward: 989.35, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-08 20:24:40,829 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 990.86, Avg Reward: 989.37, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-08 20:24:51,205 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 994.70, Avg Reward: 989.42, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-08 20:25:01,256 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 994.05, Avg Reward: 989.47, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-08 20:25:11,390 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 995.64, Avg Reward: 989.53, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-08 20:25:22,100 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 994.91, Avg Reward: 989.59, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-08 20:25:22,101 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-08 20:25:32,611 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 995.57, Avg Reward: 989.65, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-08 20:25:32,612 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-08 20:25:37,990 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 254119.62
2025-03-08 20:25:38,023 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:25:38,023 - TrafficRL.Train - INFO - New best model saved with reward: 254119.62
2025-03-08 20:25:38,063 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_100.pth
2025-03-08 20:25:38,064 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-08 20:25:49,920 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 994.74, Avg Reward: 989.66, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-08 20:26:00,430 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 996.71, Avg Reward: 989.70, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-08 20:26:10,164 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 993.22, Avg Reward: 989.67, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-08 20:26:21,560 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 994.55, Avg Reward: 991.06, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-08 20:26:31,316 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 991.80, Avg Reward: 991.38, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:26:41,169 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 993.02, Avg Reward: 992.30, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:26:51,064 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 995.58, Avg Reward: 992.65, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:01,271 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 994.78, Avg Reward: 992.76, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:11,117 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 994.49, Avg Reward: 992.91, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:20,801 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 995.29, Avg Reward: 992.97, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:31,042 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 994.09, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:41,260 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 993.53, Avg Reward: 993.03, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:27:53,467 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 994.64, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:28:07,319 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 994.94, Avg Reward: 993.16, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:28:19,729 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 994.00, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:28:32,432 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 991.99, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:28:43,965 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 996.74, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:28:54,925 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 995.76, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:29:05,733 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 994.42, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:29:16,419 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 993.69, Avg Reward: 993.40, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:29:16,420 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-08 20:29:21,533 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 266974.75
2025-03-08 20:29:21,570 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:29:21,570 - TrafficRL.Train - INFO - New best model saved with reward: 266974.75
2025-03-08 20:29:33,515 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 992.82, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:29:48,644 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 993.89, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:29:59,762 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 994.91, Avg Reward: 993.47, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:30:10,035 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 995.41, Avg Reward: 993.48, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:30:22,093 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 995.38, Avg Reward: 993.55, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-08 20:30:22,149 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_125.pth
2025-03-08 20:30:22,156 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-08 20:30:33,171 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 993.61, Avg Reward: 993.54, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:30:44,182 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 993.99, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:30:59,513 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 993.80, Avg Reward: 993.54, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:31:12,047 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 996.12, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:31:24,996 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 993.33, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:31:38,899 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 995.37, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:31:49,235 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 996.54, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:32:03,150 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 994.67, Avg Reward: 993.75, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:32:17,033 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 995.41, Avg Reward: 993.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:32:32,428 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 993.49, Avg Reward: 993.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:32:47,416 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 994.94, Avg Reward: 993.79, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:32:57,889 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 996.54, Avg Reward: 993.80, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:33:12,096 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 995.15, Avg Reward: 993.81, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:33:25,453 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 996.64, Avg Reward: 993.89, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:33:38,496 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 995.00, Avg Reward: 993.90, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:33:38,496 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-08 20:33:45,417 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 305275.51
2025-03-08 20:33:45,463 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-08 20:33:45,463 - TrafficRL.Train - INFO - New best model saved with reward: 305275.51
2025-03-08 20:33:57,403 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 994.94, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:34:11,551 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 993.83, Avg Reward: 993.93, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:34:24,669 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 995.26, Avg Reward: 993.99, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:34:41,036 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 995.70, Avg Reward: 994.00, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:34:52,103 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 995.23, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:03,913 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 996.32, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:15,370 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 995.43, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:26,210 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 995.39, Avg Reward: 994.09, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:36,447 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 993.42, Avg Reward: 994.10, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:46,557 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 993.71, Avg Reward: 994.10, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:35:46,603 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_150.pth
2025-03-08 20:35:46,603 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-08 20:35:57,828 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 993.10, Avg Reward: 994.10, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:36:08,814 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.22, Avg Reward: 994.12, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:36:19,810 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 995.92, Avg Reward: 994.15, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:36:31,514 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 995.96, Avg Reward: 994.16, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:36:42,888 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 994.20, Avg Reward: 994.17, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:36:53,396 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 993.12, Avg Reward: 994.14, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:37:04,007 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 995.35, Avg Reward: 994.19, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:37:14,574 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 992.94, Avg Reward: 994.23, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:37:24,664 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 995.40, Avg Reward: 994.25, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:37:35,744 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 994.46, Avg Reward: 994.24, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:37:35,751 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-08 20:37:41,308 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 298686.95
2025-03-08 20:37:41,308 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-08 20:37:51,934 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 994.34, Avg Reward: 994.25, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:02,268 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 994.96, Avg Reward: 994.26, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:12,415 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 994.45, Avg Reward: 994.31, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:23,016 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 994.29, Avg Reward: 994.32, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:34,894 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 996.95, Avg Reward: 994.36, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:47,354 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 995.65, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:38:57,583 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 995.67, Avg Reward: 994.39, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:39:08,598 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 994.09, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:39:22,060 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 995.08, Avg Reward: 994.39, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:39:36,185 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:39:50,470 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 994.14, Avg Reward: 994.45, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:40:06,240 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 995.57, Avg Reward: 994.49, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:40:19,622 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.73, Avg Reward: 994.50, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:40:33,678 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 995.56, Avg Reward: 994.52, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:40:46,740 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 994.43, Avg Reward: 994.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:40:46,792 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_175.pth
2025-03-08 20:40:46,792 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-08 20:40:59,967 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 995.99, Avg Reward: 994.56, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:41:12,095 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 996.36, Avg Reward: 994.56, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:41:27,142 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 996.30, Avg Reward: 994.61, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:41:42,834 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 995.17, Avg Reward: 994.61, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:41:54,401 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 994.63, Avg Reward: 994.61, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:41:54,402 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-08 20:41:59,434 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 267393.17
2025-03-08 20:41:59,435 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-08 20:42:09,944 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 996.53, Avg Reward: 994.64, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:42:21,014 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 994.24, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:42:31,837 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 994.12, Avg Reward: 994.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:42:41,798 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 994.10, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:42:53,535 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 994.05, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:43:08,404 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 993.17, Avg Reward: 994.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:43:20,356 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 993.60, Avg Reward: 994.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:43:34,721 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 994.91, Avg Reward: 994.68, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:43:48,396 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 994.14, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:43:58,960 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 994.53, Avg Reward: 994.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:44:09,512 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 992.95, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:44:19,815 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 996.63, Avg Reward: 994.68, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:44:34,318 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 994.69, Avg Reward: 994.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:44:50,051 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 994.74, Avg Reward: 994.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:45:03,883 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 995.08, Avg Reward: 994.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:45:19,101 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 994.27, Avg Reward: 994.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:45:31,447 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 993.62, Avg Reward: 994.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:45:46,535 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 993.70, Avg Reward: 994.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:46:02,669 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 995.50, Avg Reward: 994.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-08 20:46:02,670 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-08 20:46:15,624 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 993.23, Avg Reward: 994.69, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:46:15,626 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-08 20:46:21,173 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 114884.52
2025-03-08 20:46:21,174 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-08 20:46:21,242 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_200.pth
2025-03-08 20:46:21,243 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-08 20:46:32,778 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 993.83, Avg Reward: 994.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:46:42,919 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 993.05, Avg Reward: 994.64, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:46:53,660 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 994.46, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:47:05,195 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 994.60, Avg Reward: 994.66, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:47:15,559 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 992.85, Avg Reward: 994.67, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:47:26,115 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 991.30, Avg Reward: 994.65, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:47:38,255 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 993.84, Avg Reward: 994.63, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:47:50,826 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 993.57, Avg Reward: 994.62, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:01,710 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 993.54, Avg Reward: 994.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:11,822 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 990.61, Avg Reward: 994.56, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:22,608 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 994.33, Avg Reward: 994.57, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:32,853 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 989.67, Avg Reward: 994.53, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:43,949 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 991.58, Avg Reward: 994.50, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:48:54,137 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 993.17, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:49:05,235 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 992.58, Avg Reward: 994.47, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:49:16,105 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 991.89, Avg Reward: 994.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:49:27,975 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 994.15, Avg Reward: 994.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:49:43,240 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 994.02, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:49:53,192 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 993.92, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:50:04,040 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 993.73, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:50:04,042 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-08 20:50:09,110 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 139850.41
2025-03-08 20:50:09,111 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-08 20:50:20,519 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 994.29, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:50:33,515 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 993.83, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:50:49,913 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 996.10, Avg Reward: 994.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:51:06,096 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 993.71, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:51:22,085 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 993.86, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:51:22,138 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_225.pth
2025-03-08 20:51:22,138 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-08 20:51:37,829 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 991.98, Avg Reward: 994.39, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:51:52,086 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 991.30, Avg Reward: 994.37, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:52:12,823 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 990.35, Avg Reward: 994.33, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:52:36,843 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 994.74, Avg Reward: 994.32, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:53:01,495 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 992.53, Avg Reward: 994.31, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:53:21,044 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 993.76, Avg Reward: 994.29, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:53:35,711 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 994.30, Avg Reward: 994.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:53:55,429 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 994.38, Avg Reward: 994.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:54:18,451 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 990.73, Avg Reward: 994.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:54:42,186 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 992.28, Avg Reward: 994.21, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:01,759 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 994.41, Avg Reward: 994.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:19,059 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 992.38, Avg Reward: 994.16, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:34,951 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 989.49, Avg Reward: 994.11, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:47,065 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 991.89, Avg Reward: 994.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:57,403 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 995.05, Avg Reward: 994.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:55:57,404 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-08 20:56:02,746 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 110817.33
2025-03-08 20:56:02,746 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-08 20:56:12,984 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 992.24, Avg Reward: 994.03, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:56:22,890 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 994.67, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:56:33,604 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 994.56, Avg Reward: 994.03, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:56:45,014 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 993.93, Avg Reward: 994.02, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:56:55,473 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 994.46, Avg Reward: 994.01, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:05,534 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 993.25, Avg Reward: 993.98, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:17,269 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 989.17, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:27,711 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 990.95, Avg Reward: 993.87, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:38,365 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 991.55, Avg Reward: 993.85, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:48,743 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 992.04, Avg Reward: 993.84, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:57:48,812 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_250.pth
2025-03-08 20:57:48,812 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-08 20:58:01,842 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 992.30, Avg Reward: 993.83, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:58:12,913 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 992.50, Avg Reward: 993.81, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:58:24,733 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 994.88, Avg Reward: 993.80, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:58:37,049 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 992.30, Avg Reward: 993.76, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:58:48,819 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 990.94, Avg Reward: 993.73, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:58:59,280 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 993.84, Avg Reward: 993.74, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:59:09,081 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 992.94, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:59:19,119 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 993.39, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:59:29,289 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 994.60, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:59:40,510 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 995.14, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 20:59:40,511 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-08 20:59:45,918 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 120182.61
2025-03-08 20:59:45,919 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-08 20:59:56,996 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 991.64, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:00:07,767 - TrafficRL.Train - INFO - Episode 262/500 - Reward: 994.99, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:00:17,480 - TrafficRL.Train - INFO - Episode 263/500 - Reward: 993.52, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:00:28,649 - TrafficRL.Train - INFO - Episode 264/500 - Reward: 994.65, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:00:43,235 - TrafficRL.Train - INFO - Episode 265/500 - Reward: 991.03, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:00:53,869 - TrafficRL.Train - INFO - Episode 266/500 - Reward: 995.17, Avg Reward: 993.62, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:04,241 - TrafficRL.Train - INFO - Episode 267/500 - Reward: 994.13, Avg Reward: 993.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:14,550 - TrafficRL.Train - INFO - Episode 268/500 - Reward: 996.95, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:25,465 - TrafficRL.Train - INFO - Episode 269/500 - Reward: 991.33, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:35,619 - TrafficRL.Train - INFO - Episode 270/500 - Reward: 992.64, Avg Reward: 993.57, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:46,060 - TrafficRL.Train - INFO - Episode 271/500 - Reward: 992.21, Avg Reward: 993.56, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:01:57,969 - TrafficRL.Train - INFO - Episode 272/500 - Reward: 991.96, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:02:16,599 - TrafficRL.Train - INFO - Episode 273/500 - Reward: 996.44, Avg Reward: 993.55, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:02:32,434 - TrafficRL.Train - INFO - Episode 274/500 - Reward: 992.79, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:02:48,959 - TrafficRL.Train - INFO - Episode 275/500 - Reward: 994.45, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:02:49,028 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_275.pth
2025-03-08 21:02:49,029 - TrafficRL.Train - INFO - Model checkpoint saved at episode 275
2025-03-08 21:03:05,916 - TrafficRL.Train - INFO - Episode 276/500 - Reward: 992.60, Avg Reward: 993.48, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:03:21,576 - TrafficRL.Train - INFO - Episode 277/500 - Reward: 994.78, Avg Reward: 993.47, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:03:37,065 - TrafficRL.Train - INFO - Episode 278/500 - Reward: 991.89, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:03:54,510 - TrafficRL.Train - INFO - Episode 279/500 - Reward: 994.38, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:04:12,381 - TrafficRL.Train - INFO - Episode 280/500 - Reward: 993.73, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:04:12,382 - TrafficRL.Train - INFO - Evaluating agent at episode 280...
2025-03-08 21:04:18,468 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 114779.25
2025-03-08 21:04:18,468 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-08 21:04:32,876 - TrafficRL.Train - INFO - Episode 281/500 - Reward: 991.87, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:04:46,808 - TrafficRL.Train - INFO - Episode 282/500 - Reward: 992.13, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:05:00,749 - TrafficRL.Train - INFO - Episode 283/500 - Reward: 994.22, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:05:14,282 - TrafficRL.Train - INFO - Episode 284/500 - Reward: 993.51, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:05:27,844 - TrafficRL.Train - INFO - Episode 285/500 - Reward: 995.77, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:05:41,653 - TrafficRL.Train - INFO - Episode 286/500 - Reward: 995.19, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:05:55,398 - TrafficRL.Train - INFO - Episode 287/500 - Reward: 994.53, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:06:09,582 - TrafficRL.Train - INFO - Episode 288/500 - Reward: 993.93, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:06:25,318 - TrafficRL.Train - INFO - Episode 289/500 - Reward: 992.92, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:06:41,495 - TrafficRL.Train - INFO - Episode 290/500 - Reward: 993.42, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:06:55,499 - TrafficRL.Train - INFO - Episode 291/500 - Reward: 993.66, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:07:09,800 - TrafficRL.Train - INFO - Episode 292/500 - Reward: 989.90, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:07:26,572 - TrafficRL.Train - INFO - Episode 293/500 - Reward: 992.22, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:07:42,669 - TrafficRL.Train - INFO - Episode 294/500 - Reward: 996.71, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:07:57,688 - TrafficRL.Train - INFO - Episode 295/500 - Reward: 995.02, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:08:11,919 - TrafficRL.Train - INFO - Episode 296/500 - Reward: 993.58, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:08:26,726 - TrafficRL.Train - INFO - Episode 297/500 - Reward: 993.10, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:08:40,347 - TrafficRL.Train - INFO - Episode 298/500 - Reward: 992.75, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:08:54,556 - TrafficRL.Train - INFO - Episode 299/500 - Reward: 991.36, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-08 21:08:54,557 - TrafficRL.Train - INFO - Switching to uniform traffic pattern at episode 300
2025-03-08 21:09:09,909 - TrafficRL.Train - INFO - Episode 300/500 - Reward: 993.62, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:09:09,911 - TrafficRL.Train - INFO - Evaluating agent at episode 300...
2025-03-08 21:09:16,401 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 76865.34
2025-03-08 21:09:16,402 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-08 21:09:16,486 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_300.pth
2025-03-08 21:09:16,487 - TrafficRL.Train - INFO - Model checkpoint saved at episode 300
2025-03-08 21:09:32,617 - TrafficRL.Train - INFO - Episode 301/500 - Reward: 993.11, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:09:47,507 - TrafficRL.Train - INFO - Episode 302/500 - Reward: 994.28, Avg Reward: 993.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:10:02,099 - TrafficRL.Train - INFO - Episode 303/500 - Reward: 995.99, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:10:16,606 - TrafficRL.Train - INFO - Episode 304/500 - Reward: 994.71, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:10:31,145 - TrafficRL.Train - INFO - Episode 305/500 - Reward: 993.04, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:10:47,213 - TrafficRL.Train - INFO - Episode 306/500 - Reward: 995.21, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:11:01,533 - TrafficRL.Train - INFO - Episode 307/500 - Reward: 994.48, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:11:15,682 - TrafficRL.Train - INFO - Episode 308/500 - Reward: 994.62, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:11:30,266 - TrafficRL.Train - INFO - Episode 309/500 - Reward: 993.38, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:11:44,527 - TrafficRL.Train - INFO - Episode 310/500 - Reward: 993.80, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:11:59,477 - TrafficRL.Train - INFO - Episode 311/500 - Reward: 993.71, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:12:14,175 - TrafficRL.Train - INFO - Episode 312/500 - Reward: 988.42, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:12:29,901 - TrafficRL.Train - INFO - Episode 313/500 - Reward: 992.19, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:12:45,622 - TrafficRL.Train - INFO - Episode 314/500 - Reward: 994.73, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:13:00,610 - TrafficRL.Train - INFO - Episode 315/500 - Reward: 994.59, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:13:15,942 - TrafficRL.Train - INFO - Episode 316/500 - Reward: 993.91, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:13:31,213 - TrafficRL.Train - INFO - Episode 317/500 - Reward: 993.73, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:13:46,031 - TrafficRL.Train - INFO - Episode 318/500 - Reward: 995.30, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:14:01,385 - TrafficRL.Train - INFO - Episode 319/500 - Reward: 994.83, Avg Reward: 993.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:14:16,502 - TrafficRL.Train - INFO - Episode 320/500 - Reward: 995.18, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:14:16,503 - TrafficRL.Train - INFO - Evaluating agent at episode 320...
2025-03-08 21:14:22,542 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 66278.49
2025-03-08 21:14:22,543 - TrafficRL.Train - INFO - No improvement for 9 evaluations
2025-03-08 21:14:37,093 - TrafficRL.Train - INFO - Episode 321/500 - Reward: 994.78, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:14:52,040 - TrafficRL.Train - INFO - Episode 322/500 - Reward: 994.62, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:15:06,842 - TrafficRL.Train - INFO - Episode 323/500 - Reward: 994.91, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:15:21,747 - TrafficRL.Train - INFO - Episode 324/500 - Reward: 993.16, Avg Reward: 993.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:15:36,508 - TrafficRL.Train - INFO - Episode 325/500 - Reward: 994.72, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:15:36,582 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_325.pth
2025-03-08 21:15:36,582 - TrafficRL.Train - INFO - Model checkpoint saved at episode 325
2025-03-08 21:15:52,937 - TrafficRL.Train - INFO - Episode 326/500 - Reward: 994.16, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:16:08,133 - TrafficRL.Train - INFO - Episode 327/500 - Reward: 992.48, Avg Reward: 993.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:16:23,687 - TrafficRL.Train - INFO - Episode 328/500 - Reward: 991.34, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:16:38,979 - TrafficRL.Train - INFO - Episode 329/500 - Reward: 993.84, Avg Reward: 993.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:16:54,233 - TrafficRL.Train - INFO - Episode 330/500 - Reward: 995.19, Avg Reward: 993.47, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:17:09,880 - TrafficRL.Train - INFO - Episode 331/500 - Reward: 993.48, Avg Reward: 993.47, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:17:25,286 - TrafficRL.Train - INFO - Episode 332/500 - Reward: 993.39, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:17:40,481 - TrafficRL.Train - INFO - Episode 333/500 - Reward: 993.18, Avg Reward: 993.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:17:55,800 - TrafficRL.Train - INFO - Episode 334/500 - Reward: 994.60, Avg Reward: 993.49, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:18:11,486 - TrafficRL.Train - INFO - Episode 335/500 - Reward: 995.05, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:18:27,012 - TrafficRL.Train - INFO - Episode 336/500 - Reward: 996.02, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:18:42,310 - TrafficRL.Train - INFO - Episode 337/500 - Reward: 996.15, Avg Reward: 993.57, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:18:58,221 - TrafficRL.Train - INFO - Episode 338/500 - Reward: 994.69, Avg Reward: 993.62, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:19:13,559 - TrafficRL.Train - INFO - Episode 339/500 - Reward: 995.03, Avg Reward: 993.65, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:19:29,349 - TrafficRL.Train - INFO - Episode 340/500 - Reward: 993.75, Avg Reward: 993.64, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:19:29,350 - TrafficRL.Train - INFO - Evaluating agent at episode 340...
2025-03-08 21:19:35,918 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 58514.14
2025-03-08 21:19:35,919 - TrafficRL.Train - INFO - No improvement for 10 evaluations
2025-03-08 21:19:51,375 - TrafficRL.Train - INFO - Episode 341/500 - Reward: 995.02, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:20:06,650 - TrafficRL.Train - INFO - Episode 342/500 - Reward: 994.07, Avg Reward: 993.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:20:22,628 - TrafficRL.Train - INFO - Episode 343/500 - Reward: 995.52, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:20:37,985 - TrafficRL.Train - INFO - Episode 344/500 - Reward: 994.30, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:20:53,394 - TrafficRL.Train - INFO - Episode 345/500 - Reward: 994.54, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:21:08,940 - TrafficRL.Train - INFO - Episode 346/500 - Reward: 994.05, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:21:24,649 - TrafficRL.Train - INFO - Episode 347/500 - Reward: 996.61, Avg Reward: 993.76, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:21:41,034 - TrafficRL.Train - INFO - Episode 348/500 - Reward: 993.59, Avg Reward: 993.79, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:21:57,960 - TrafficRL.Train - INFO - Episode 349/500 - Reward: 994.42, Avg Reward: 993.81, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:22:17,945 - TrafficRL.Train - INFO - Episode 350/500 - Reward: 994.28, Avg Reward: 993.84, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:22:18,046 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_350.pth
2025-03-08 21:22:18,046 - TrafficRL.Train - INFO - Model checkpoint saved at episode 350
2025-03-08 21:22:39,496 - TrafficRL.Train - INFO - Episode 351/500 - Reward: 992.55, Avg Reward: 993.84, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:22:59,970 - TrafficRL.Train - INFO - Episode 352/500 - Reward: 994.34, Avg Reward: 993.86, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:23:21,161 - TrafficRL.Train - INFO - Episode 353/500 - Reward: 993.83, Avg Reward: 993.85, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:23:41,633 - TrafficRL.Train - INFO - Episode 354/500 - Reward: 993.66, Avg Reward: 993.86, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:23:59,675 - TrafficRL.Train - INFO - Episode 355/500 - Reward: 994.15, Avg Reward: 993.89, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:24:16,099 - TrafficRL.Train - INFO - Episode 356/500 - Reward: 995.65, Avg Reward: 993.91, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:24:34,512 - TrafficRL.Train - INFO - Episode 357/500 - Reward: 993.43, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:24:51,171 - TrafficRL.Train - INFO - Episode 358/500 - Reward: 992.68, Avg Reward: 993.91, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:25:08,244 - TrafficRL.Train - INFO - Episode 359/500 - Reward: 995.54, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:25:25,309 - TrafficRL.Train - INFO - Episode 360/500 - Reward: 995.42, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:25:25,310 - TrafficRL.Train - INFO - Evaluating agent at episode 360...
2025-03-08 21:25:33,101 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 72450.49
2025-03-08 21:25:33,101 - TrafficRL.Train - INFO - No improvement for 11 evaluations
2025-03-08 21:25:52,441 - TrafficRL.Train - INFO - Episode 361/500 - Reward: 990.56, Avg Reward: 993.91, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:26:08,945 - TrafficRL.Train - INFO - Episode 362/500 - Reward: 992.10, Avg Reward: 993.88, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:26:27,142 - TrafficRL.Train - INFO - Episode 363/500 - Reward: 993.82, Avg Reward: 993.88, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:26:44,527 - TrafficRL.Train - INFO - Episode 364/500 - Reward: 993.42, Avg Reward: 993.87, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:27:02,465 - TrafficRL.Train - INFO - Episode 365/500 - Reward: 994.03, Avg Reward: 993.90, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:27:25,019 - TrafficRL.Train - INFO - Episode 366/500 - Reward: 996.76, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:27:52,657 - TrafficRL.Train - INFO - Episode 367/500 - Reward: 992.96, Avg Reward: 993.91, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:28:21,272 - TrafficRL.Train - INFO - Episode 368/500 - Reward: 993.48, Avg Reward: 993.87, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:28:50,043 - TrafficRL.Train - INFO - Episode 369/500 - Reward: 994.51, Avg Reward: 993.90, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:29:18,018 - TrafficRL.Train - INFO - Episode 370/500 - Reward: 994.39, Avg Reward: 993.92, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:29:46,570 - TrafficRL.Train - INFO - Episode 371/500 - Reward: 993.56, Avg Reward: 993.93, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:30:13,826 - TrafficRL.Train - INFO - Episode 372/500 - Reward: 995.15, Avg Reward: 993.97, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:30:43,993 - TrafficRL.Train - INFO - Episode 373/500 - Reward: 994.72, Avg Reward: 993.95, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:31:18,786 - TrafficRL.Train - INFO - Episode 374/500 - Reward: 995.68, Avg Reward: 993.98, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:31:41,250 - TrafficRL.Train - INFO - Episode 375/500 - Reward: 994.27, Avg Reward: 993.98, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:31:41,351 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_375.pth
2025-03-08 21:31:41,352 - TrafficRL.Train - INFO - Model checkpoint saved at episode 375
2025-03-08 21:32:09,149 - TrafficRL.Train - INFO - Episode 376/500 - Reward: 993.87, Avg Reward: 993.99, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:32:36,883 - TrafficRL.Train - INFO - Episode 377/500 - Reward: 993.67, Avg Reward: 993.98, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:33:07,491 - TrafficRL.Train - INFO - Episode 378/500 - Reward: 993.53, Avg Reward: 993.99, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:33:36,517 - TrafficRL.Train - INFO - Episode 379/500 - Reward: 996.46, Avg Reward: 994.01, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:34:02,071 - TrafficRL.Train - INFO - Episode 380/500 - Reward: 994.33, Avg Reward: 994.02, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:34:02,073 - TrafficRL.Train - INFO - Evaluating agent at episode 380...
2025-03-08 21:34:13,441 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 76191.74
2025-03-08 21:34:13,441 - TrafficRL.Train - INFO - No improvement for 12 evaluations
2025-03-08 21:34:41,834 - TrafficRL.Train - INFO - Episode 381/500 - Reward: 995.10, Avg Reward: 994.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:35:14,809 - TrafficRL.Train - INFO - Episode 382/500 - Reward: 993.80, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:35:53,063 - TrafficRL.Train - INFO - Episode 383/500 - Reward: 995.79, Avg Reward: 994.09, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:36:25,867 - TrafficRL.Train - INFO - Episode 384/500 - Reward: 994.00, Avg Reward: 994.09, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:37:01,953 - TrafficRL.Train - INFO - Episode 385/500 - Reward: 992.66, Avg Reward: 994.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:37:30,366 - TrafficRL.Train - INFO - Episode 386/500 - Reward: 992.89, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:37:55,464 - TrafficRL.Train - INFO - Episode 387/500 - Reward: 993.60, Avg Reward: 994.03, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:38:17,865 - TrafficRL.Train - INFO - Episode 388/500 - Reward: 993.97, Avg Reward: 994.03, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:38:37,326 - TrafficRL.Train - INFO - Episode 389/500 - Reward: 994.51, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:38:56,312 - TrafficRL.Train - INFO - Episode 390/500 - Reward: 993.35, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:39:16,845 - TrafficRL.Train - INFO - Episode 391/500 - Reward: 994.03, Avg Reward: 994.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:39:41,999 - TrafficRL.Train - INFO - Episode 392/500 - Reward: 992.37, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:40:08,384 - TrafficRL.Train - INFO - Episode 393/500 - Reward: 995.69, Avg Reward: 994.11, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:40:35,881 - TrafficRL.Train - INFO - Episode 394/500 - Reward: 996.42, Avg Reward: 994.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:41:00,729 - TrafficRL.Train - INFO - Episode 395/500 - Reward: 992.36, Avg Reward: 994.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:41:25,700 - TrafficRL.Train - INFO - Episode 396/500 - Reward: 994.07, Avg Reward: 994.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:41:54,028 - TrafficRL.Train - INFO - Episode 397/500 - Reward: 994.82, Avg Reward: 994.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:42:22,715 - TrafficRL.Train - INFO - Episode 398/500 - Reward: 995.10, Avg Reward: 994.12, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:42:54,281 - TrafficRL.Train - INFO - Episode 399/500 - Reward: 994.44, Avg Reward: 994.15, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:43:22,965 - TrafficRL.Train - INFO - Episode 400/500 - Reward: 994.51, Avg Reward: 994.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:43:22,967 - TrafficRL.Train - INFO - Evaluating agent at episode 400...
2025-03-08 21:43:34,680 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 83093.94
2025-03-08 21:43:34,681 - TrafficRL.Train - INFO - No improvement for 13 evaluations
2025-03-08 21:43:34,832 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_400.pth
2025-03-08 21:43:34,832 - TrafficRL.Train - INFO - Model checkpoint saved at episode 400
2025-03-08 21:44:01,290 - TrafficRL.Train - INFO - Episode 401/500 - Reward: 995.45, Avg Reward: 994.18, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:44:18,286 - TrafficRL.Train - INFO - Episode 402/500 - Reward: 993.20, Avg Reward: 994.17, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:44:34,092 - TrafficRL.Train - INFO - Episode 403/500 - Reward: 994.69, Avg Reward: 994.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:44:49,009 - TrafficRL.Train - INFO - Episode 404/500 - Reward: 993.49, Avg Reward: 994.15, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:45:03,592 - TrafficRL.Train - INFO - Episode 405/500 - Reward: 994.74, Avg Reward: 994.17, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:45:17,843 - TrafficRL.Train - INFO - Episode 406/500 - Reward: 994.42, Avg Reward: 994.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:45:32,468 - TrafficRL.Train - INFO - Episode 407/500 - Reward: 996.11, Avg Reward: 994.17, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:45:48,372 - TrafficRL.Train - INFO - Episode 408/500 - Reward: 995.30, Avg Reward: 994.18, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:00,264 - TrafficRL.Train - INFO - Episode 409/500 - Reward: 994.52, Avg Reward: 994.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:11,600 - TrafficRL.Train - INFO - Episode 410/500 - Reward: 993.24, Avg Reward: 994.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:23,202 - TrafficRL.Train - INFO - Episode 411/500 - Reward: 994.82, Avg Reward: 994.20, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:35,040 - TrafficRL.Train - INFO - Episode 412/500 - Reward: 993.61, Avg Reward: 994.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:45,551 - TrafficRL.Train - INFO - Episode 413/500 - Reward: 996.02, Avg Reward: 994.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:46:56,058 - TrafficRL.Train - INFO - Episode 414/500 - Reward: 995.14, Avg Reward: 994.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:47:07,920 - TrafficRL.Train - INFO - Episode 415/500 - Reward: 994.22, Avg Reward: 994.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:47:18,811 - TrafficRL.Train - INFO - Episode 416/500 - Reward: 994.90, Avg Reward: 994.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:47:29,113 - TrafficRL.Train - INFO - Episode 417/500 - Reward: 995.78, Avg Reward: 994.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:47:39,708 - TrafficRL.Train - INFO - Episode 418/500 - Reward: 991.91, Avg Reward: 994.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:47:50,054 - TrafficRL.Train - INFO - Episode 419/500 - Reward: 993.40, Avg Reward: 994.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:01,341 - TrafficRL.Train - INFO - Episode 420/500 - Reward: 993.56, Avg Reward: 994.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:01,342 - TrafficRL.Train - INFO - Evaluating agent at episode 420...
2025-03-08 21:48:07,183 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 54922.41
2025-03-08 21:48:07,183 - TrafficRL.Train - INFO - No improvement for 14 evaluations
2025-03-08 21:48:18,581 - TrafficRL.Train - INFO - Episode 421/500 - Reward: 995.48, Avg Reward: 994.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:28,842 - TrafficRL.Train - INFO - Episode 422/500 - Reward: 992.75, Avg Reward: 994.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:39,189 - TrafficRL.Train - INFO - Episode 423/500 - Reward: 993.56, Avg Reward: 994.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:49,166 - TrafficRL.Train - INFO - Episode 424/500 - Reward: 996.21, Avg Reward: 994.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:59,288 - TrafficRL.Train - INFO - Episode 425/500 - Reward: 996.83, Avg Reward: 994.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:48:59,364 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_425.pth
2025-03-08 21:48:59,364 - TrafficRL.Train - INFO - Model checkpoint saved at episode 425
2025-03-08 21:49:09,118 - TrafficRL.Train - INFO - Episode 426/500 - Reward: 993.81, Avg Reward: 994.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:49:18,614 - TrafficRL.Train - INFO - Episode 427/500 - Reward: 995.99, Avg Reward: 994.31, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:49:28,439 - TrafficRL.Train - INFO - Episode 428/500 - Reward: 993.72, Avg Reward: 994.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:49:38,057 - TrafficRL.Train - INFO - Episode 429/500 - Reward: 996.51, Avg Reward: 994.36, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:49:47,589 - TrafficRL.Train - INFO - Episode 430/500 - Reward: 993.30, Avg Reward: 994.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:49:57,134 - TrafficRL.Train - INFO - Episode 431/500 - Reward: 995.97, Avg Reward: 994.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:06,748 - TrafficRL.Train - INFO - Episode 432/500 - Reward: 995.89, Avg Reward: 994.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:16,192 - TrafficRL.Train - INFO - Episode 433/500 - Reward: 995.81, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:26,135 - TrafficRL.Train - INFO - Episode 434/500 - Reward: 994.90, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:35,950 - TrafficRL.Train - INFO - Episode 435/500 - Reward: 994.22, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:45,635 - TrafficRL.Train - INFO - Episode 436/500 - Reward: 992.14, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:50:55,304 - TrafficRL.Train - INFO - Episode 437/500 - Reward: 994.63, Avg Reward: 994.36, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:51:04,756 - TrafficRL.Train - INFO - Episode 438/500 - Reward: 993.63, Avg Reward: 994.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:51:15,861 - TrafficRL.Train - INFO - Episode 439/500 - Reward: 996.73, Avg Reward: 994.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:51:26,057 - TrafficRL.Train - INFO - Episode 440/500 - Reward: 994.96, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:51:26,057 - TrafficRL.Train - INFO - Evaluating agent at episode 440...
2025-03-08 21:51:30,953 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 71743.85
2025-03-08 21:51:30,953 - TrafficRL.Train - INFO - No improvement for 15 evaluations
2025-03-08 21:51:41,096 - TrafficRL.Train - INFO - Episode 441/500 - Reward: 994.75, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:51:50,843 - TrafficRL.Train - INFO - Episode 442/500 - Reward: 995.94, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:00,627 - TrafficRL.Train - INFO - Episode 443/500 - Reward: 993.18, Avg Reward: 994.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:10,616 - TrafficRL.Train - INFO - Episode 444/500 - Reward: 992.11, Avg Reward: 994.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:20,609 - TrafficRL.Train - INFO - Episode 445/500 - Reward: 993.07, Avg Reward: 994.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:30,964 - TrafficRL.Train - INFO - Episode 446/500 - Reward: 993.78, Avg Reward: 994.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:41,098 - TrafficRL.Train - INFO - Episode 447/500 - Reward: 994.88, Avg Reward: 994.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:52:50,983 - TrafficRL.Train - INFO - Episode 448/500 - Reward: 992.95, Avg Reward: 994.31, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:00,884 - TrafficRL.Train - INFO - Episode 449/500 - Reward: 994.93, Avg Reward: 994.31, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:10,748 - TrafficRL.Train - INFO - Episode 450/500 - Reward: 995.22, Avg Reward: 994.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:10,831 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_450.pth
2025-03-08 21:53:10,831 - TrafficRL.Train - INFO - Model checkpoint saved at episode 450
2025-03-08 21:53:20,980 - TrafficRL.Train - INFO - Episode 451/500 - Reward: 995.01, Avg Reward: 994.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:31,108 - TrafficRL.Train - INFO - Episode 452/500 - Reward: 995.62, Avg Reward: 994.36, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:41,116 - TrafficRL.Train - INFO - Episode 453/500 - Reward: 994.43, Avg Reward: 994.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:53:50,977 - TrafficRL.Train - INFO - Episode 454/500 - Reward: 994.91, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:00,946 - TrafficRL.Train - INFO - Episode 455/500 - Reward: 993.81, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:10,810 - TrafficRL.Train - INFO - Episode 456/500 - Reward: 995.54, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:20,659 - TrafficRL.Train - INFO - Episode 457/500 - Reward: 993.81, Avg Reward: 994.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:30,696 - TrafficRL.Train - INFO - Episode 458/500 - Reward: 994.25, Avg Reward: 994.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:40,878 - TrafficRL.Train - INFO - Episode 459/500 - Reward: 996.97, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:50,557 - TrafficRL.Train - INFO - Episode 460/500 - Reward: 996.06, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:54:50,557 - TrafficRL.Train - INFO - Evaluating agent at episode 460...
2025-03-08 21:54:55,428 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 79950.53
2025-03-08 21:54:55,428 - TrafficRL.Train - INFO - No improvement for 16 evaluations
2025-03-08 21:55:05,262 - TrafficRL.Train - INFO - Episode 461/500 - Reward: 995.26, Avg Reward: 994.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:55:15,063 - TrafficRL.Train - INFO - Episode 462/500 - Reward: 993.13, Avg Reward: 994.47, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:55:25,110 - TrafficRL.Train - INFO - Episode 463/500 - Reward: 992.37, Avg Reward: 994.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:55:35,066 - TrafficRL.Train - INFO - Episode 464/500 - Reward: 994.52, Avg Reward: 994.47, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:55:45,163 - TrafficRL.Train - INFO - Episode 465/500 - Reward: 994.85, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:55:54,944 - TrafficRL.Train - INFO - Episode 466/500 - Reward: 996.89, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:04,721 - TrafficRL.Train - INFO - Episode 467/500 - Reward: 992.95, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:14,641 - TrafficRL.Train - INFO - Episode 468/500 - Reward: 994.63, Avg Reward: 994.49, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:24,602 - TrafficRL.Train - INFO - Episode 469/500 - Reward: 993.35, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:34,553 - TrafficRL.Train - INFO - Episode 470/500 - Reward: 994.09, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:44,559 - TrafficRL.Train - INFO - Episode 471/500 - Reward: 993.86, Avg Reward: 994.48, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:56:54,311 - TrafficRL.Train - INFO - Episode 472/500 - Reward: 993.91, Avg Reward: 994.47, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:57:04,505 - TrafficRL.Train - INFO - Episode 473/500 - Reward: 991.72, Avg Reward: 994.44, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:57:14,553 - TrafficRL.Train - INFO - Episode 474/500 - Reward: 993.46, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:57:24,844 - TrafficRL.Train - INFO - Episode 475/500 - Reward: 995.11, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:57:24,928 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_475.pth
2025-03-08 21:57:24,928 - TrafficRL.Train - INFO - Model checkpoint saved at episode 475
2025-03-08 21:57:35,158 - TrafficRL.Train - INFO - Episode 476/500 - Reward: 993.62, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:57:47,496 - TrafficRL.Train - INFO - Episode 477/500 - Reward: 993.97, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:58:04,630 - TrafficRL.Train - INFO - Episode 478/500 - Reward: 992.29, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:58:29,271 - TrafficRL.Train - INFO - Episode 479/500 - Reward: 995.54, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:58:45,823 - TrafficRL.Train - INFO - Episode 480/500 - Reward: 994.33, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:58:45,824 - TrafficRL.Train - INFO - Evaluating agent at episode 480...
2025-03-08 21:58:51,672 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 72390.82
2025-03-08 21:58:51,673 - TrafficRL.Train - INFO - No improvement for 17 evaluations
2025-03-08 21:59:04,256 - TrafficRL.Train - INFO - Episode 481/500 - Reward: 994.99, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:59:16,163 - TrafficRL.Train - INFO - Episode 482/500 - Reward: 995.66, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:59:28,270 - TrafficRL.Train - INFO - Episode 483/500 - Reward: 993.76, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:59:42,086 - TrafficRL.Train - INFO - Episode 484/500 - Reward: 994.75, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 21:59:56,254 - TrafficRL.Train - INFO - Episode 485/500 - Reward: 993.49, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:00:08,989 - TrafficRL.Train - INFO - Episode 486/500 - Reward: 994.91, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:00:20,134 - TrafficRL.Train - INFO - Episode 487/500 - Reward: 991.31, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:00:33,559 - TrafficRL.Train - INFO - Episode 488/500 - Reward: 994.42, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:00:46,454 - TrafficRL.Train - INFO - Episode 489/500 - Reward: 994.13, Avg Reward: 994.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:01:01,829 - TrafficRL.Train - INFO - Episode 490/500 - Reward: 995.17, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:01:16,395 - TrafficRL.Train - INFO - Episode 491/500 - Reward: 993.34, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:01:29,165 - TrafficRL.Train - INFO - Episode 492/500 - Reward: 995.87, Avg Reward: 994.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:01:43,537 - TrafficRL.Train - INFO - Episode 493/500 - Reward: 995.02, Avg Reward: 994.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:01:58,366 - TrafficRL.Train - INFO - Episode 494/500 - Reward: 994.44, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:02:13,321 - TrafficRL.Train - INFO - Episode 495/500 - Reward: 994.54, Avg Reward: 994.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:02:29,034 - TrafficRL.Train - INFO - Episode 496/500 - Reward: 994.76, Avg Reward: 994.46, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:02:40,141 - TrafficRL.Train - INFO - Episode 497/500 - Reward: 993.67, Avg Reward: 994.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:02:51,276 - TrafficRL.Train - INFO - Episode 498/500 - Reward: 993.25, Avg Reward: 994.43, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:03:01,779 - TrafficRL.Train - INFO - Episode 499/500 - Reward: 993.14, Avg Reward: 994.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:03:12,732 - TrafficRL.Train - INFO - Episode 500/500 - Reward: 992.56, Avg Reward: 994.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-08 22:03:12,732 - TrafficRL.Train - INFO - Evaluating agent at episode 500...
2025-03-08 22:03:18,390 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 79264.06
2025-03-08 22:03:18,390 - TrafficRL.Train - INFO - No improvement for 18 evaluations
2025-03-08 22:03:18,477 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_500.pth
2025-03-08 22:03:18,477 - TrafficRL.Train - INFO - Model checkpoint saved at episode 500
2025-03-08 22:03:18,570 - TrafficRL.Agent - INFO - Model saved to results/training/final_model.pth
2025-03-08 22:03:18,571 - TrafficRL.Train - INFO - Final model saved successfully
2025-03-08 22:03:18,572 - TrafficRL.Train - INFO - Total training time: 6517.85 seconds
2025-03-08 22:03:18,969 - TrafficRL - INFO - Training complete, visualizing results...
2025-03-08 22:03:20,025 - TrafficRL - INFO - Training visualization saved to results/training/training_progress.png
2025-03-08 22:03:20,035 - TrafficRL - INFO - Training metrics saved to results/training/training_metrics.json
2025-03-08 22:03:20,035 - TrafficRL - INFO - Training Summary:
2025-03-08 22:03:20,035 - TrafficRL - INFO -   Episodes Completed: 500
2025-03-08 22:03:20,035 - TrafficRL - INFO -   Final Average Reward: 994.3985690578576
2025-03-08 22:03:20,035 - TrafficRL - INFO -   Best Model Path: results/training/best_model.pth
2025-03-08 22:27:29,897 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 22:27:29,922 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 22:27:31,615 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_222729/training_training
2025-03-08 22:27:31,615 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 22:27:31,615 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 22:27:31,615 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 22:27:31,615 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 22:27:31,615 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 22:27:31,617 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 22:27:36,446 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 22:27:36,447 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 22:27:36,447 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 22:27:36,447 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 22:27:36,447 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:27:41,236 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 22:27:41,237 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 22:27:41,237 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 22:27:41,237 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 22:27:41,237 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:27:45,922 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 22:27:45,923 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 22:27:45,923 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 22:27:45,924 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 22:27:45,924 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:27:50,628 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 22:27:50,628 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 22:27:50,628 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 22:27:50,628 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 22:27:50,628 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 22:27:55,130 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 22:27:55,131 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 22:27:55,131 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 22:27:55,131 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 22:27:55,131 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 22:27:59,782 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 22:27:59,782 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 22:27:59,782 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 22:27:59,783 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 22:27:59,783 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:28:04,792 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 22:28:04,793 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 22:28:04,793 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 22:28:04,793 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 22:28:04,793 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:28:09,402 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 22:28:09,403 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 22:28:09,403 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 22:28:09,403 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 22:28:09,403 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:28:14,157 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 22:28:14,158 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 22:28:14,158 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 22:28:14,159 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 22:28:14,159 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:28:14,160 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:28:14,160 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:28:16,428 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:28:16,464 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:28:27,243 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 22:28:27,244 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 22:28:27,244 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 22:28:27,244 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 22:28:27,244 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 22:28:27,247 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:28:27,247 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:28:27,258 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:28:27,273 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:28:37,562 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 22:28:37,562 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 22:28:37,562 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 22:28:37,562 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 22:28:37,562 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 22:28:37,565 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:28:37,565 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:28:37,572 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:28:37,587 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:28:48,131 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 22:28:48,132 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 22:28:48,132 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 22:28:48,132 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 22:28:48,132 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 22:28:48,149 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_222729/benchmark/benchmark_20250308_222731/benchmark_results.json
2025-03-08 22:29:02,241 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_222729/benchmark/benchmark_20250308_222731/plots
2025-03-08 22:29:02,251 - TrafficRL - INFO - Benchmark completed.
2025-03-08 22:29:02,252 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 22:29:02,252 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 22:29:03,611 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 22:29:03,628 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1875, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 22:29:03,628 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 22:29:03,628 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 22:29:03,629 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 22:29:03,629 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 22:29:03,633 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 22:29:03,633 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 22:29:03,634 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 22:29:03,635 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 22:29:03,635 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 22:29:03,635 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 22:29:03,635 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 22:29:03,636 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_222729/report/analysis_report.html
2025-03-08 22:29:03,637 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_222729
2025-03-08 22:29:03,637 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_222729
2025-03-08 22:29:03,638 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_222729/report/analysis_report.html
2025-03-08 22:42:03,409 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 22:42:03,412 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 22:42:05,182 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_224203/training_training
2025-03-08 22:42:05,182 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 22:42:05,182 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 22:42:05,182 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 22:42:05,183 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 22:42:05,183 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 22:42:05,183 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 22:42:10,231 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 22:42:10,231 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 22:42:10,231 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 22:42:10,231 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 22:42:10,231 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:42:14,942 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 22:42:14,943 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 22:42:14,943 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 22:42:14,943 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 22:42:14,943 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:42:19,811 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 22:42:19,812 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 22:42:19,812 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 22:42:19,812 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 22:42:19,812 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:42:24,517 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 22:42:24,518 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 22:42:24,518 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 22:42:24,518 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 22:42:24,518 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 22:42:29,074 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 22:42:29,074 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 22:42:29,074 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 22:42:29,074 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 22:42:29,074 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 22:42:33,785 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 22:42:33,785 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 22:42:33,785 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 22:42:33,785 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 22:42:33,785 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:42:38,622 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 22:42:38,622 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 22:42:38,622 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 22:42:38,622 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 22:42:38,623 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:42:43,333 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 22:42:43,333 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 22:42:43,333 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 22:42:43,334 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 22:42:43,334 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:42:48,184 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 22:42:48,184 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 22:42:48,184 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 22:42:48,185 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 22:42:48,185 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:42:48,186 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:42:48,186 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:42:50,424 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:42:50,461 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:43:00,974 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 22:43:00,975 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 22:43:00,975 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 22:43:00,975 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 22:43:00,975 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 22:43:00,977 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:43:00,978 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:43:00,985 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:43:01,003 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:43:11,522 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 22:43:11,522 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 22:43:11,522 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 22:43:11,523 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 22:43:11,523 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 22:43:11,525 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:43:11,525 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:43:11,533 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:43:11,547 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:43:22,599 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 22:43:22,599 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 22:43:22,599 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 22:43:22,600 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 22:43:22,600 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 22:43:22,620 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_224203/benchmark/benchmark_20250308_224205/benchmark_results.json
2025-03-08 22:43:36,806 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_224203/benchmark/benchmark_20250308_224205/plots
2025-03-08 22:43:36,818 - TrafficRL - INFO - Benchmark completed.
2025-03-08 22:43:36,818 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 22:43:36,818 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 22:43:38,158 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 22:43:38,176 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1875, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 22:43:38,177 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 22:43:38,177 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 22:43:38,179 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:43:38,179 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:43:38,191 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:43:38,220 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:43:38,224 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 22:43:38,333 - TrafficRL.Utils.Analysis - ERROR - Error visualizing learning progress: too many indices for array: array is 2-dimensional, but 3 were indexed
2025-03-08 22:43:38,334 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1058, in visualize_learning_progress
    surf = ax.plot_surface(x, y, q_values[:, :, action], cmap='viridis',
                                ~~~~~~~~^^^^^^^^^^^^^^
IndexError: too many indices for array: array is 2-dimensional, but 3 were indexed

2025-03-08 22:43:38,334 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_224203/agent_training/q_values
2025-03-08 22:43:38,334 - TrafficRL - ERROR - Error in comprehensive analysis: 'DQNAgent' object has no attribute 'model'
2025-03-08 22:43:38,336 - TrafficRL - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/analyze.py", line 282, in run_comprehensive_analysis
    "q_values_dir": os.path.join(agent_output, "q_values") if agent.model else None
                                                              ^^^^^^^^^^^
AttributeError: 'DQNAgent' object has no attribute 'model'

2025-03-08 22:43:38,340 - TrafficRL - ERROR - Analysis failed.
2025-03-08 22:46:30,247 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 22:46:30,248 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 22:46:32,030 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_224630/training_training
2025-03-08 22:46:32,030 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 22:46:32,030 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 22:46:32,030 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 22:46:32,031 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 22:46:32,031 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 22:46:32,032 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 22:46:36,956 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 22:46:36,957 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 22:46:36,957 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 22:46:36,957 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 22:46:36,958 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:46:41,628 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 22:46:41,628 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 22:46:41,628 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 22:46:41,628 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 22:46:41,628 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:46:46,304 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 22:46:46,304 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 22:46:46,304 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 22:46:46,305 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 22:46:46,305 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:46:50,985 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 22:46:50,985 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 22:46:50,986 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 22:46:50,986 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 22:46:50,986 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 22:46:55,598 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 22:46:55,600 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 22:46:55,600 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 22:46:55,600 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 22:46:55,600 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 22:47:00,285 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 22:47:00,285 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 22:47:00,285 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 22:47:00,285 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 22:47:00,285 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:47:05,107 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 22:47:05,108 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 22:47:05,108 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 22:47:05,108 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 22:47:05,108 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:47:09,753 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 22:47:09,753 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 22:47:09,753 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 22:47:09,753 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 22:47:09,754 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:47:14,512 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 22:47:14,512 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 22:47:14,513 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 22:47:14,513 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 22:47:14,513 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:47:14,514 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:47:14,514 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:47:16,814 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:47:16,850 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:47:27,430 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 22:47:27,431 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 22:47:27,431 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 22:47:27,431 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 22:47:27,431 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 22:47:27,433 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:47:27,434 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:47:27,443 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:47:27,460 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:47:37,766 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 22:47:37,767 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 22:47:37,767 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 22:47:37,767 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 22:47:37,767 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 22:47:37,771 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:47:37,771 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:47:37,782 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:47:37,799 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:47:49,083 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 22:47:49,084 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 22:47:49,084 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 22:47:49,084 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 22:47:49,084 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 22:47:49,102 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_224630/benchmark/benchmark_20250308_224632/benchmark_results.json
2025-03-08 22:48:03,211 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_224630/benchmark/benchmark_20250308_224632/plots
2025-03-08 22:48:03,221 - TrafficRL - INFO - Benchmark completed.
2025-03-08 22:48:03,221 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 22:48:03,221 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 22:48:04,508 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 22:48:04,526 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1884, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 22:48:04,527 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 22:48:04,527 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 22:48:04,528 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:48:04,528 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:48:04,536 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:48:04,578 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:48:04,583 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 22:48:04,718 - TrafficRL.Utils.Analysis - ERROR - Error visualizing learning progress: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (2, 100) and arg 2 with shape (10, 10).
2025-03-08 22:48:04,724 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1067, in visualize_learning_progress
    surf = ax.plot_surface(x, y, q_values_reshaped, cmap='viridis',
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/mpl_toolkits/mplot3d/axes3d.py", line 2000, in plot_surface
    X, Y, Z = np.broadcast_arrays(X, Y, Z)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/numpy/lib/stride_tricks.py", line 540, in broadcast_arrays
    shape = _broadcast_shape(*args)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/numpy/lib/stride_tricks.py", line 422, in _broadcast_shape
    b = np.broadcast(*args[:32])
        ^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (2, 100) and arg 2 with shape (10, 10).

2025-03-08 22:48:04,724 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_224630/agent_training/q_values
2025-03-08 22:48:04,725 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 22:48:04,725 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 22:48:04,730 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 22:48:04,730 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 22:48:04,730 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 22:48:04,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 22:48:04,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 22:48:04,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 22:48:04,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 22:48:04,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 22:48:04,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 22:48:04,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 22:48:04,733 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 22:48:04,733 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 22:48:04,733 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_224630/report/analysis_report.html
2025-03-08 22:48:04,736 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_224630
2025-03-08 22:48:04,738 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_224630
2025-03-08 22:48:04,739 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_224630/report/analysis_report.html
2025-03-08 22:49:47,345 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 22:49:47,347 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 22:49:49,120 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_224947/training_training
2025-03-08 22:49:49,120 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 22:49:49,121 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 22:49:49,121 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 22:49:49,121 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 22:49:49,121 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 22:49:49,122 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 22:49:54,246 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 22:49:54,246 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 22:49:54,247 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 22:49:54,247 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 22:49:54,247 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:49:58,955 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 22:49:58,955 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 22:49:58,955 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 22:49:58,955 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 22:49:58,955 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:50:03,819 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 22:50:03,820 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 22:50:03,821 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 22:50:03,822 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 22:50:03,824 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 22:50:08,658 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 22:50:08,659 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 22:50:08,659 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 22:50:08,659 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 22:50:08,659 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 22:50:14,116 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 22:50:14,117 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 22:50:14,117 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 22:50:14,117 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 22:50:14,117 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 22:50:18,912 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 22:50:18,912 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 22:50:18,912 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 22:50:18,912 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 22:50:18,912 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:50:23,763 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 22:50:23,763 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 22:50:23,763 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 22:50:23,763 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 22:50:23,763 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:50:28,449 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 22:50:28,449 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 22:50:28,449 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 22:50:28,449 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 22:50:28,449 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 22:50:33,142 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 22:50:33,142 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 22:50:33,143 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 22:50:33,143 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 22:50:33,143 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 22:50:33,144 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:50:33,145 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:50:35,593 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:50:35,637 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:50:45,584 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 22:50:45,585 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 22:50:45,585 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 22:50:45,585 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 22:50:45,585 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 22:50:45,587 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:50:45,587 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:50:45,594 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:50:45,608 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:50:55,506 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 22:50:55,506 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 22:50:55,506 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 22:50:55,506 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 22:50:55,506 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 22:50:55,509 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:50:55,509 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:50:55,516 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:50:55,531 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:51:05,627 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 22:51:05,627 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 22:51:05,627 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 22:51:05,627 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 22:51:05,627 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 22:51:05,645 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_224947/benchmark/benchmark_20250308_224949/benchmark_results.json
2025-03-08 22:51:19,225 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_224947/benchmark/benchmark_20250308_224949/plots
2025-03-08 22:51:19,235 - TrafficRL - INFO - Benchmark completed.
2025-03-08 22:51:19,235 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 22:51:19,235 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 22:51:20,783 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 22:51:20,801 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1890, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 22:51:20,802 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 22:51:20,802 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 22:51:20,803 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 22:51:20,804 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 22:51:20,817 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 22:51:20,843 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 22:51:20,843 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 22:51:24,720 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_224947/agent_training/q_values
2025-03-08 22:51:24,721 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_224947/agent_training/q_values
2025-03-08 22:51:24,723 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 22:51:24,725 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 22:51:24,730 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 22:51:24,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 22:51:24,731 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 22:51:24,732 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 22:51:24,733 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 22:51:24,733 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 22:51:24,733 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 22:51:24,733 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_224947/report/analysis_report.html
2025-03-08 22:51:24,736 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_224947
2025-03-08 22:51:24,741 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_224947
2025-03-08 22:51:24,741 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_224947/report/analysis_report.html
2025-03-08 23:20:21,054 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:20:21,103 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:20:22,861 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_232021/training_training
2025-03-08 23:20:22,862 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:20:22,862 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:20:22,862 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:20:22,862 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:20:22,862 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:20:22,864 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:20:27,850 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:20:27,850 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:20:27,850 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:20:27,850 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:20:27,851 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:20:32,650 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:20:32,651 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:20:32,651 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:20:32,651 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:20:32,651 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:20:37,401 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:20:37,401 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:20:37,401 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:20:37,401 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:20:37,401 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:20:42,103 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:20:42,104 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:20:42,104 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:20:42,104 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:20:42,104 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:20:46,680 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:20:46,680 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:20:46,681 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:20:46,681 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:20:46,681 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:20:51,382 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:20:51,382 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:20:51,382 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:20:51,382 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:20:51,383 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:20:56,281 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:20:56,281 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:20:56,281 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:20:56,282 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:20:56,282 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:21:00,985 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:21:00,985 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:21:00,985 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:21:00,985 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:21:00,985 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:21:05,843 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:21:05,843 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:21:05,843 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:21:05,844 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:21:05,844 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:21:05,845 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:21:05,845 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:21:08,044 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:21:08,080 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:21:18,487 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:21:18,487 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:21:18,488 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:21:18,488 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:21:18,488 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:21:18,491 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:21:18,492 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:21:18,499 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:21:18,518 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:21:29,006 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:21:29,006 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:21:29,006 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:21:29,006 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:21:29,006 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:21:29,009 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:21:29,009 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:21:29,016 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:21:29,031 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:21:39,861 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:21:39,862 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:21:39,862 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:21:39,863 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:21:39,863 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:21:39,900 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_232021/benchmark/benchmark_20250308_232022/benchmark_results.json
2025-03-08 23:21:54,230 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_232021/benchmark/benchmark_20250308_232022/plots
2025-03-08 23:21:54,241 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:21:54,242 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:21:54,242 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:21:55,614 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:21:55,629 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1890, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:21:55,630 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:21:55,630 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:21:55,630 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:21:55,631 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:21:55,643 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:21:55,670 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:21:55,674 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:21:56,624 - TrafficRL.Utils.Analysis - ERROR - Error visualizing learning progress: Found array with dim 3. PCA expected <= 2.
2025-03-08 23:21:56,631 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1123, in visualize_learning_progress
    pca_result = pca.fit_transform(combined_states)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 468, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 505, in _fit
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1101, in check_array
    raise ValueError(
ValueError: Found array with dim 3. PCA expected <= 2.

2025-03-08 23:21:56,631 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_232021/agent_training/q_values
2025-03-08 23:21:56,632 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:21:56,632 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:21:56,637 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:21:56,638 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:21:56,639 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:21:56,639 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:21:56,639 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:21:56,639 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:21:56,639 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:21:56,640 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_232021/report/analysis_report.html
2025-03-08 23:21:56,642 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_232021
2025-03-08 23:21:56,646 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_232021
2025-03-08 23:21:56,646 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_232021/report/analysis_report.html
2025-03-08 23:27:03,169 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:27:03,176 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:27:04,956 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_232703/training_training
2025-03-08 23:27:04,956 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:27:04,956 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:27:04,956 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:27:04,956 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:27:04,957 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:27:04,958 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:27:10,031 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:27:10,031 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:27:10,032 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:27:10,032 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:27:10,032 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:27:14,713 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:27:14,714 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:27:14,714 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:27:14,714 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:27:14,714 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:27:19,457 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:27:19,457 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:27:19,458 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:27:19,458 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:27:19,458 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:27:24,116 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:27:24,116 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:27:24,116 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:27:24,116 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:27:24,116 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:27:28,608 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:27:28,608 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:27:28,608 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:27:28,608 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:27:28,608 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:27:33,249 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:27:33,249 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:27:33,249 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:27:33,249 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:27:33,250 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:27:38,044 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:27:38,044 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:27:38,045 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:27:38,045 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:27:38,045 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:27:42,636 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:27:42,636 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:27:42,636 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:27:42,636 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:27:42,636 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:27:47,399 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:27:47,399 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:27:47,399 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:27:47,399 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:27:47,399 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:27:47,401 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:27:47,401 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:27:49,663 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:27:49,700 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:28:00,067 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:28:00,067 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:28:00,067 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:28:00,068 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:28:00,068 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:28:00,070 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:28:00,071 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:28:00,080 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:28:00,096 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:28:10,510 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:28:10,511 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:28:10,511 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:28:10,512 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:28:10,512 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:28:10,514 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:28:10,514 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:28:10,522 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:28:10,544 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:28:21,239 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:28:21,240 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:28:21,240 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:28:21,240 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:28:21,240 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:28:21,258 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_232703/benchmark/benchmark_20250308_232704/benchmark_results.json
2025-03-08 23:28:35,020 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_232703/benchmark/benchmark_20250308_232704/plots
2025-03-08 23:28:35,034 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:28:35,034 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:28:35,034 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:28:36,397 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:28:36,412 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1933, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:28:36,412 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:28:36,413 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:28:36,414 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:28:36,414 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:28:36,422 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:28:36,449 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:28:36,452 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:28:39,673 - TrafficRL.Utils.Analysis - ERROR - Error visualizing learning progress: Found array with dim 4. PCA expected <= 2.
2025-03-08 23:28:39,681 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1166, in visualize_learning_progress
    pca_result = pca.fit_transform(combined_states)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 468, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 505, in _fit
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1101, in check_array
    raise ValueError(
ValueError: Found array with dim 4. PCA expected <= 2.

2025-03-08 23:28:39,681 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_232703/agent_training/q_values
2025-03-08 23:28:39,682 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:28:39,682 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:28:39,686 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:28:39,687 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:28:39,687 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:28:39,687 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:28:39,688 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:28:39,689 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:28:39,689 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:28:39,689 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_232703/report/analysis_report.html
2025-03-08 23:28:39,691 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_232703
2025-03-08 23:28:39,695 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_232703
2025-03-08 23:28:39,695 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_232703/report/analysis_report.html
2025-03-08 23:35:18,780 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:35:18,789 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:35:20,663 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_233518/training_training
2025-03-08 23:35:20,663 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:35:20,663 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:35:20,663 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:35:20,663 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:35:20,663 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:35:20,665 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:35:25,704 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:35:25,706 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:35:25,706 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:35:25,706 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:35:25,706 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:35:30,352 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:35:30,353 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:35:30,353 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:35:30,353 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:35:30,353 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:35:34,986 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:35:34,986 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:35:34,987 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:35:34,987 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:35:34,987 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:35:39,643 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:35:39,643 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:35:39,643 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:35:39,643 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:35:39,643 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:35:44,142 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:35:44,142 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:35:44,143 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:35:44,143 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:35:44,143 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:35:48,862 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:35:48,862 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:35:48,862 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:35:48,862 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:35:48,862 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:35:53,615 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:35:53,616 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:35:53,616 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:35:53,616 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:35:53,616 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:35:58,230 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:35:58,230 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:35:58,230 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:35:58,230 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:35:58,230 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:36:03,042 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:36:03,042 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:36:03,042 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:36:03,042 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:36:03,042 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:36:03,044 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:36:03,044 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:36:05,292 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:36:05,331 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:36:15,766 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:36:15,766 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:36:15,767 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:36:15,767 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:36:15,767 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:36:15,769 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:36:15,769 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:36:15,777 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:36:15,794 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:36:26,611 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:36:26,612 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:36:26,612 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:36:26,612 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:36:26,612 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:36:26,615 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:36:26,615 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:36:26,622 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:36:26,638 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:36:37,432 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:36:37,432 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:36:37,432 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:36:37,432 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:36:37,432 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:36:37,449 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_233518/benchmark/benchmark_20250308_233520/benchmark_results.json
2025-03-08 23:36:51,537 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_233518/benchmark/benchmark_20250308_233520/plots
2025-03-08 23:36:51,551 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:36:51,551 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:36:51,551 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:36:52,925 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:36:52,957 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1987, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:36:52,957 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:36:52,957 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:36:52,958 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:36:52,958 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:36:52,968 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:36:52,992 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:36:52,992 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:37:01,259 - TrafficRL.Utils.Analysis - ERROR - Error visualizing learning progress: Found array with dim 4. PCA expected <= 2.
2025-03-08 23:37:01,266 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1220, in visualize_learning_progress
    pca_result = pca.fit_transform(combined_states)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 468, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/decomposition/_pca.py", line 505, in _fit
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1101, in check_array
    raise ValueError(
ValueError: Found array with dim 4. PCA expected <= 2.

2025-03-08 23:37:01,267 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_233518/agent_training/q_values
2025-03-08 23:37:01,267 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:37:01,267 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:37:01,271 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:37:01,271 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:37:01,271 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:37:01,272 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:37:01,272 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:37:01,272 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:37:01,273 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:37:01,274 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_233518/report/analysis_report.html
2025-03-08 23:37:01,276 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_233518
2025-03-08 23:37:01,292 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_233518
2025-03-08 23:37:01,293 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_233518/report/analysis_report.html
2025-03-08 23:39:48,675 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:39:48,679 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:39:50,503 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_233948/training_training
2025-03-08 23:39:50,503 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:39:50,503 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:39:50,504 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:39:50,504 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:39:50,504 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:39:50,505 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:39:55,609 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:39:55,611 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:39:55,611 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:39:55,611 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:39:55,611 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:40:00,302 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:40:00,302 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:40:00,303 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:40:00,303 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:40:00,303 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:40:05,210 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:40:05,213 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:40:05,213 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:40:05,214 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:40:05,214 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:40:09,941 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:40:09,941 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:40:09,941 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:40:09,941 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:40:09,941 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:40:14,517 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:40:14,517 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:40:14,518 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:40:14,518 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:40:14,518 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:40:19,250 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:40:19,250 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:40:19,251 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:40:19,251 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:40:19,251 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:40:24,133 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:40:24,133 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:40:24,133 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:40:24,135 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:40:24,135 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:40:28,808 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:40:28,808 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:40:28,808 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:40:28,808 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:40:28,808 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:40:33,628 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:40:33,628 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:40:33,628 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:40:33,628 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:40:33,629 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:40:33,630 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:40:33,630 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:40:35,917 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:40:35,953 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:40:46,391 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:40:46,391 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:40:46,392 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:40:46,392 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:40:46,392 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:40:46,395 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:40:46,395 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:40:46,402 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:40:46,418 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:40:57,056 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:40:57,056 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:40:57,056 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:40:57,056 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:40:57,056 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:40:57,059 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:40:57,059 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:40:57,066 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:40:57,081 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:41:07,918 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:41:07,918 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:41:07,918 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:41:07,918 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:41:07,918 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:41:07,936 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_233948/benchmark/benchmark_20250308_233950/benchmark_results.json
2025-03-08 23:41:22,283 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_233948/benchmark/benchmark_20250308_233950/plots
2025-03-08 23:41:22,294 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:41:22,294 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:41:22,294 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:41:23,888 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:41:23,907 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1995, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:41:23,907 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:41:23,907 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:41:23,908 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:41:23,908 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:41:23,917 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:41:23,948 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:41:23,949 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:41:33,298 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-08 23:41:33,512 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-08 23:41:35,582 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_233948/agent_training/q_values
2025-03-08 23:41:35,583 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_233948/agent_training/q_values
2025-03-08 23:41:35,584 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:41:35,584 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:41:35,587 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:41:35,588 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:41:35,588 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:41:35,588 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:41:35,588 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:41:35,588 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:41:35,589 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:41:35,589 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:41:35,589 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:41:35,590 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:41:35,590 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:41:35,590 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:41:35,590 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_233948/report/analysis_report.html
2025-03-08 23:41:35,592 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_233948
2025-03-08 23:41:35,612 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_233948
2025-03-08 23:41:35,613 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_233948/report/analysis_report.html
2025-03-08 23:43:51,770 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:43:51,773 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:43:53,482 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_234351/training_training
2025-03-08 23:43:53,482 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:43:53,482 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:43:53,482 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:43:53,483 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:43:53,483 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:43:53,484 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:43:58,532 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:43:58,532 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:43:58,533 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:43:58,533 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:43:58,533 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:44:03,298 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:44:03,299 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:44:03,299 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:44:03,299 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:44:03,299 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:44:08,140 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:44:08,140 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:44:08,140 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:44:08,140 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:44:08,140 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:44:13,057 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:44:13,058 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:44:13,058 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:44:13,058 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:44:13,058 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:44:17,781 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:44:17,781 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:44:17,782 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:44:17,782 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:44:17,782 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:44:22,720 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:44:22,720 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:44:22,720 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:44:22,720 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:44:22,720 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:44:27,755 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:44:27,756 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:44:27,756 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:44:27,756 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:44:27,756 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:44:32,678 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:44:32,679 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:44:32,679 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:44:32,679 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:44:32,679 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:44:37,692 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:44:37,692 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:44:37,693 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:44:37,693 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:44:37,693 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:44:37,694 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:44:37,694 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:44:39,913 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:44:39,946 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:44:50,783 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:44:50,783 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:44:50,783 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:44:50,783 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:44:50,783 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:44:50,786 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:44:50,786 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:44:50,794 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:44:50,809 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:45:01,930 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:45:01,931 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:45:01,931 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:45:01,931 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:45:01,931 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:45:01,934 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:45:01,934 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:45:01,941 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:45:01,957 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:45:13,136 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:45:13,137 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:45:13,137 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:45:13,137 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:45:13,137 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:45:13,156 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_234351/benchmark/benchmark_20250308_234353/benchmark_results.json
2025-03-08 23:45:27,114 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_234351/benchmark/benchmark_20250308_234353/plots
2025-03-08 23:45:27,126 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:45:27,127 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:45:27,127 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:45:28,594 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:45:28,608 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 2013, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:45:28,609 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:45:28,609 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:45:28,610 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:45:28,610 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:45:28,619 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:45:28,644 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:45:28,644 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:45:37,116 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-08 23:45:37,160 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-08 23:45:38,497 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_234351/agent_training/q_values
2025-03-08 23:45:38,498 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_234351/agent_training/q_values
2025-03-08 23:45:38,499 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:45:38,499 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:45:38,504 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:45:38,505 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:45:38,505 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:45:38,505 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:45:38,505 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:45:38,506 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:45:38,506 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:45:38,506 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:45:38,506 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:45:38,506 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:45:38,507 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:45:38,507 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:45:38,507 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_234351/report/analysis_report.html
2025-03-08 23:45:38,509 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_234351
2025-03-08 23:45:38,533 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_234351
2025-03-08 23:45:38,533 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_234351/report/analysis_report.html
2025-03-08 23:47:55,883 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:47:55,887 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:47:57,704 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_234755/training_training
2025-03-08 23:47:57,704 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:47:57,704 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:47:57,704 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:47:57,705 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:47:57,705 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:47:57,706 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:48:03,082 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:48:03,083 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:48:03,083 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:48:03,083 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:48:03,083 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:48:07,947 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:48:07,947 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:48:07,948 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:48:07,948 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:48:07,948 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:48:12,871 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:48:12,871 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:48:12,871 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:48:12,871 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:48:12,872 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:48:17,764 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:48:17,765 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:48:17,765 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:48:17,765 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:48:17,765 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:48:22,451 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:48:22,451 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:48:22,451 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:48:22,451 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:48:22,451 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:48:27,335 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:48:27,335 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:48:27,335 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:48:27,335 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:48:27,335 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:48:32,327 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:48:32,327 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:48:32,327 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:48:32,328 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:48:32,328 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:48:37,168 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:48:37,168 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:48:37,168 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:48:37,168 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:48:37,168 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:48:42,092 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:48:42,092 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:48:42,092 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:48:42,093 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:48:42,093 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:48:42,094 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:48:42,094 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:48:44,334 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:48:44,374 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:48:54,953 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:48:54,954 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:48:54,954 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:48:54,954 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:48:54,955 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:48:54,957 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:48:54,957 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:48:54,965 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:48:54,984 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:49:06,864 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:49:06,865 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:49:06,866 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:49:06,866 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:49:06,866 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:49:06,869 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:49:06,869 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:49:06,876 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:49:06,894 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:49:17,859 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:49:17,859 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:49:17,859 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:49:17,859 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:49:17,859 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:49:17,879 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_234755/benchmark/benchmark_20250308_234757/benchmark_results.json
2025-03-08 23:49:32,242 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_234755/benchmark/benchmark_20250308_234757/plots
2025-03-08 23:49:32,253 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:49:32,253 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:49:32,253 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:49:33,644 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:49:33,659 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 2004, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:49:33,660 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:49:33,660 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:49:33,661 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:49:33,661 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:49:33,670 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:49:33,695 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:49:33,696 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:49:41,920 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-08 23:49:41,986 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-08 23:49:43,516 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_234755/agent_training/q_values
2025-03-08 23:49:43,517 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_234755/agent_training/q_values
2025-03-08 23:49:43,518 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:49:43,518 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:49:43,522 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:49:43,522 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:49:43,522 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:49:43,522 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:49:43,523 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:49:43,524 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:49:43,524 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:49:43,524 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_234755/report/analysis_report.html
2025-03-08 23:49:43,526 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_234755
2025-03-08 23:49:43,545 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_234755
2025-03-08 23:49:43,545 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_234755/report/analysis_report.html
2025-03-08 23:51:49,141 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:51:49,144 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:51:50,937 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_235149/training_training
2025-03-08 23:51:50,937 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:51:50,938 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:51:50,938 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:51:50,938 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:51:50,938 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:51:50,939 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:51:56,138 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:51:56,138 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:51:56,138 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:51:56,138 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:51:56,139 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:52:00,874 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:52:00,875 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:52:00,876 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:52:00,876 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:52:00,876 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:52:05,755 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:52:05,755 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:52:05,755 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:52:05,756 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:52:05,756 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:52:10,502 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:52:10,502 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:52:10,502 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:52:10,502 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:52:10,502 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:52:15,294 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:52:15,294 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:52:15,295 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:52:15,295 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:52:15,295 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:52:20,125 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:52:20,125 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:52:20,125 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:52:20,125 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:52:20,125 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:52:25,068 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:52:25,070 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:52:25,070 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:52:25,070 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:52:25,071 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:52:29,881 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:52:29,881 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:52:29,881 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:52:29,882 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:52:29,882 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:52:34,852 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:52:34,852 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:52:34,852 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:52:34,852 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:52:34,852 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:52:34,854 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:52:34,854 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:52:37,107 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:52:37,143 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:52:47,600 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:52:47,600 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:52:47,601 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:52:47,601 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:52:47,601 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:52:47,603 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:52:47,604 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:52:47,611 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:52:47,626 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:52:58,545 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:52:58,546 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:52:58,546 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:52:58,546 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:52:58,546 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:52:58,548 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:52:58,548 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:52:58,556 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:52:58,571 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:53:09,591 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:53:09,591 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:53:09,591 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:53:09,592 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:53:09,592 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:53:09,611 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_235149/benchmark/benchmark_20250308_235150/benchmark_results.json
2025-03-08 23:53:23,982 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_235149/benchmark/benchmark_20250308_235150/plots
2025-03-08 23:53:23,994 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:53:23,994 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:53:23,994 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:53:25,408 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:53:25,425 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 2026, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:53:25,425 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:53:25,425 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:53:25,426 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:53:25,426 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:53:25,437 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:53:25,463 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:53:25,463 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:53:34,258 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-08 23:53:34,302 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-08 23:53:35,606 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_235149/agent_training/q_values
2025-03-08 23:53:35,607 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_235149/agent_training/q_values
2025-03-08 23:53:35,608 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:53:35,608 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:53:35,612 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:53:35,612 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:53:35,613 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:53:35,613 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:53:35,613 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:53:35,613 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:53:35,614 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:53:35,614 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:53:35,614 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:53:35,614 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:53:35,615 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:53:35,615 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:53:35,616 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_235149/report/analysis_report.html
2025-03-08 23:53:35,618 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_235149
2025-03-08 23:53:35,640 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_235149
2025-03-08 23:53:35,640 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_235149/report/analysis_report.html
2025-03-08 23:56:54,816 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-08 23:56:54,826 - TrafficRL - INFO - Analyzing training metrics...
2025-03-08 23:56:56,662 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250308_235654/training_training
2025-03-08 23:56:56,662 - TrafficRL - INFO - Training analysis for training completed.
2025-03-08 23:56:56,662 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-08 23:56:56,663 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-08 23:56:56,663 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-08 23:56:56,663 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-08 23:56:56,664 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-08 23:57:01,704 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-08 23:57:01,705 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-08 23:57:01,705 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-08 23:57:01,705 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-08 23:57:01,705 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:57:06,558 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-08 23:57:06,558 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-08 23:57:06,558 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-08 23:57:06,558 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-08 23:57:06,558 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:57:11,444 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-08 23:57:11,445 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-08 23:57:11,445 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-08 23:57:11,445 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-08 23:57:11,446 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-08 23:57:16,264 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-08 23:57:16,264 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-08 23:57:16,264 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-08 23:57:16,264 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-08 23:57:16,264 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-08 23:57:20,937 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-08 23:57:20,938 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-08 23:57:20,938 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-08 23:57:20,938 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-08 23:57:20,938 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-08 23:57:25,764 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-08 23:57:25,765 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-08 23:57:25,765 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-08 23:57:25,765 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-08 23:57:25,765 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:57:30,771 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-08 23:57:30,771 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-08 23:57:30,771 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-08 23:57:30,771 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-08 23:57:30,771 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:57:35,575 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-08 23:57:35,575 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-08 23:57:35,575 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-08 23:57:35,575 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-08 23:57:35,575 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-08 23:57:40,595 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-08 23:57:40,596 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-08 23:57:40,596 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-08 23:57:40,596 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-08 23:57:40,596 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-08 23:57:40,597 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:57:40,597 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:57:42,843 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:57:42,880 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:57:53,581 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-08 23:57:53,581 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-08 23:57:53,581 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-08 23:57:53,581 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-08 23:57:53,582 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-08 23:57:53,584 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:57:53,584 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:57:53,591 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:57:53,607 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:58:04,812 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-08 23:58:04,813 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-08 23:58:04,813 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-08 23:58:04,813 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-08 23:58:04,813 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-08 23:58:04,815 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:58:04,816 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:58:04,822 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:58:04,845 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:58:16,276 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-08 23:58:16,276 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-08 23:58:16,276 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-08 23:58:16,276 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-08 23:58:16,276 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-08 23:58:16,294 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250308_235654/benchmark/benchmark_20250308_235656/benchmark_results.json
2025-03-08 23:58:30,359 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250308_235654/benchmark/benchmark_20250308_235656/plots
2025-03-08 23:58:30,369 - TrafficRL - INFO - Benchmark completed.
2025-03-08 23:58:30,370 - TrafficRL - INFO - Processing benchmark results...
2025-03-08 23:58:30,370 - TrafficRL - INFO - Running comparative analysis...
2025-03-08 23:58:31,926 - TrafficRL.Utils.Analysis - ERROR - Error in comparative analysis: Image data of dtype object cannot be converted to float
2025-03-08 23:58:31,943 - TrafficRL.Utils.Analysis - ERROR - Traceback (most recent call last):
  File "/Users/charles/Desktop/STUDY/Polytechnique - MScT AI & VC/Courses/M1/S2/Atonomous Agents/Final_Project/TrafficRL/traffic_rl/utils/analysis.py", line 1998, in comparative_analysis
    sns.heatmap(pattern_impact_data, annot=True, cmap="YlGnBu", fmt=".1f")
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 459, in heatmap
    plotter.plot(ax, cbar_ax, kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/seaborn/matrix.py", line 306, in plot
    mesh = ax.pcolormesh(self.plot_data, cmap=self.cmap, **kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/__init__.py", line 1473, in inner
    return func(
           ^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/axes/_axes.py", line 6434, in pcolormesh
    collection = mcoll.QuadMesh(
                 ^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2146, in __init__
    Collection.__init__(self, **kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 206, in __init__
    self._internal_update(kwargs)
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1216, in _internal_update
    return self._update_props(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/artist.py", line 1192, in _update_props
    ret.append(func(v))
               ^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/collections.py", line 2020, in set_array
    return super().set_array(A)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/.pyenv/versions/3.12.5/lib/python3.12/site-packages/matplotlib/cm.py", line 452, in set_array
    raise TypeError(f"Image data of dtype {A.dtype} cannot be "
TypeError: Image data of dtype object cannot be converted to float

2025-03-08 23:58:31,943 - TrafficRL - INFO - Comparative analysis completed.
2025-03-08 23:58:31,943 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-08 23:58:31,944 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-08 23:58:31,944 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-08 23:58:31,952 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-08 23:58:31,979 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-08 23:58:31,979 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-08 23:58:40,647 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-08 23:58:40,694 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-08 23:58:41,926 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250308_235654/agent_training/q_values
2025-03-08 23:58:41,928 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250308_235654/agent_training/q_values
2025-03-08 23:58:41,929 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-08 23:58:41,929 - TrafficRL - INFO - Generating comprehensive report...
2025-03-08 23:58:41,932 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-08 23:58:41,933 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-08 23:58:41,933 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-08 23:58:41,933 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-08 23:58:41,933 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-08 23:58:41,934 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-08 23:58:41,934 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-08 23:58:41,935 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-08 23:58:41,935 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-08 23:58:41,935 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-08 23:58:41,936 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-08 23:58:41,936 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-08 23:58:41,936 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250308_235654/report/analysis_report.html
2025-03-08 23:58:41,938 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250308_235654
2025-03-08 23:58:41,959 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250308_235654
2025-03-08 23:58:41,959 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250308_235654/report/analysis_report.html
2025-03-09 00:00:14,712 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-09 00:00:14,715 - TrafficRL - INFO - Analyzing training metrics...
2025-03-09 00:00:16,894 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250309_000014/training_training
2025-03-09 00:00:16,895 - TrafficRL - INFO - Training analysis for training completed.
2025-03-09 00:00:16,895 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-09 00:00:16,895 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-09 00:00:16,895 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-09 00:00:16,895 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-09 00:00:16,897 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-09 00:00:22,253 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-09 00:00:22,254 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-09 00:00:22,254 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-09 00:00:22,254 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-09 00:00:22,254 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:00:27,110 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-09 00:00:27,110 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-09 00:00:27,110 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-09 00:00:27,110 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-09 00:00:27,110 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:00:31,880 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-09 00:00:31,880 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-09 00:00:31,880 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-09 00:00:31,880 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-09 00:00:31,880 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:00:36,655 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-09 00:00:36,656 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-09 00:00:36,656 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-09 00:00:36,656 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-09 00:00:36,656 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-09 00:00:41,238 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-09 00:00:41,238 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-09 00:00:41,238 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-09 00:00:41,239 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-09 00:00:41,239 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-09 00:00:45,988 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-09 00:00:45,988 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-09 00:00:45,988 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-09 00:00:45,988 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-09 00:00:45,989 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-09 00:00:50,861 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-09 00:00:50,861 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-09 00:00:50,861 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-09 00:00:50,861 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-09 00:00:50,861 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-09 00:00:55,528 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-09 00:00:55,529 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-09 00:00:55,529 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-09 00:00:55,529 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-09 00:00:55,529 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-09 00:01:00,469 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-09 00:01:00,470 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-09 00:01:00,470 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-09 00:01:00,470 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-09 00:01:00,470 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-09 00:01:00,471 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:01:00,471 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:01:02,718 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:01:02,751 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:01:13,587 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-09 00:01:13,591 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-09 00:01:13,591 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-09 00:01:13,591 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-09 00:01:13,591 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-09 00:01:13,594 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:01:13,594 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:01:13,602 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:01:13,617 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:01:24,923 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-09 00:01:24,923 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-09 00:01:24,924 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-09 00:01:24,924 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-09 00:01:24,924 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-09 00:01:24,926 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:01:24,926 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:01:24,934 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:01:24,949 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:01:36,361 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-09 00:01:36,361 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-09 00:01:36,362 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-09 00:01:36,362 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-09 00:01:36,362 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-09 00:01:36,380 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250309_000014/benchmark/benchmark_20250309_000016/benchmark_results.json
2025-03-09 00:01:50,451 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250309_000014/benchmark/benchmark_20250309_000016/plots
2025-03-09 00:01:50,460 - TrafficRL - INFO - Benchmark completed.
2025-03-09 00:01:50,461 - TrafficRL - INFO - Processing benchmark results...
2025-03-09 00:01:50,461 - TrafficRL - INFO - Running comparative analysis...
2025-03-09 00:01:53,264 - TrafficRL.Utils.Analysis - INFO - Comparative analysis completed and saved to results/analysis/analysis_20250309_000014/comparative
2025-03-09 00:01:53,264 - TrafficRL - INFO - Comparative analysis completed.
2025-03-09 00:01:53,264 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-09 00:01:53,265 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:01:53,265 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:01:53,274 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:01:53,291 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:01:53,292 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-09 00:02:01,652 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-09 00:02:01,693 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-09 00:02:02,708 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250309_000014/agent_training/q_values
2025-03-09 00:02:02,713 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250309_000014/agent_training/q_values
2025-03-09 00:02:02,714 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-09 00:02:02,714 - TrafficRL - INFO - Generating comprehensive report...
2025-03-09 00:02:02,717 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-09 00:02:02,718 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: reward_comparison.png
2025-03-09 00:02:02,719 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: waiting_time_comparison.png
2025-03-09 00:02:02,719 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: throughput_comparison.png
2025-03-09 00:02:02,720 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-09 00:02:02,720 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-09 00:02:02,720 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-09 00:02:02,720 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: traffic_pattern_impact.png
2025-03-09 00:02:02,720 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: density_waiting_correlation.png
2025-03-09 00:02:02,721 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution_by_pattern.png
2025-03-09 00:02:02,721 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: agent_performance_radar.png
2025-03-09 00:02:02,721 - TrafficRL.Utils.Analysis - INFO - Found and included 0 benchmark plots in the report
2025-03-09 00:02:02,723 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250309_000014/report/analysis_report.html
2025-03-09 00:02:02,725 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250309_000014
2025-03-09 00:02:02,738 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250309_000014
2025-03-09 00:02:02,738 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250309_000014/report/analysis_report.html
2025-03-09 00:05:19,671 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-09 00:05:19,674 - TrafficRL - INFO - Analyzing training metrics...
2025-03-09 00:05:21,435 - TrafficRL.Utils.Analysis - INFO - Training analysis completed and saved to results/analysis/analysis_20250309_000519/training_training
2025-03-09 00:05:21,435 - TrafficRL - INFO - Training analysis for training completed.
2025-03-09 00:05:21,435 - TrafficRL - INFO - Running new benchmark across models and baselines...
2025-03-09 00:05:21,435 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-09 00:05:21,435 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-09 00:05:21,436 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-09 00:05:21,436 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-09 00:05:26,685 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-09 00:05:26,686 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-09 00:05:26,686 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-09 00:05:26,686 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-09 00:05:26,687 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:05:31,564 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-09 00:05:31,564 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-09 00:05:31,564 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-09 00:05:31,564 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-09 00:05:31,565 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:05:36,455 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-09 00:05:36,455 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-09 00:05:36,455 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-09 00:05:36,455 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-09 00:05:36,455 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-09 00:05:41,296 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-09 00:05:41,296 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-09 00:05:41,296 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-09 00:05:41,296 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-09 00:05:41,296 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-09 00:05:46,001 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-09 00:05:46,001 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-09 00:05:46,001 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-09 00:05:46,001 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-09 00:05:46,002 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-09 00:05:50,771 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-09 00:05:50,772 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-09 00:05:50,772 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-09 00:05:50,772 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-09 00:05:50,772 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-09 00:05:55,671 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-09 00:05:55,671 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-09 00:05:55,671 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-09 00:05:55,671 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-09 00:05:55,672 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-09 00:06:00,388 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-09 00:06:00,388 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-09 00:06:00,388 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-09 00:06:00,388 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-09 00:06:00,389 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-09 00:06:05,455 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-09 00:06:05,456 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-09 00:06:05,456 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-09 00:06:05,456 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-09 00:06:05,456 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-09 00:06:05,457 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:06:05,457 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:06:07,671 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:06:07,703 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:06:18,191 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on uniform:
2025-03-09 00:06:18,191 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 77274.61 ± 16505.91
2025-03-09 00:06:18,191 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 220.87
2025-03-09 00:06:18,191 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8796134.82
2025-03-09 00:06:18,191 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.0%, EW=97.0%
2025-03-09 00:06:18,194 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:06:18,194 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:06:18,203 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:06:18,217 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:06:29,056 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on rush_hour:
2025-03-09 00:06:29,056 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 289406.64 ± 34200.18
2025-03-09 00:06:29,057 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 232.06
2025-03-09 00:06:29,057 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 13283531.94
2025-03-09 00:06:29,057 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=2.0%, EW=98.0%
2025-03-09 00:06:29,059 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:06:29,059 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:06:29,066 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:06:29,081 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:06:40,221 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for TrainedModel on weekend:
2025-03-09 00:06:40,221 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 143313.87 ± 34100.28
2025-03-09 00:06:40,221 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 212.56
2025-03-09 00:06:40,221 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9845543.02
2025-03-09 00:06:40,222 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=3.6%, EW=96.4%
2025-03-09 00:06:40,234 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250309_000519/benchmark/benchmark_20250309_000521/benchmark_results.json
2025-03-09 00:06:54,223 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250309_000519/benchmark/benchmark_20250309_000521/plots
2025-03-09 00:06:54,232 - TrafficRL - INFO - Benchmark completed.
2025-03-09 00:06:54,233 - TrafficRL - INFO - Processing benchmark results...
2025-03-09 00:06:54,233 - TrafficRL - INFO - Running comparative analysis...
2025-03-09 00:06:57,068 - TrafficRL.Utils.Analysis - INFO - Comparative analysis completed and saved to results/analysis/analysis_20250309_000519/comparative
2025-03-09 00:06:57,069 - TrafficRL - INFO - Comparative analysis completed.
2025-03-09 00:06:57,069 - TrafficRL - INFO - Analyzing agent behavior...
2025-03-09 00:06:57,069 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-09 00:06:57,070 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-09 00:06:57,077 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-09 00:06:57,102 - TrafficRL.Agent - INFO - Model loaded successfully from results/training/best_model.pth
2025-03-09 00:06:57,102 - TrafficRL - INFO - Successfully loaded model from results/training/best_model.pth for Q-value analysis
2025-03-09 00:07:05,545 - TrafficRL.Utils.Analysis - INFO - Reshaped states from (2, 10, 10, 80) to (2, 8000) for PCA
2025-03-09 00:07:05,587 - TrafficRL.Utils.Analysis - WARNING - t-SNE visualization failed: perplexity must be less than n_samples
2025-03-09 00:07:06,548 - TrafficRL.Utils.Analysis - INFO - Learning progress visualizations saved to results/analysis/analysis_20250309_000519/agent_training/q_values
2025-03-09 00:07:06,553 - TrafficRL - INFO - Q-value visualization saved to results/analysis/analysis_20250309_000519/agent_training/q_values
2025-03-09 00:07:06,553 - TrafficRL - INFO - Agent analysis for training completed.
2025-03-09 00:07:06,554 - TrafficRL - INFO - Generating comprehensive report...
2025-03-09 00:07:06,557 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-09 00:07:06,562 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-09 00:07:06,562 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-09 00:07:06,562 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-09 00:07:06,568 - TrafficRL.Utils.Analysis - INFO - Found and included 7 benchmark plots in the report
2025-03-09 00:07:06,568 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250309_000519/report/analysis_report.html
2025-03-09 00:07:06,571 - TrafficRL - INFO - Comprehensive analysis completed. Results in results/analysis/analysis_20250309_000519
2025-03-09 00:07:06,582 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250309_000519
2025-03-09 00:07:06,583 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250309_000519/report/analysis_report.html
2025-03-17 16:50:55,621 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 16:50:55,622 - TrafficRL - INFO - Random seed set to 42
2025-03-17 16:50:55,623 - TrafficRL.Config - INFO - Configuration saved to results/ppo_training/training_config.json
2025-03-17 16:50:55,623 - TrafficRL - INFO - Starting training with ppo agent...
2025-03-17 16:50:55,623 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 16:50:56,297 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2
2025-03-17 16:50:56,553 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 995.03, Avg Reward: 995.03, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:56,797 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 989.81, Avg Reward: 992.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:57,040 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.73, Avg Reward: 993.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:57,281 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 995.26, Avg Reward: 993.96, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:57,527 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 995.17, Avg Reward: 994.20, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:57,767 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 989.53, Avg Reward: 993.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:58,006 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 994.23, Avg Reward: 993.54, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:58,247 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 994.62, Avg Reward: 993.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:58,489 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 992.28, Avg Reward: 993.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:58,754 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 994.64, Avg Reward: 993.63, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:58,992 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 993.00, Avg Reward: 993.57, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:59,231 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 985.80, Avg Reward: 992.93, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:59,471 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 991.06, Avg Reward: 992.78, LR: 0.000300, Traffic: uniform
2025-03-17 16:50:59,767 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 992.21, Avg Reward: 992.74, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:00,006 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 993.18, Avg Reward: 992.77, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:00,243 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 990.35, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:00,485 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 993.21, Avg Reward: 992.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:00,725 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 982.51, Avg Reward: 992.09, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:00,962 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 992.62, Avg Reward: 992.12, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:01,201 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 994.60, Avg Reward: 992.24, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:01,201 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-17 16:51:02,039 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 156048.67
2025-03-17 16:51:02,041 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/best_model.pth
2025-03-17 16:51:02,041 - TrafficRL.Train - INFO - New best model saved with reward: 156048.67
2025-03-17 16:51:02,279 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 994.15, Avg Reward: 992.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:02,523 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 994.38, Avg Reward: 992.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:02,761 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 994.67, Avg Reward: 992.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:03,001 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 993.63, Avg Reward: 992.57, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:03,244 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 995.95, Avg Reward: 992.70, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:03,246 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_25.pth
2025-03-17 16:51:03,246 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-17 16:51:03,485 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 992.28, Avg Reward: 992.69, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:03,726 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 993.43, Avg Reward: 992.72, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:03,965 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 992.35, Avg Reward: 992.70, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:04,202 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 994.72, Avg Reward: 992.77, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:04,440 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 996.59, Avg Reward: 992.90, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:04,680 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 994.84, Avg Reward: 992.96, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:04,918 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 991.15, Avg Reward: 992.90, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:05,156 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 992.05, Avg Reward: 992.88, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:05,396 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 995.14, Avg Reward: 992.95, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:05,637 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 985.54, Avg Reward: 992.73, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:05,877 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 989.44, Avg Reward: 992.64, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:06,125 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 978.37, Avg Reward: 992.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:06,373 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 993.48, Avg Reward: 992.29, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:06,619 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 995.90, Avg Reward: 992.38, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:06,861 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 994.53, Avg Reward: 992.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:06,861 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-17 16:51:07,700 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 151725.31
2025-03-17 16:51:07,700 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 16:51:07,957 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 992.78, Avg Reward: 992.44, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:08,211 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 994.60, Avg Reward: 992.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:08,462 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 995.21, Avg Reward: 992.56, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:08,720 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 986.87, Avg Reward: 992.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:08,972 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 989.05, Avg Reward: 992.35, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:09,215 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 988.89, Avg Reward: 992.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:09,452 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 992.48, Avg Reward: 992.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:09,690 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 994.38, Avg Reward: 992.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:09,940 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 977.85, Avg Reward: 992.03, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:10,190 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 994.66, Avg Reward: 992.08, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:10,192 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_50.pth
2025-03-17 16:51:10,192 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-17 16:51:10,445 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 990.30, Avg Reward: 992.05, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:10,691 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 993.16, Avg Reward: 992.07, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:10,943 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 992.79, Avg Reward: 992.08, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:11,187 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 995.05, Avg Reward: 992.14, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:11,426 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 995.29, Avg Reward: 992.20, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:11,664 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 985.02, Avg Reward: 992.07, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:11,905 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 995.17, Avg Reward: 992.12, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:12,148 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 995.72, Avg Reward: 992.18, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:12,402 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 995.29, Avg Reward: 992.24, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:12,643 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 988.97, Avg Reward: 992.18, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:12,644 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-17 16:51:13,495 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 136674.71
2025-03-17 16:51:13,495 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 16:51:13,735 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 995.73, Avg Reward: 992.24, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:14,040 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.87, Avg Reward: 992.27, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:14,287 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 995.70, Avg Reward: 992.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:14,554 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 994.74, Avg Reward: 992.36, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:14,795 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 995.84, Avg Reward: 992.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:15,036 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 994.75, Avg Reward: 992.45, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:15,278 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 994.94, Avg Reward: 992.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:15,516 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 992.95, Avg Reward: 992.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:15,764 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 995.50, Avg Reward: 992.54, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:16,006 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 995.66, Avg Reward: 992.58, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:16,246 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 993.61, Avg Reward: 992.59, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:16,485 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 996.84, Avg Reward: 992.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:16,723 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 995.74, Avg Reward: 992.70, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:16,963 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 993.47, Avg Reward: 992.71, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:17,202 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 992.40, Avg Reward: 992.70, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:17,203 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_75.pth
2025-03-17 16:51:17,203 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-17 16:51:17,447 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 994.60, Avg Reward: 992.73, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:17,686 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 992.77, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:17,927 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 994.66, Avg Reward: 992.80, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:18,166 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 976.75, Avg Reward: 992.59, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:18,411 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 994.43, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:18,411 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-17 16:51:19,247 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147361.70
2025-03-17 16:51:19,248 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 16:51:19,488 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 983.89, Avg Reward: 992.51, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:19,727 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 996.09, Avg Reward: 992.55, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:19,964 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 991.84, Avg Reward: 992.54, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:20,203 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 995.39, Avg Reward: 992.58, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:20,441 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 994.84, Avg Reward: 992.60, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:20,678 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 996.43, Avg Reward: 992.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:20,914 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 991.66, Avg Reward: 992.64, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:21,158 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 989.13, Avg Reward: 992.60, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:21,401 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 996.73, Avg Reward: 992.64, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:21,647 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 972.07, Avg Reward: 992.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:21,891 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 992.32, Avg Reward: 992.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:22,136 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 992.62, Avg Reward: 992.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:22,380 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 993.65, Avg Reward: 992.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:22,621 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 994.88, Avg Reward: 992.46, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:22,866 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 994.60, Avg Reward: 992.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:23,108 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 993.44, Avg Reward: 992.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:23,352 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 991.38, Avg Reward: 992.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:23,600 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 993.53, Avg Reward: 992.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:23,844 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 995.35, Avg Reward: 992.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:51:23,844 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-17 16:51:24,077 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 991.60, Avg Reward: 992.51, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:24,077 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-17 16:51:24,925 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 235972.65
2025-03-17 16:51:24,926 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/best_model.pth
2025-03-17 16:51:24,926 - TrafficRL.Train - INFO - New best model saved with reward: 235972.65
2025-03-17 16:51:24,926 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_100.pth
2025-03-17 16:51:24,927 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-17 16:51:25,171 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 993.27, Avg Reward: 992.49, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:25,407 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 992.37, Avg Reward: 992.51, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:25,644 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 988.12, Avg Reward: 992.44, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:25,884 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 994.23, Avg Reward: 992.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:26,129 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 995.50, Avg Reward: 992.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:26,365 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 993.02, Avg Reward: 992.47, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:26,605 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 990.63, Avg Reward: 992.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:26,856 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 993.48, Avg Reward: 992.42, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:27,103 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 993.29, Avg Reward: 992.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:27,356 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 994.59, Avg Reward: 992.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:27,610 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 995.12, Avg Reward: 992.45, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:27,850 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 995.97, Avg Reward: 992.55, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:28,090 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 993.82, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:28,326 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 992.43, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:28,561 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 995.21, Avg Reward: 992.60, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:28,796 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 983.47, Avg Reward: 992.53, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:29,029 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 992.19, Avg Reward: 992.52, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:29,261 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 995.76, Avg Reward: 992.66, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:29,495 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 994.42, Avg Reward: 992.67, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:29,731 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 995.55, Avg Reward: 992.68, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:29,731 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-17 16:51:30,560 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 283912.64
2025-03-17 16:51:30,561 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/best_model.pth
2025-03-17 16:51:30,561 - TrafficRL.Train - INFO - New best model saved with reward: 283912.64
2025-03-17 16:51:30,795 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 987.41, Avg Reward: 992.62, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:31,028 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 991.23, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:31,342 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 993.88, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:31,573 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 992.08, Avg Reward: 992.56, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:31,811 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 995.38, Avg Reward: 992.56, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:31,813 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_125.pth
2025-03-17 16:51:31,813 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-17 16:51:32,048 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 994.90, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:32,285 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 993.99, Avg Reward: 992.59, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:32,519 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 990.65, Avg Reward: 992.57, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:32,753 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 996.12, Avg Reward: 992.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:32,986 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 988.17, Avg Reward: 992.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:33,218 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 994.82, Avg Reward: 992.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:33,458 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 987.49, Avg Reward: 992.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:33,692 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 994.67, Avg Reward: 992.49, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:33,925 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 995.41, Avg Reward: 992.49, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:34,159 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 993.49, Avg Reward: 992.57, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:34,394 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 993.06, Avg Reward: 992.61, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:34,630 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 992.95, Avg Reward: 992.75, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:34,863 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 994.68, Avg Reward: 992.77, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:35,096 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 992.83, Avg Reward: 992.73, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:35,331 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 994.57, Avg Reward: 992.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:35,331 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-17 16:51:36,159 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 313342.76
2025-03-17 16:51:36,159 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/best_model.pth
2025-03-17 16:51:36,159 - TrafficRL.Train - INFO - New best model saved with reward: 313342.76
2025-03-17 16:51:36,395 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 993.06, Avg Reward: 992.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:36,629 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 995.30, Avg Reward: 992.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:36,870 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 994.74, Avg Reward: 992.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:37,106 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 995.57, Avg Reward: 992.83, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:37,367 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 992.28, Avg Reward: 992.86, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:37,600 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 993.10, Avg Reward: 992.90, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:37,836 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 992.75, Avg Reward: 992.90, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:38,069 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 993.98, Avg Reward: 992.90, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:38,301 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 993.42, Avg Reward: 993.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:38,538 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 995.72, Avg Reward: 993.07, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:38,539 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_150.pth
2025-03-17 16:51:38,539 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-17 16:51:38,773 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 987.57, Avg Reward: 993.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:39,007 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.22, Avg Reward: 993.05, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:39,240 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 995.86, Avg Reward: 993.08, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:39,473 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 993.19, Avg Reward: 993.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:39,706 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 995.40, Avg Reward: 993.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:39,940 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 996.12, Avg Reward: 993.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:40,173 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 992.37, Avg Reward: 993.15, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:40,406 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 996.04, Avg Reward: 993.15, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:40,641 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 991.82, Avg Reward: 993.11, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:40,876 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 994.46, Avg Reward: 993.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:40,876 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-17 16:51:41,699 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 286726.79
2025-03-17 16:51:41,699 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 16:51:41,937 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 992.70, Avg Reward: 993.14, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:42,173 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 994.96, Avg Reward: 993.15, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:42,410 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 994.45, Avg Reward: 993.14, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:42,644 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 994.29, Avg Reward: 993.13, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:42,877 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 985.60, Avg Reward: 993.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:43,110 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 995.48, Avg Reward: 993.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:43,345 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 995.77, Avg Reward: 993.05, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:43,578 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 995.57, Avg Reward: 993.07, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:43,810 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 992.36, Avg Reward: 993.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:44,043 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 993.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:44,277 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 995.60, Avg Reward: 993.05, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:44,510 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 995.27, Avg Reward: 993.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:44,742 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.75, Avg Reward: 993.02, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:44,976 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 993.77, Avg Reward: 993.02, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:45,209 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 991.59, Avg Reward: 993.01, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:45,211 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_175.pth
2025-03-17 16:51:45,211 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-17 16:51:45,445 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 995.99, Avg Reward: 993.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:45,679 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 996.36, Avg Reward: 993.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:45,913 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 996.30, Avg Reward: 993.05, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:46,145 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 994.46, Avg Reward: 993.22, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:46,378 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 994.63, Avg Reward: 993.22, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:46,378 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-17 16:51:47,211 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 310523.29
2025-03-17 16:51:47,211 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 16:51:47,445 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 996.53, Avg Reward: 993.35, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:47,683 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 990.59, Avg Reward: 993.30, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:47,920 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 989.61, Avg Reward: 993.27, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:48,155 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 994.10, Avg Reward: 993.26, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:48,390 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 994.41, Avg Reward: 993.26, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:48,622 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 996.26, Avg Reward: 993.25, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:48,855 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 995.51, Avg Reward: 993.29, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:49,091 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 993.22, Avg Reward: 993.33, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:49,325 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 994.14, Avg Reward: 993.31, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:49,557 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 994.80, Avg Reward: 993.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:49,789 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 986.65, Avg Reward: 993.48, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:50,024 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 992.23, Avg Reward: 993.47, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:50,258 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 994.77, Avg Reward: 993.49, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:50,489 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 992.00, Avg Reward: 993.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:50,720 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 995.08, Avg Reward: 993.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:50,954 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 994.27, Avg Reward: 993.47, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:51,188 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 993.62, Avg Reward: 993.49, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:51,420 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 990.51, Avg Reward: 993.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:51,653 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 993.62, Avg Reward: 993.45, LR: 0.000300, Traffic: rush_hour
2025-03-17 16:51:51,654 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-17 16:51:51,995 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 993.23, Avg Reward: 993.46, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:51,995 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-17 16:51:52,844 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 233532.58
2025-03-17 16:51:52,844 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 16:51:52,845 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_200.pth
2025-03-17 16:51:52,845 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-17 16:51:53,084 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 991.19, Avg Reward: 993.44, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:53,323 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 994.66, Avg Reward: 993.46, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:53,560 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 990.81, Avg Reward: 993.49, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:53,800 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 992.55, Avg Reward: 993.47, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:54,042 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 992.85, Avg Reward: 993.45, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:54,281 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 989.47, Avg Reward: 993.41, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:54,520 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 992.19, Avg Reward: 993.43, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:54,757 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 994.67, Avg Reward: 993.44, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:54,996 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 993.54, Avg Reward: 993.44, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:55,233 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 993.57, Avg Reward: 993.43, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:55,473 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 994.33, Avg Reward: 993.42, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:55,712 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 989.67, Avg Reward: 993.36, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:55,952 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 992.07, Avg Reward: 993.34, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:56,190 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 989.71, Avg Reward: 993.32, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:56,428 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 995.33, Avg Reward: 993.32, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:56,666 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 991.65, Avg Reward: 993.40, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:56,904 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 991.98, Avg Reward: 993.40, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:57,144 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 994.50, Avg Reward: 993.38, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:57,381 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 993.92, Avg Reward: 993.38, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:57,621 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 991.49, Avg Reward: 993.34, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:57,621 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-17 16:51:58,468 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 217061.13
2025-03-17 16:51:58,468 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 16:51:58,707 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 994.16, Avg Reward: 993.41, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:58,947 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 993.83, Avg Reward: 993.43, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:59,182 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 991.52, Avg Reward: 993.41, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:59,422 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 989.84, Avg Reward: 993.39, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:59,660 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 981.57, Avg Reward: 993.25, LR: 0.000300, Traffic: weekend
2025-03-17 16:51:59,661 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_225.pth
2025-03-17 16:51:59,661 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-17 16:51:59,902 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 989.78, Avg Reward: 993.20, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:00,141 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 989.79, Avg Reward: 993.15, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:00,379 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 993.40, Avg Reward: 993.18, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:00,615 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 992.91, Avg Reward: 993.15, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:00,857 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 992.53, Avg Reward: 993.19, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:01,094 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 991.17, Avg Reward: 993.16, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:01,332 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 994.30, Avg Reward: 993.23, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:01,568 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 994.38, Avg Reward: 993.22, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:01,805 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 989.40, Avg Reward: 993.16, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:02,047 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 989.92, Avg Reward: 993.13, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:02,284 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 993.70, Avg Reward: 993.13, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:02,522 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 965.32, Avg Reward: 992.86, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:02,759 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 995.01, Avg Reward: 992.86, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:02,995 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 994.20, Avg Reward: 992.87, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:03,233 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 995.05, Avg Reward: 992.88, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:03,233 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-17 16:52:04,081 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 264633.26
2025-03-17 16:52:04,081 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-17 16:52:04,350 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 994.18, Avg Reward: 992.89, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:04,587 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 970.71, Avg Reward: 992.64, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:04,825 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 992.61, Avg Reward: 992.62, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:05,062 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 993.93, Avg Reward: 992.61, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:05,299 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 992.99, Avg Reward: 992.61, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:05,536 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 989.88, Avg Reward: 992.58, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:05,770 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 995.20, Avg Reward: 992.61, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:06,010 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 990.95, Avg Reward: 992.58, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:06,247 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 994.01, Avg Reward: 992.58, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:06,484 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 960.33, Avg Reward: 992.23, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:06,486 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_250.pth
2025-03-17 16:52:06,486 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-17 16:52:06,723 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 992.30, Avg Reward: 992.27, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:06,963 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 994.91, Avg Reward: 992.28, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:07,202 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 992.30, Avg Reward: 992.25, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:07,440 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 992.30, Avg Reward: 992.24, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:07,681 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 992.72, Avg Reward: 992.21, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:07,922 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 988.73, Avg Reward: 992.14, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:08,162 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 988.73, Avg Reward: 992.10, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:08,401 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 995.06, Avg Reward: 992.09, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:08,641 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 993.54, Avg Reward: 992.11, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:08,883 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 989.22, Avg Reward: 992.05, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:08,883 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-17 16:52:09,738 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 240425.15
2025-03-17 16:52:09,738 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-17 16:52:09,978 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 994.31, Avg Reward: 992.07, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:10,225 - TrafficRL.Train - INFO - Episode 262/500 - Reward: 975.04, Avg Reward: 991.87, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:10,469 - TrafficRL.Train - INFO - Episode 263/500 - Reward: 993.03, Avg Reward: 991.86, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:10,711 - TrafficRL.Train - INFO - Episode 264/500 - Reward: 935.52, Avg Reward: 991.27, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:10,950 - TrafficRL.Train - INFO - Episode 265/500 - Reward: 992.01, Avg Reward: 991.33, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:11,188 - TrafficRL.Train - INFO - Episode 266/500 - Reward: 995.61, Avg Reward: 991.34, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:11,425 - TrafficRL.Train - INFO - Episode 267/500 - Reward: 992.00, Avg Reward: 991.30, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:11,663 - TrafficRL.Train - INFO - Episode 268/500 - Reward: 983.67, Avg Reward: 991.18, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:11,903 - TrafficRL.Train - INFO - Episode 269/500 - Reward: 991.33, Avg Reward: 991.17, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:12,144 - TrafficRL.Train - INFO - Episode 270/500 - Reward: 995.59, Avg Reward: 991.18, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:12,388 - TrafficRL.Train - INFO - Episode 271/500 - Reward: 994.42, Avg Reward: 991.16, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:12,637 - TrafficRL.Train - INFO - Episode 272/500 - Reward: 991.96, Avg Reward: 991.13, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:12,881 - TrafficRL.Train - INFO - Episode 273/500 - Reward: 954.98, Avg Reward: 990.74, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:13,120 - TrafficRL.Train - INFO - Episode 274/500 - Reward: 994.48, Avg Reward: 990.75, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:13,358 - TrafficRL.Train - INFO - Episode 275/500 - Reward: 994.45, Avg Reward: 990.78, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:13,359 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_275.pth
2025-03-17 16:52:13,359 - TrafficRL.Train - INFO - Model checkpoint saved at episode 275
2025-03-17 16:52:13,597 - TrafficRL.Train - INFO - Episode 276/500 - Reward: 985.10, Avg Reward: 990.67, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:13,836 - TrafficRL.Train - INFO - Episode 277/500 - Reward: 992.73, Avg Reward: 990.63, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:14,074 - TrafficRL.Train - INFO - Episode 278/500 - Reward: 991.89, Avg Reward: 990.59, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:14,312 - TrafficRL.Train - INFO - Episode 279/500 - Reward: 994.99, Avg Reward: 990.59, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:14,556 - TrafficRL.Train - INFO - Episode 280/500 - Reward: 989.70, Avg Reward: 990.55, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:14,556 - TrafficRL.Train - INFO - Evaluating agent at episode 280...
2025-03-17 16:52:15,408 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 219454.40
2025-03-17 16:52:15,408 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-17 16:52:15,646 - TrafficRL.Train - INFO - Episode 281/500 - Reward: 995.92, Avg Reward: 990.54, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:15,890 - TrafficRL.Train - INFO - Episode 282/500 - Reward: 988.05, Avg Reward: 990.51, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:16,150 - TrafficRL.Train - INFO - Episode 283/500 - Reward: 985.05, Avg Reward: 990.47, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:16,393 - TrafficRL.Train - INFO - Episode 284/500 - Reward: 994.44, Avg Reward: 990.47, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:16,636 - TrafficRL.Train - INFO - Episode 285/500 - Reward: 968.99, Avg Reward: 990.22, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:16,881 - TrafficRL.Train - INFO - Episode 286/500 - Reward: 994.27, Avg Reward: 990.20, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:17,132 - TrafficRL.Train - INFO - Episode 287/500 - Reward: 995.14, Avg Reward: 990.19, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:17,375 - TrafficRL.Train - INFO - Episode 288/500 - Reward: 994.41, Avg Reward: 990.21, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:17,614 - TrafficRL.Train - INFO - Episode 289/500 - Reward: 994.95, Avg Reward: 990.21, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:17,855 - TrafficRL.Train - INFO - Episode 290/500 - Reward: 991.77, Avg Reward: 990.18, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:18,092 - TrafficRL.Train - INFO - Episode 291/500 - Reward: 993.34, Avg Reward: 990.25, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:18,330 - TrafficRL.Train - INFO - Episode 292/500 - Reward: 994.96, Avg Reward: 990.28, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:18,596 - TrafficRL.Train - INFO - Episode 293/500 - Reward: 986.13, Avg Reward: 990.19, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:18,836 - TrafficRL.Train - INFO - Episode 294/500 - Reward: 996.71, Avg Reward: 990.24, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:19,075 - TrafficRL.Train - INFO - Episode 295/500 - Reward: 960.85, Avg Reward: 989.90, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:19,313 - TrafficRL.Train - INFO - Episode 296/500 - Reward: 989.83, Avg Reward: 989.85, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:19,676 - TrafficRL.Train - INFO - Episode 297/500 - Reward: 983.93, Avg Reward: 989.75, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:19,915 - TrafficRL.Train - INFO - Episode 298/500 - Reward: 994.54, Avg Reward: 989.79, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:20,153 - TrafficRL.Train - INFO - Episode 299/500 - Reward: 993.87, Avg Reward: 989.80, LR: 0.000300, Traffic: weekend
2025-03-17 16:52:20,153 - TrafficRL.Train - INFO - Switching to uniform traffic pattern at episode 300
2025-03-17 16:52:20,402 - TrafficRL.Train - INFO - Episode 300/500 - Reward: 995.46, Avg Reward: 989.82, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:20,402 - TrafficRL.Train - INFO - Evaluating agent at episode 300...
2025-03-17 16:52:21,258 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 136567.94
2025-03-17 16:52:21,258 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-17 16:52:21,259 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_300.pth
2025-03-17 16:52:21,259 - TrafficRL.Train - INFO - Model checkpoint saved at episode 300
2025-03-17 16:52:21,508 - TrafficRL.Train - INFO - Episode 301/500 - Reward: 984.09, Avg Reward: 989.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:21,753 - TrafficRL.Train - INFO - Episode 302/500 - Reward: 994.28, Avg Reward: 989.74, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:22,000 - TrafficRL.Train - INFO - Episode 303/500 - Reward: 996.09, Avg Reward: 989.80, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:22,239 - TrafficRL.Train - INFO - Episode 304/500 - Reward: 992.05, Avg Reward: 989.79, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:22,483 - TrafficRL.Train - INFO - Episode 305/500 - Reward: 984.89, Avg Reward: 989.71, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:22,726 - TrafficRL.Train - INFO - Episode 306/500 - Reward: 993.58, Avg Reward: 989.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:22,969 - TrafficRL.Train - INFO - Episode 307/500 - Reward: 992.59, Avg Reward: 989.76, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:23,210 - TrafficRL.Train - INFO - Episode 308/500 - Reward: 994.62, Avg Reward: 989.76, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:23,449 - TrafficRL.Train - INFO - Episode 309/500 - Reward: 985.33, Avg Reward: 989.68, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:23,687 - TrafficRL.Train - INFO - Episode 310/500 - Reward: 995.07, Avg Reward: 989.69, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:23,926 - TrafficRL.Train - INFO - Episode 311/500 - Reward: 991.92, Avg Reward: 989.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:24,166 - TrafficRL.Train - INFO - Episode 312/500 - Reward: 983.85, Avg Reward: 989.61, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:24,405 - TrafficRL.Train - INFO - Episode 313/500 - Reward: 993.86, Avg Reward: 989.63, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:24,643 - TrafficRL.Train - INFO - Episode 314/500 - Reward: 994.18, Avg Reward: 989.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:24,882 - TrafficRL.Train - INFO - Episode 315/500 - Reward: 994.59, Avg Reward: 989.66, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:25,120 - TrafficRL.Train - INFO - Episode 316/500 - Reward: 993.91, Avg Reward: 989.69, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:25,360 - TrafficRL.Train - INFO - Episode 317/500 - Reward: 988.56, Avg Reward: 989.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:25,598 - TrafficRL.Train - INFO - Episode 318/500 - Reward: 993.65, Avg Reward: 989.64, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:25,837 - TrafficRL.Train - INFO - Episode 319/500 - Reward: 994.34, Avg Reward: 989.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:26,077 - TrafficRL.Train - INFO - Episode 320/500 - Reward: 994.04, Avg Reward: 989.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:26,077 - TrafficRL.Train - INFO - Evaluating agent at episode 320...
2025-03-17 16:52:26,915 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 113740.27
2025-03-17 16:52:26,915 - TrafficRL.Train - INFO - No improvement for 9 evaluations
2025-03-17 16:52:27,163 - TrafficRL.Train - INFO - Episode 321/500 - Reward: 992.20, Avg Reward: 989.65, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:27,410 - TrafficRL.Train - INFO - Episode 322/500 - Reward: 992.26, Avg Reward: 989.64, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:27,649 - TrafficRL.Train - INFO - Episode 323/500 - Reward: 994.03, Avg Reward: 989.66, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:27,887 - TrafficRL.Train - INFO - Episode 324/500 - Reward: 990.12, Avg Reward: 989.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:28,127 - TrafficRL.Train - INFO - Episode 325/500 - Reward: 994.40, Avg Reward: 989.79, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:28,129 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_325.pth
2025-03-17 16:52:28,129 - TrafficRL.Train - INFO - Model checkpoint saved at episode 325
2025-03-17 16:52:28,369 - TrafficRL.Train - INFO - Episode 326/500 - Reward: 987.77, Avg Reward: 989.77, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:28,609 - TrafficRL.Train - INFO - Episode 327/500 - Reward: 996.17, Avg Reward: 989.84, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:28,849 - TrafficRL.Train - INFO - Episode 328/500 - Reward: 987.58, Avg Reward: 989.78, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:29,088 - TrafficRL.Train - INFO - Episode 329/500 - Reward: 994.07, Avg Reward: 989.79, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:29,331 - TrafficRL.Train - INFO - Episode 330/500 - Reward: 993.69, Avg Reward: 989.80, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:29,569 - TrafficRL.Train - INFO - Episode 331/500 - Reward: 994.66, Avg Reward: 989.84, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:29,808 - TrafficRL.Train - INFO - Episode 332/500 - Reward: 989.91, Avg Reward: 989.79, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:30,045 - TrafficRL.Train - INFO - Episode 333/500 - Reward: 986.61, Avg Reward: 989.72, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:30,283 - TrafficRL.Train - INFO - Episode 334/500 - Reward: 994.01, Avg Reward: 989.76, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:30,523 - TrafficRL.Train - INFO - Episode 335/500 - Reward: 987.49, Avg Reward: 989.74, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:30,761 - TrafficRL.Train - INFO - Episode 336/500 - Reward: 978.21, Avg Reward: 989.58, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:31,002 - TrafficRL.Train - INFO - Episode 337/500 - Reward: 996.15, Avg Reward: 989.89, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:31,246 - TrafficRL.Train - INFO - Episode 338/500 - Reward: 994.69, Avg Reward: 989.89, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:31,497 - TrafficRL.Train - INFO - Episode 339/500 - Reward: 993.25, Avg Reward: 989.88, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:31,741 - TrafficRL.Train - INFO - Episode 340/500 - Reward: 993.75, Avg Reward: 989.87, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:31,741 - TrafficRL.Train - INFO - Evaluating agent at episode 340...
2025-03-17 16:52:32,585 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 190441.73
2025-03-17 16:52:32,585 - TrafficRL.Train - INFO - No improvement for 10 evaluations
2025-03-17 16:52:32,824 - TrafficRL.Train - INFO - Episode 341/500 - Reward: 989.36, Avg Reward: 989.82, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:33,062 - TrafficRL.Train - INFO - Episode 342/500 - Reward: 994.07, Avg Reward: 990.05, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:33,300 - TrafficRL.Train - INFO - Episode 343/500 - Reward: 990.11, Avg Reward: 990.03, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:33,538 - TrafficRL.Train - INFO - Episode 344/500 - Reward: 994.30, Avg Reward: 990.03, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:33,776 - TrafficRL.Train - INFO - Episode 345/500 - Reward: 984.68, Avg Reward: 989.95, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,012 - TrafficRL.Train - INFO - Episode 346/500 - Reward: 994.05, Avg Reward: 989.99, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,250 - TrafficRL.Train - INFO - Episode 347/500 - Reward: 991.82, Avg Reward: 989.95, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,488 - TrafficRL.Train - INFO - Episode 348/500 - Reward: 987.66, Avg Reward: 989.92, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,725 - TrafficRL.Train - INFO - Episode 349/500 - Reward: 994.37, Avg Reward: 989.93, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,964 - TrafficRL.Train - INFO - Episode 350/500 - Reward: 987.13, Avg Reward: 990.19, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:34,965 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_350.pth
2025-03-17 16:52:34,966 - TrafficRL.Train - INFO - Model checkpoint saved at episode 350
2025-03-17 16:52:35,205 - TrafficRL.Train - INFO - Episode 351/500 - Reward: 995.76, Avg Reward: 990.23, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:35,450 - TrafficRL.Train - INFO - Episode 352/500 - Reward: 994.34, Avg Reward: 990.22, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:35,690 - TrafficRL.Train - INFO - Episode 353/500 - Reward: 993.90, Avg Reward: 990.24, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:35,932 - TrafficRL.Train - INFO - Episode 354/500 - Reward: 994.63, Avg Reward: 990.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:36,174 - TrafficRL.Train - INFO - Episode 355/500 - Reward: 994.81, Avg Reward: 990.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:36,418 - TrafficRL.Train - INFO - Episode 356/500 - Reward: 995.65, Avg Reward: 990.35, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:36,657 - TrafficRL.Train - INFO - Episode 357/500 - Reward: 994.66, Avg Reward: 990.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:36,897 - TrafficRL.Train - INFO - Episode 358/500 - Reward: 994.62, Avg Reward: 990.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:37,137 - TrafficRL.Train - INFO - Episode 359/500 - Reward: 989.58, Avg Reward: 990.37, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:37,392 - TrafficRL.Train - INFO - Episode 360/500 - Reward: 993.18, Avg Reward: 990.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:37,392 - TrafficRL.Train - INFO - Evaluating agent at episode 360...
2025-03-17 16:52:38,266 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 144073.06
2025-03-17 16:52:38,266 - TrafficRL.Train - INFO - No improvement for 11 evaluations
2025-03-17 16:52:38,509 - TrafficRL.Train - INFO - Episode 361/500 - Reward: 993.43, Avg Reward: 990.40, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:38,756 - TrafficRL.Train - INFO - Episode 362/500 - Reward: 994.74, Avg Reward: 990.59, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:38,998 - TrafficRL.Train - INFO - Episode 363/500 - Reward: 991.85, Avg Reward: 990.58, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:39,245 - TrafficRL.Train - INFO - Episode 364/500 - Reward: 995.25, Avg Reward: 991.18, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:39,488 - TrafficRL.Train - INFO - Episode 365/500 - Reward: 995.12, Avg Reward: 991.21, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:39,760 - TrafficRL.Train - INFO - Episode 366/500 - Reward: 972.78, Avg Reward: 990.98, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:40,002 - TrafficRL.Train - INFO - Episode 367/500 - Reward: 992.96, Avg Reward: 990.99, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:40,247 - TrafficRL.Train - INFO - Episode 368/500 - Reward: 993.48, Avg Reward: 991.09, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:40,494 - TrafficRL.Train - INFO - Episode 369/500 - Reward: 994.51, Avg Reward: 991.12, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:40,740 - TrafficRL.Train - INFO - Episode 370/500 - Reward: 994.39, Avg Reward: 991.11, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:40,983 - TrafficRL.Train - INFO - Episode 371/500 - Reward: 984.80, Avg Reward: 991.01, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:41,229 - TrafficRL.Train - INFO - Episode 372/500 - Reward: 993.67, Avg Reward: 991.03, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:41,471 - TrafficRL.Train - INFO - Episode 373/500 - Reward: 994.29, Avg Reward: 991.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:41,721 - TrafficRL.Train - INFO - Episode 374/500 - Reward: 993.21, Avg Reward: 991.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:41,961 - TrafficRL.Train - INFO - Episode 375/500 - Reward: 995.03, Avg Reward: 991.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:41,963 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_375.pth
2025-03-17 16:52:41,963 - TrafficRL.Train - INFO - Model checkpoint saved at episode 375
2025-03-17 16:52:42,207 - TrafficRL.Train - INFO - Episode 376/500 - Reward: 994.95, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:42,445 - TrafficRL.Train - INFO - Episode 377/500 - Reward: 993.67, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:42,690 - TrafficRL.Train - INFO - Episode 378/500 - Reward: 993.53, Avg Reward: 991.54, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:42,931 - TrafficRL.Train - INFO - Episode 379/500 - Reward: 992.07, Avg Reward: 991.51, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:43,173 - TrafficRL.Train - INFO - Episode 380/500 - Reward: 994.33, Avg Reward: 991.56, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:43,173 - TrafficRL.Train - INFO - Evaluating agent at episode 380...
2025-03-17 16:52:44,020 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 156550.09
2025-03-17 16:52:44,020 - TrafficRL.Train - INFO - No improvement for 12 evaluations
2025-03-17 16:52:44,267 - TrafficRL.Train - INFO - Episode 381/500 - Reward: 990.08, Avg Reward: 991.50, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:44,512 - TrafficRL.Train - INFO - Episode 382/500 - Reward: 993.80, Avg Reward: 991.56, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:44,756 - TrafficRL.Train - INFO - Episode 383/500 - Reward: 995.41, Avg Reward: 991.66, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:45,004 - TrafficRL.Train - INFO - Episode 384/500 - Reward: 991.67, Avg Reward: 991.63, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:45,247 - TrafficRL.Train - INFO - Episode 385/500 - Reward: 996.10, Avg Reward: 991.90, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:45,486 - TrafficRL.Train - INFO - Episode 386/500 - Reward: 980.84, Avg Reward: 991.77, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:45,725 - TrafficRL.Train - INFO - Episode 387/500 - Reward: 993.60, Avg Reward: 991.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:45,964 - TrafficRL.Train - INFO - Episode 388/500 - Reward: 993.97, Avg Reward: 991.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:46,208 - TrafficRL.Train - INFO - Episode 389/500 - Reward: 987.18, Avg Reward: 991.67, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:46,458 - TrafficRL.Train - INFO - Episode 390/500 - Reward: 995.23, Avg Reward: 991.71, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:46,696 - TrafficRL.Train - INFO - Episode 391/500 - Reward: 994.75, Avg Reward: 991.72, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:46,947 - TrafficRL.Train - INFO - Episode 392/500 - Reward: 996.11, Avg Reward: 991.73, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:47,196 - TrafficRL.Train - INFO - Episode 393/500 - Reward: 964.93, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:47,454 - TrafficRL.Train - INFO - Episode 394/500 - Reward: 991.93, Avg Reward: 991.47, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:47,706 - TrafficRL.Train - INFO - Episode 395/500 - Reward: 996.27, Avg Reward: 991.83, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:47,948 - TrafficRL.Train - INFO - Episode 396/500 - Reward: 993.65, Avg Reward: 991.87, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:48,187 - TrafficRL.Train - INFO - Episode 397/500 - Reward: 979.25, Avg Reward: 991.82, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:48,429 - TrafficRL.Train - INFO - Episode 398/500 - Reward: 995.10, Avg Reward: 991.82, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:48,667 - TrafficRL.Train - INFO - Episode 399/500 - Reward: 987.13, Avg Reward: 991.76, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:48,905 - TrafficRL.Train - INFO - Episode 400/500 - Reward: 994.67, Avg Reward: 991.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:48,908 - TrafficRL.Train - INFO - Evaluating agent at episode 400...
2025-03-17 16:52:49,747 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 126150.78
2025-03-17 16:52:49,747 - TrafficRL.Train - INFO - No improvement for 13 evaluations
2025-03-17 16:52:49,748 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_400.pth
2025-03-17 16:52:49,748 - TrafficRL.Train - INFO - Model checkpoint saved at episode 400
2025-03-17 16:52:49,987 - TrafficRL.Train - INFO - Episode 401/500 - Reward: 995.62, Avg Reward: 991.86, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:50,226 - TrafficRL.Train - INFO - Episode 402/500 - Reward: 995.13, Avg Reward: 991.87, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:50,468 - TrafficRL.Train - INFO - Episode 403/500 - Reward: 992.07, Avg Reward: 991.83, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:50,708 - TrafficRL.Train - INFO - Episode 404/500 - Reward: 995.35, Avg Reward: 991.87, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:50,957 - TrafficRL.Train - INFO - Episode 405/500 - Reward: 994.25, Avg Reward: 991.96, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:51,197 - TrafficRL.Train - INFO - Episode 406/500 - Reward: 994.26, Avg Reward: 991.97, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:51,434 - TrafficRL.Train - INFO - Episode 407/500 - Reward: 996.13, Avg Reward: 992.00, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:51,680 - TrafficRL.Train - INFO - Episode 408/500 - Reward: 972.13, Avg Reward: 991.78, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:51,928 - TrafficRL.Train - INFO - Episode 409/500 - Reward: 980.54, Avg Reward: 991.73, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:52,178 - TrafficRL.Train - INFO - Episode 410/500 - Reward: 993.24, Avg Reward: 991.71, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:52,422 - TrafficRL.Train - INFO - Episode 411/500 - Reward: 992.43, Avg Reward: 991.72, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:52,663 - TrafficRL.Train - INFO - Episode 412/500 - Reward: 994.07, Avg Reward: 991.82, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:52,905 - TrafficRL.Train - INFO - Episode 413/500 - Reward: 971.68, Avg Reward: 991.60, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:53,157 - TrafficRL.Train - INFO - Episode 414/500 - Reward: 990.10, Avg Reward: 991.55, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:53,399 - TrafficRL.Train - INFO - Episode 415/500 - Reward: 993.79, Avg Reward: 991.55, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:53,641 - TrafficRL.Train - INFO - Episode 416/500 - Reward: 980.13, Avg Reward: 991.41, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:53,882 - TrafficRL.Train - INFO - Episode 417/500 - Reward: 995.78, Avg Reward: 991.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:54,283 - TrafficRL.Train - INFO - Episode 418/500 - Reward: 993.59, Avg Reward: 991.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:54,522 - TrafficRL.Train - INFO - Episode 419/500 - Reward: 995.35, Avg Reward: 991.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:54,764 - TrafficRL.Train - INFO - Episode 420/500 - Reward: 995.58, Avg Reward: 991.51, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:54,765 - TrafficRL.Train - INFO - Evaluating agent at episode 420...
2025-03-17 16:52:55,606 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147325.85
2025-03-17 16:52:55,606 - TrafficRL.Train - INFO - No improvement for 14 evaluations
2025-03-17 16:52:55,861 - TrafficRL.Train - INFO - Episode 421/500 - Reward: 990.56, Avg Reward: 991.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:56,114 - TrafficRL.Train - INFO - Episode 422/500 - Reward: 989.27, Avg Reward: 991.46, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:56,363 - TrafficRL.Train - INFO - Episode 423/500 - Reward: 994.71, Avg Reward: 991.47, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:56,619 - TrafficRL.Train - INFO - Episode 424/500 - Reward: 996.21, Avg Reward: 991.53, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:56,879 - TrafficRL.Train - INFO - Episode 425/500 - Reward: 996.83, Avg Reward: 991.55, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:56,881 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_425.pth
2025-03-17 16:52:56,881 - TrafficRL.Train - INFO - Model checkpoint saved at episode 425
2025-03-17 16:52:57,140 - TrafficRL.Train - INFO - Episode 426/500 - Reward: 988.05, Avg Reward: 991.55, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:57,395 - TrafficRL.Train - INFO - Episode 427/500 - Reward: 993.07, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:57,636 - TrafficRL.Train - INFO - Episode 428/500 - Reward: 992.18, Avg Reward: 991.57, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:57,894 - TrafficRL.Train - INFO - Episode 429/500 - Reward: 986.56, Avg Reward: 991.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:58,169 - TrafficRL.Train - INFO - Episode 430/500 - Reward: 993.30, Avg Reward: 991.49, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:58,415 - TrafficRL.Train - INFO - Episode 431/500 - Reward: 992.51, Avg Reward: 991.47, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:58,654 - TrafficRL.Train - INFO - Episode 432/500 - Reward: 989.16, Avg Reward: 991.46, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:58,907 - TrafficRL.Train - INFO - Episode 433/500 - Reward: 993.16, Avg Reward: 991.53, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:59,163 - TrafficRL.Train - INFO - Episode 434/500 - Reward: 993.39, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:59,415 - TrafficRL.Train - INFO - Episode 435/500 - Reward: 991.98, Avg Reward: 991.57, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:59,662 - TrafficRL.Train - INFO - Episode 436/500 - Reward: 996.45, Avg Reward: 991.75, LR: 0.000300, Traffic: uniform
2025-03-17 16:52:59,915 - TrafficRL.Train - INFO - Episode 437/500 - Reward: 994.32, Avg Reward: 991.73, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:00,171 - TrafficRL.Train - INFO - Episode 438/500 - Reward: 980.43, Avg Reward: 991.59, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:00,409 - TrafficRL.Train - INFO - Episode 439/500 - Reward: 979.68, Avg Reward: 991.45, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:00,650 - TrafficRL.Train - INFO - Episode 440/500 - Reward: 993.90, Avg Reward: 991.45, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:00,650 - TrafficRL.Train - INFO - Evaluating agent at episode 440...
2025-03-17 16:53:01,514 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 151133.02
2025-03-17 16:53:01,514 - TrafficRL.Train - INFO - No improvement for 15 evaluations
2025-03-17 16:53:01,769 - TrafficRL.Train - INFO - Episode 441/500 - Reward: 992.27, Avg Reward: 991.48, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:02,016 - TrafficRL.Train - INFO - Episode 442/500 - Reward: 992.54, Avg Reward: 991.47, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:02,263 - TrafficRL.Train - INFO - Episode 443/500 - Reward: 995.26, Avg Reward: 991.52, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:02,504 - TrafficRL.Train - INFO - Episode 444/500 - Reward: 970.64, Avg Reward: 991.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:02,746 - TrafficRL.Train - INFO - Episode 445/500 - Reward: 988.67, Avg Reward: 991.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:02,984 - TrafficRL.Train - INFO - Episode 446/500 - Reward: 993.78, Avg Reward: 991.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:03,224 - TrafficRL.Train - INFO - Episode 447/500 - Reward: 993.90, Avg Reward: 991.34, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:03,473 - TrafficRL.Train - INFO - Episode 448/500 - Reward: 995.86, Avg Reward: 991.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:03,719 - TrafficRL.Train - INFO - Episode 449/500 - Reward: 994.93, Avg Reward: 991.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:03,982 - TrafficRL.Train - INFO - Episode 450/500 - Reward: 995.22, Avg Reward: 991.51, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:03,984 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_450.pth
2025-03-17 16:53:03,984 - TrafficRL.Train - INFO - Model checkpoint saved at episode 450
2025-03-17 16:53:04,234 - TrafficRL.Train - INFO - Episode 451/500 - Reward: 990.06, Avg Reward: 991.45, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:04,492 - TrafficRL.Train - INFO - Episode 452/500 - Reward: 992.97, Avg Reward: 991.44, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:04,747 - TrafficRL.Train - INFO - Episode 453/500 - Reward: 989.45, Avg Reward: 991.39, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:04,986 - TrafficRL.Train - INFO - Episode 454/500 - Reward: 991.27, Avg Reward: 991.36, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:05,232 - TrafficRL.Train - INFO - Episode 455/500 - Reward: 994.92, Avg Reward: 991.36, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:05,477 - TrafficRL.Train - INFO - Episode 456/500 - Reward: 992.99, Avg Reward: 991.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:05,716 - TrafficRL.Train - INFO - Episode 457/500 - Reward: 993.68, Avg Reward: 991.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:05,956 - TrafficRL.Train - INFO - Episode 458/500 - Reward: 994.81, Avg Reward: 991.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:06,195 - TrafficRL.Train - INFO - Episode 459/500 - Reward: 984.84, Avg Reward: 991.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:06,439 - TrafficRL.Train - INFO - Episode 460/500 - Reward: 996.10, Avg Reward: 991.31, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:06,439 - TrafficRL.Train - INFO - Evaluating agent at episode 460...
2025-03-17 16:53:07,296 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 111017.81
2025-03-17 16:53:07,296 - TrafficRL.Train - INFO - No improvement for 16 evaluations
2025-03-17 16:53:07,537 - TrafficRL.Train - INFO - Episode 461/500 - Reward: 990.24, Avg Reward: 991.28, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:07,780 - TrafficRL.Train - INFO - Episode 462/500 - Reward: 983.35, Avg Reward: 991.16, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:08,019 - TrafficRL.Train - INFO - Episode 463/500 - Reward: 992.37, Avg Reward: 991.17, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:08,257 - TrafficRL.Train - INFO - Episode 464/500 - Reward: 992.78, Avg Reward: 991.14, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:08,495 - TrafficRL.Train - INFO - Episode 465/500 - Reward: 993.89, Avg Reward: 991.13, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:08,737 - TrafficRL.Train - INFO - Episode 466/500 - Reward: 991.11, Avg Reward: 991.31, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:08,974 - TrafficRL.Train - INFO - Episode 467/500 - Reward: 994.62, Avg Reward: 991.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:09,214 - TrafficRL.Train - INFO - Episode 468/500 - Reward: 991.95, Avg Reward: 991.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:09,450 - TrafficRL.Train - INFO - Episode 469/500 - Reward: 976.67, Avg Reward: 991.14, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:09,707 - TrafficRL.Train - INFO - Episode 470/500 - Reward: 994.09, Avg Reward: 991.13, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:09,961 - TrafficRL.Train - INFO - Episode 471/500 - Reward: 993.86, Avg Reward: 991.22, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:10,205 - TrafficRL.Train - INFO - Episode 472/500 - Reward: 994.34, Avg Reward: 991.23, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:10,450 - TrafficRL.Train - INFO - Episode 473/500 - Reward: 996.68, Avg Reward: 991.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:10,692 - TrafficRL.Train - INFO - Episode 474/500 - Reward: 994.97, Avg Reward: 991.27, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:10,932 - TrafficRL.Train - INFO - Episode 475/500 - Reward: 994.03, Avg Reward: 991.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:10,933 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_475.pth
2025-03-17 16:53:10,933 - TrafficRL.Train - INFO - Model checkpoint saved at episode 475
2025-03-17 16:53:11,172 - TrafficRL.Train - INFO - Episode 476/500 - Reward: 990.52, Avg Reward: 991.22, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:11,410 - TrafficRL.Train - INFO - Episode 477/500 - Reward: 993.97, Avg Reward: 991.22, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:11,647 - TrafficRL.Train - INFO - Episode 478/500 - Reward: 996.43, Avg Reward: 991.25, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:11,886 - TrafficRL.Train - INFO - Episode 479/500 - Reward: 993.19, Avg Reward: 991.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:12,131 - TrafficRL.Train - INFO - Episode 480/500 - Reward: 994.49, Avg Reward: 991.26, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:12,132 - TrafficRL.Train - INFO - Evaluating agent at episode 480...
2025-03-17 16:53:12,988 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 114826.24
2025-03-17 16:53:12,988 - TrafficRL.Train - INFO - No improvement for 17 evaluations
2025-03-17 16:53:13,229 - TrafficRL.Train - INFO - Episode 481/500 - Reward: 994.99, Avg Reward: 991.31, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:13,474 - TrafficRL.Train - INFO - Episode 482/500 - Reward: 995.82, Avg Reward: 991.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:13,714 - TrafficRL.Train - INFO - Episode 483/500 - Reward: 995.35, Avg Reward: 991.33, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:13,968 - TrafficRL.Train - INFO - Episode 484/500 - Reward: 992.67, Avg Reward: 991.34, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:14,228 - TrafficRL.Train - INFO - Episode 485/500 - Reward: 993.49, Avg Reward: 991.32, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:14,477 - TrafficRL.Train - INFO - Episode 486/500 - Reward: 993.90, Avg Reward: 991.45, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:14,733 - TrafficRL.Train - INFO - Episode 487/500 - Reward: 991.31, Avg Reward: 991.42, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:14,982 - TrafficRL.Train - INFO - Episode 488/500 - Reward: 988.80, Avg Reward: 991.37, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:15,227 - TrafficRL.Train - INFO - Episode 489/500 - Reward: 994.13, Avg Reward: 991.44, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:15,469 - TrafficRL.Train - INFO - Episode 490/500 - Reward: 995.17, Avg Reward: 991.44, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:15,708 - TrafficRL.Train - INFO - Episode 491/500 - Reward: 993.34, Avg Reward: 991.43, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:15,949 - TrafficRL.Train - INFO - Episode 492/500 - Reward: 992.99, Avg Reward: 991.40, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:16,188 - TrafficRL.Train - INFO - Episode 493/500 - Reward: 994.14, Avg Reward: 991.69, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:16,426 - TrafficRL.Train - INFO - Episode 494/500 - Reward: 994.44, Avg Reward: 991.71, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:16,663 - TrafficRL.Train - INFO - Episode 495/500 - Reward: 995.00, Avg Reward: 991.70, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:16,905 - TrafficRL.Train - INFO - Episode 496/500 - Reward: 991.58, Avg Reward: 991.68, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:17,146 - TrafficRL.Train - INFO - Episode 497/500 - Reward: 994.93, Avg Reward: 991.84, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:17,386 - TrafficRL.Train - INFO - Episode 498/500 - Reward: 992.36, Avg Reward: 991.81, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:17,629 - TrafficRL.Train - INFO - Episode 499/500 - Reward: 994.63, Avg Reward: 991.88, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:17,868 - TrafficRL.Train - INFO - Episode 500/500 - Reward: 992.56, Avg Reward: 991.86, LR: 0.000300, Traffic: uniform
2025-03-17 16:53:17,868 - TrafficRL.Train - INFO - Evaluating agent at episode 500...
2025-03-17 16:53:18,724 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 155188.07
2025-03-17 16:53:18,724 - TrafficRL.Train - INFO - No improvement for 18 evaluations
2025-03-17 16:53:18,730 - TrafficRL.Agents.PPO - INFO - Model saved to results/ppo_training/model_episode_500.pth
2025-03-17 16:53:18,730 - TrafficRL.Train - INFO - Model checkpoint saved at episode 500
2025-03-17 16:53:19,403 - TrafficRL - INFO - Training complete, visualizing results...
2025-03-17 16:53:19,614 - TrafficRL - INFO - Training visualization saved to results/ppo_training/training_progress.png
2025-03-17 16:53:19,616 - TrafficRL - INFO - Training metrics saved to results/ppo_training/training_metrics.json
2025-03-17 16:53:19,616 - TrafficRL - INFO - Training Summary:
2025-03-17 16:53:19,616 - TrafficRL - INFO -   Agent Type: ppo
2025-03-17 16:53:19,616 - TrafficRL - INFO -   Episodes Completed: 500
2025-03-17 16:53:19,616 - TrafficRL - INFO -   Final Average Reward: 991.8629229366038
2025-03-17 16:53:19,616 - TrafficRL - INFO -   Best Model Path: results/ppo_training/best_model.pth
2025-03-17 16:54:32,721 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 16:54:32,722 - TrafficRL - INFO - Random seed set to 42
2025-03-17 16:54:32,722 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 16:54:32,722 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 16:54:32,722 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 16:54:32,722 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 16:54:34,944 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 16:54:34,945 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 16:54:34,945 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 16:54:34,945 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 16:54:34,945 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:54:37,043 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 16:54:37,043 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 16:54:37,043 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 16:54:37,043 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 16:54:37,043 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:54:39,237 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 16:54:39,237 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 16:54:39,237 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 16:54:39,237 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 16:54:39,237 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:54:41,444 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 16:54:41,445 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 16:54:41,445 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 16:54:41,445 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 16:54:41,445 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 16:54:43,649 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 16:54:43,649 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 16:54:43,649 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 16:54:43,649 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 16:54:43,649 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 16:54:45,847 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 16:54:45,847 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 16:54:45,847 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 16:54:45,847 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 16:54:45,847 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 16:54:48,084 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 16:54:48,084 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 16:54:48,084 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 16:54:48,084 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 16:54:48,084 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 16:54:50,233 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 16:54:50,234 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 16:54:50,234 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 16:54:50,234 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 16:54:50,234 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 16:54:52,450 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 16:54:52,450 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 16:54:52,450 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 16:54:52,450 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 16:54:52,450 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 16:54:52,501 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark_comparison/benchmark_20250317_165432/benchmark_results.json
2025-03-17 16:54:55,602 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark_comparison/benchmark_20250317_165432/plots
2025-03-17 16:54:55,602 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 16:54:55,602 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 16:54:55,602 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 16:54:55,602 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 16:54:55,602 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 16:54:55,602 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 16:54:55,603 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 16:54:55,603 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 16:54:55,603 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 16:54:55,603 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 16:55:28,126 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 16:55:28,127 - TrafficRL - INFO - Random seed set to 42
2025-03-17 16:55:28,127 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 16:55:28,127 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 16:55:28,127 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 16:55:28,127 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 16:55:30,744 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 16:55:30,745 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 16:55:30,745 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 16:55:30,745 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 16:55:30,745 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:55:33,196 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 16:55:33,196 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 16:55:33,196 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 16:55:33,196 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 16:55:33,196 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:55:35,774 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 16:55:35,774 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 16:55:35,774 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 16:55:35,774 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 16:55:35,774 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 16:55:38,381 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 16:55:38,381 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 16:55:38,381 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 16:55:38,381 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 16:55:38,381 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 16:55:40,849 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 16:55:40,850 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 16:55:40,850 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 16:55:40,850 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 16:55:40,850 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 16:55:43,452 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 16:55:43,453 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 16:55:43,453 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 16:55:43,453 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 16:55:43,453 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 16:55:46,085 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 16:55:46,085 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 16:55:46,085 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 16:55:46,085 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 16:55:46,085 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 16:55:48,620 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 16:55:48,621 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 16:55:48,621 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 16:55:48,621 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 16:55:48,621 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 16:55:51,217 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 16:55:51,217 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 16:55:51,217 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 16:55:51,217 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 16:55:51,217 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 16:55:51,225 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark_comparison/benchmark_20250317_165528/benchmark_results.json
2025-03-17 16:55:53,984 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark_comparison/benchmark_20250317_165528/plots
2025-03-17 16:55:53,984 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 16:55:53,984 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 16:55:53,984 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 16:55:53,984 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 16:55:53,984 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 16:55:53,984 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 16:55:53,984 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 16:55:53,984 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 16:55:53,984 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 16:55:53,984 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 16:58:22,315 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 16:58:22,315 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:03:54,735 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:03:54,736 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:04:03,349 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:04:03,349 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:04:29,744 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:04:29,744 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:04:29,745 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:04:29,745 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:04:29,745 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:04:29,746 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:04:31,053 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:04:31,053 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:04:31,053 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 175.25
2025-03-17 17:04:31,053 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10944529.64
2025-03-17 17:04:31,053 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:04:32,277 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:04:32,277 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 17:04:32,277 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.58
2025-03-17 17:04:32,277 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232909.97
2025-03-17 17:04:32,277 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:04:33,552 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:04:33,552 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296203.02 ± 1638.84
2025-03-17 17:04:33,552 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.49
2025-03-17 17:04:33,552 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10740523.25
2025-03-17 17:04:33,552 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:04:34,842 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:04:34,842 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:04:34,842 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 184.56
2025-03-17 17:04:34,842 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10940006.17
2025-03-17 17:04:34,842 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:04:36,097 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:04:36,097 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 17:04:36,097 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.81
2025-03-17 17:04:36,097 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8620905.84
2025-03-17 17:04:36,097 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:04:37,377 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:04:37,377 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 234542.63 ± 14491.83
2025-03-17 17:04:37,377 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.97
2025-03-17 17:04:37,377 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9929924.22
2025-03-17 17:04:37,377 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-17 17:04:38,673 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:04:38,673 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:04:38,673 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 173.80
2025-03-17 17:04:38,673 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10681128.91
2025-03-17 17:04:38,673 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:04:39,944 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:04:39,945 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 17:04:39,945 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.92
2025-03-17 17:04:39,945 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8881686.14
2025-03-17 17:04:39,945 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:04:41,267 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:04:41,267 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 237832.00 ± 48914.65
2025-03-17 17:04:41,267 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 165.40
2025-03-17 17:04:41,267 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10096101.69
2025-03-17 17:04:41,267 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-17 17:04:41,267 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:04:41,267 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:04:41,716 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:04:41,717 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:04:41,717 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'TrainedModel' from results/ppo_training/best_model.pth
2025-03-17 17:04:41,718 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:04:41,718 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:04:41,722 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:04:41,723 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:04:41,723 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'TrainedModel' from results/ppo_training/best_model.pth
2025-03-17 17:04:41,724 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:04:41,724 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:04:41,728 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:04:41,729 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:04:41,730 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'TrainedModel' from results/ppo_training/best_model.pth
2025-03-17 17:04:41,735 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/analysis/analysis_20250317_170429/benchmark/benchmark_20250317_170429/benchmark_results.json
2025-03-17 17:04:44,428 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/analysis/analysis_20250317_170429/benchmark/benchmark_20250317_170429/plots
2025-03-17 17:04:45,027 - TrafficRL.Utils.Analysis - INFO - Comparative analysis completed and saved to results/analysis/analysis_20250317_170429/comparative
2025-03-17 17:04:45,028 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:04:45,028 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2
2025-03-17 17:04:45,029 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo_training/best_model.pth
2025-03-17 17:04:45,403 - TrafficRL.Utils.Analysis - INFO - Report generation: Creating visualizations
2025-03-17 17:04:45,404 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: action_distribution.png
2025-03-17 17:04:45,404 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: congestion_performance.png
2025-03-17 17:04:45,404 - TrafficRL.Utils.Analysis - WARNING - Could not find benchmark plot: radar_chart_uniform.png
2025-03-17 17:04:45,405 - TrafficRL.Utils.Analysis - INFO - Found and included 7 benchmark plots in the report
2025-03-17 17:04:45,405 - TrafficRL.Utils.Analysis - INFO - Comprehensive report generated at results/analysis/analysis_20250317_170429/report/analysis_report.html
2025-03-17 17:04:45,413 - TrafficRL - INFO - Analysis completed. Results available in results/analysis/analysis_20250317_170429
2025-03-17 17:04:45,413 - TrafficRL - INFO - HTML report available at: results/analysis/analysis_20250317_170429/report/analysis_report.html
2025-03-17 17:08:36,636 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:08:36,636 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:08:36,636 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:08:36,636 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:08:36,636 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:08:36,637 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:08:39,174 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:08:39,174 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:08:39,174 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:08:39,174 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:08:39,174 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:08:41,584 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:08:41,584 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:08:41,584 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:08:41,584 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:08:41,584 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:08:44,093 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:08:44,093 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:08:44,093 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:08:44,093 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:08:44,093 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:08:46,625 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:08:46,625 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:08:46,625 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:08:46,625 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:08:46,625 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:08:49,126 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:08:49,126 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:08:49,126 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:08:49,126 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:08:49,126 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:08:51,632 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:08:51,632 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:08:51,632 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:08:51,633 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:08:51,633 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:08:54,201 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:08:54,201 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:08:54,201 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:08:54,201 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:08:54,201 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:08:56,661 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:08:56,661 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:08:56,661 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:08:56,661 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:08:56,661 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:08:59,343 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:08:59,343 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:08:59,343 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:08:59,343 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:08:59,343 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:08:59,343 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:08:59,344 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:08:59,755 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:08:59,756 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:08:59,756 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:08:59,756 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:08:59,756 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:08:59,761 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:08:59,761 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:08:59,762 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:08:59,762 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:08:59,762 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:08:59,767 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:08:59,768 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:08:59,768 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:08:59,774 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_170836/benchmark_results.json
2025-03-17 17:09:02,506 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_170836/plots
2025-03-17 17:09:02,506 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:09:02,506 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:09:02,506 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:09:02,506 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:09:02,506 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:09:02,506 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:09:02,506 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:09:02,506 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:09:02,507 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:09:02,507 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:09:59,460 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:09:59,460 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:09:59,460 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:09:59,460 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:09:59,460 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:09:59,461 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:10:02,015 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:10:02,015 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:10:02,015 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:10:02,015 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:10:02,015 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:10:04,416 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:10:04,416 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:10:04,416 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:10:04,416 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:10:04,416 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:10:06,928 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:10:06,929 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:10:06,929 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:10:06,929 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:10:06,929 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:10:09,474 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:10:09,474 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:10:09,474 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:10:09,474 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:10:09,474 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:10:11,960 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:10:11,961 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:10:11,961 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:10:11,961 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:10:11,961 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:10:14,486 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:10:14,487 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:10:14,487 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:10:14,487 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:10:14,487 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:10:17,083 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:10:17,084 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:10:17,084 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:10:17,084 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:10:17,084 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:10:19,540 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:10:19,540 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:10:19,540 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:10:19,540 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:10:19,540 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:10:22,332 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:10:22,333 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:10:22,333 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:10:22,333 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:10:22,333 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:10:22,333 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:10:22,333 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:10:22,745 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:10:22,746 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:10:22,746 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:10:22,747 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:10:22,747 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:10:22,751 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:10:22,752 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:10:22,752 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:10:22,753 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:10:22,753 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:10:22,757 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:10:22,758 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:10:22,758 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:10:22,763 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_170959/benchmark_results.json
2025-03-17 17:10:25,505 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_170959/plots
2025-03-17 17:10:25,505 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:10:25,505 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:10:25,506 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:10:25,506 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:10:25,506 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:10:25,506 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:10:25,506 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:10:25,506 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:10:25,506 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:10:25,506 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:10:57,644 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:10:57,645 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:10:57,645 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:10:57,645 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:10:57,645 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:10:57,645 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:11:00,201 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:11:00,201 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:11:00,201 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:11:00,201 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:11:00,201 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:11:02,601 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:11:02,601 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:11:02,601 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:11:02,601 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:11:02,601 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:11:05,148 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:11:05,148 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:11:05,148 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:11:05,148 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:11:05,148 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:11:07,740 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:11:07,740 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:11:07,740 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:11:07,740 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:11:07,740 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:11:10,235 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:11:10,235 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:11:10,235 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:11:10,235 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:11:10,236 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:11:12,924 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:11:12,924 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:11:12,924 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:11:12,924 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:11:12,924 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:11:15,525 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:11:15,526 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:11:15,526 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:11:15,526 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:11:15,526 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:11:18,080 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:11:18,080 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:11:18,080 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:11:18,080 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:11:18,080 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:11:20,727 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:11:20,727 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:11:20,727 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:11:20,727 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:11:20,727 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:11:20,727 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:11:20,727 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:11:21,171 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:11:21,172 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:11:21,172 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:11:21,172 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:11:21,172 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:11:21,177 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:11:21,178 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:11:21,178 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:11:21,178 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:11:21,178 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:11:21,182 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:11:21,184 - TrafficRL.Agent - ERROR - Error loading model components: 'local_network_state_dict'
2025-03-17 17:11:21,184 - TrafficRL.Utils.Benchmark - ERROR - Failed to load model for agent 'PPO' from results/ppo_training/best_model.pth
2025-03-17 17:11:21,189 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_171057/benchmark_results.json
2025-03-17 17:11:23,928 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_171057/plots
2025-03-17 17:11:23,929 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:11:23,929 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:11:23,929 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:11:23,929 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:11:23,929 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:11:23,929 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:11:23,929 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:11:23,929 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:11:23,929 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:11:23,929 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:12:54,562 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:12:54,562 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:12:54,562 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:12:54,562 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:12:54,562 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:12:54,562 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:12:54,563 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:12:54,969 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2
2025-03-17 17:12:54,970 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo_training/best_model.pth
2025-03-17 17:12:54,970 - TrafficRL.Utils.Benchmark - INFO - Successfully loaded PPO model from results/ppo_training/best_model.pth
2025-03-17 17:12:57,533 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:12:57,533 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:12:57,533 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:12:57,533 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:12:57,533 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:12:59,933 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:12:59,934 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:12:59,934 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:12:59,934 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:12:59,934 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:13:02,436 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:13:02,436 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:13:02,436 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:13:02,436 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:13:02,436 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:13:04,953 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:13:04,953 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:13:04,953 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:13:04,953 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:13:04,953 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:13:07,676 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:13:07,676 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:13:07,676 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:13:07,676 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:13:07,676 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:13:10,195 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:13:10,195 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:13:10,195 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:13:10,195 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:13:10,195 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:13:12,766 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:13:12,766 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:13:12,766 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:13:12,766 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:13:12,767 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:13:15,210 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:13:15,210 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:13:15,210 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:13:15,210 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:13:15,210 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:13:17,795 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:13:17,795 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:13:17,795 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:13:17,795 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:13:17,795 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:13:21,186 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on uniform:
2025-03-17 17:13:21,186 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 136607.63 ± 62635.40
2025-03-17 17:13:21,186 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 202.27
2025-03-17 17:13:21,186 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9380137.60
2025-03-17 17:13:21,186 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:13:24,542 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 17:13:24,542 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 278261.06 ± 85641.28
2025-03-17 17:13:24,542 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 222.26
2025-03-17 17:13:24,542 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 12731984.30
2025-03-17 17:13:24,542 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:13:28,027 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on weekend:
2025-03-17 17:13:28,027 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 217840.15 ± 73729.50
2025-03-17 17:13:28,027 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 187.22
2025-03-17 17:13:28,027 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10512613.46
2025-03-17 17:13:28,027 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=5.2%, EW=94.8%
2025-03-17 17:13:28,033 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_171254/benchmark_results.json
2025-03-17 17:13:30,924 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_171254/plots
2025-03-17 17:13:30,924 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:13:30,924 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:13:30,924 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:13:30,924 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:13:30,924 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:13:30,925 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:13:30,925 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:13:30,925 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:13:30,925 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:13:30,925 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:13:30,925 - TrafficRL - INFO -   PPO_uniform: Reward=136607.63, Waiting=202.27
2025-03-17 17:13:30,925 - TrafficRL - INFO -   PPO_rush_hour: Reward=278261.06, Waiting=222.26
2025-03-17 17:13:30,925 - TrafficRL - INFO -   PPO_weekend: Reward=217840.15, Waiting=187.22
2025-03-17 17:15:07,737 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:15:07,738 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:15:07,738 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:15:07,738 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:15:07,738 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:15:07,738 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:15:07,738 - TrafficRL.Utils.Benchmark - INFO - Attempting to load model from results/ppo_training/best_model.pth
2025-03-17 17:15:07,739 - TrafficRL.Utils.Benchmark - INFO - Model loaded successfully, checking for agent type indicators
2025-03-17 17:15:07,739 - TrafficRL.Utils.Benchmark - INFO - Detected PPO model structure
2025-03-17 17:15:07,739 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:15:08,145 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2
2025-03-17 17:15:08,147 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo_training/best_model.pth
2025-03-17 17:15:08,147 - TrafficRL.Utils.Benchmark - INFO - Successfully loaded PPO model from results/ppo_training/best_model.pth
2025-03-17 17:15:10,692 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:15:10,692 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:15:10,692 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:15:10,692 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:15:10,692 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:15:13,079 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:15:13,079 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:15:13,079 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:15:13,079 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:15:13,079 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:15:15,567 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:15:15,567 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:15:15,567 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:15:15,567 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:15:15,567 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:15:18,109 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:15:18,109 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:15:18,109 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:15:18,109 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:15:18,109 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:15:20,672 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:15:20,672 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:15:20,672 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:15:20,672 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:15:20,672 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:15:23,173 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:15:23,173 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:15:23,173 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:15:23,173 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:15:23,173 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:15:25,721 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:15:25,722 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:15:25,722 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:15:25,722 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:15:25,722 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:15:28,159 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:15:28,159 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:15:28,159 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:15:28,159 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:15:28,159 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:15:30,825 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:15:30,825 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:15:30,825 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:15:30,826 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:15:30,826 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:15:34,196 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on uniform:
2025-03-17 17:15:34,196 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 136607.63 ± 62635.40
2025-03-17 17:15:34,196 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 202.27
2025-03-17 17:15:34,196 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9380137.60
2025-03-17 17:15:34,196 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:15:37,533 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 17:15:37,533 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 278261.06 ± 85641.28
2025-03-17 17:15:37,533 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 222.26
2025-03-17 17:15:37,533 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 12731984.30
2025-03-17 17:15:37,533 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:15:40,969 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on weekend:
2025-03-17 17:15:40,969 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 217840.15 ± 73729.50
2025-03-17 17:15:40,969 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 187.22
2025-03-17 17:15:40,969 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10512613.46
2025-03-17 17:15:40,969 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=5.2%, EW=94.8%
2025-03-17 17:15:40,975 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_171508/benchmark_results.json
2025-03-17 17:15:43,872 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_171508/plots
2025-03-17 17:15:43,872 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:15:43,872 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:15:43,872 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:15:43,872 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:15:43,872 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:15:43,873 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:15:43,873 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:15:43,873 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:15:43,873 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:15:43,873 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:15:43,873 - TrafficRL - INFO -   PPO_uniform: Reward=136607.63, Waiting=202.27
2025-03-17 17:15:43,873 - TrafficRL - INFO -   PPO_rush_hour: Reward=278261.06, Waiting=222.26
2025-03-17 17:15:43,873 - TrafficRL - INFO -   PPO_weekend: Reward=217840.15, Waiting=187.22
2025-03-17 17:16:46,615 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:16:46,616 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:16:46,617 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-17 17:16:46,617 - TrafficRL - INFO - Starting training with dqn agent...
2025-03-17 17:16:46,618 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:16:46,618 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 17:16:47,029 - TrafficRL.Agent - INFO - Using Prioritized Experience Replay
2025-03-17 17:16:47,831 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, Epsilon: 0.3897, LR: 0.000300, Traffic: uniform
2025-03-17 17:16:48,634 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 992.98, Avg Reward: 993.17, Epsilon: 0.1430, LR: 0.000285, Traffic: uniform
2025-03-17 17:16:49,457 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.83, Avg Reward: 994.06, Epsilon: 0.0525, LR: 0.000271, Traffic: uniform
2025-03-17 17:16:50,296 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 993.79, Avg Reward: 993.99, Epsilon: 0.0193, LR: 0.000257, Traffic: uniform
2025-03-17 17:16:51,144 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 995.17, Avg Reward: 994.23, Epsilon: 0.0100, LR: 0.000244, Traffic: uniform
2025-03-17 17:16:52,027 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 993.29, Avg Reward: 994.07, Epsilon: 0.0100, LR: 0.000232, Traffic: uniform
2025-03-17 17:16:52,915 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 995.27, Avg Reward: 994.24, Epsilon: 0.0100, LR: 0.000221, Traffic: uniform
2025-03-17 17:16:53,810 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 992.59, Avg Reward: 994.04, Epsilon: 0.0100, LR: 0.000210, Traffic: uniform
2025-03-17 17:16:54,736 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 993.65, Avg Reward: 993.99, Epsilon: 0.0100, LR: 0.000199, Traffic: uniform
2025-03-17 17:16:55,681 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 994.15, Avg Reward: 994.01, Epsilon: 0.0100, LR: 0.000189, Traffic: uniform
2025-03-17 17:16:56,631 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 984.81, Avg Reward: 993.17, Epsilon: 0.0100, LR: 0.000180, Traffic: uniform
2025-03-17 17:16:57,596 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 995.10, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000171, Traffic: uniform
2025-03-17 17:16:58,694 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 987.29, Avg Reward: 992.87, Epsilon: 0.0100, LR: 0.000162, Traffic: uniform
2025-03-17 17:16:59,819 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 966.01, Avg Reward: 990.95, Epsilon: 0.0100, LR: 0.000154, Traffic: uniform
2025-03-17 17:17:00,910 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 989.96, Avg Reward: 990.88, Epsilon: 0.0100, LR: 0.000146, Traffic: uniform
2025-03-17 17:17:02,034 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 992.89, Avg Reward: 991.01, Epsilon: 0.0100, LR: 0.000139, Traffic: uniform
2025-03-17 17:17:03,191 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 805.33, Avg Reward: 980.09, Epsilon: 0.0100, LR: 0.000132, Traffic: uniform
2025-03-17 17:17:04,378 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 508.63, Avg Reward: 953.90, Epsilon: 0.0100, LR: 0.000125, Traffic: uniform
2025-03-17 17:17:05,528 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 981.43, Avg Reward: 955.34, Epsilon: 0.0100, LR: 0.000119, Traffic: uniform
2025-03-17 17:17:06,668 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 992.37, Avg Reward: 957.20, Epsilon: 0.0100, LR: 0.000113, Traffic: uniform
2025-03-17 17:17:06,668 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-17 17:17:07,901 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 360348.29
2025-03-17 17:17:07,907 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-17 17:17:07,907 - TrafficRL.Train - INFO - New best model saved with reward: 360348.29
2025-03-17 17:17:09,031 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 988.27, Avg Reward: 958.68, Epsilon: 0.0100, LR: 0.000108, Traffic: uniform
2025-03-17 17:17:10,201 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 991.52, Avg Reward: 960.17, Epsilon: 0.0100, LR: 0.000102, Traffic: uniform
2025-03-17 17:17:11,359 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 992.39, Avg Reward: 961.57, Epsilon: 0.0100, LR: 0.000097, Traffic: uniform
2025-03-17 17:17:12,529 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 993.85, Avg Reward: 962.91, Epsilon: 0.0100, LR: 0.000092, Traffic: uniform
2025-03-17 17:17:13,715 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 992.81, Avg Reward: 964.11, Epsilon: 0.0100, LR: 0.000088, Traffic: uniform
2025-03-17 17:17:13,720 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_25.pth
2025-03-17 17:17:13,720 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-17 17:17:14,939 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 987.07, Avg Reward: 964.99, Epsilon: 0.0100, LR: 0.000083, Traffic: uniform
2025-03-17 17:17:16,166 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 990.65, Avg Reward: 965.94, Epsilon: 0.0100, LR: 0.000079, Traffic: uniform
2025-03-17 17:17:17,402 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 986.02, Avg Reward: 966.66, Epsilon: 0.0100, LR: 0.000075, Traffic: uniform
2025-03-17 17:17:18,658 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 991.83, Avg Reward: 967.53, Epsilon: 0.0100, LR: 0.000071, Traffic: uniform
2025-03-17 17:17:19,944 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 986.75, Avg Reward: 968.17, Epsilon: 0.0100, LR: 0.000068, Traffic: uniform
2025-03-17 17:17:21,229 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 992.91, Avg Reward: 968.97, Epsilon: 0.0100, LR: 0.000064, Traffic: uniform
2025-03-17 17:17:22,625 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 986.32, Avg Reward: 969.51, Epsilon: 0.0100, LR: 0.000061, Traffic: uniform
2025-03-17 17:17:23,969 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 988.60, Avg Reward: 970.09, Epsilon: 0.0100, LR: 0.000058, Traffic: uniform
2025-03-17 17:17:25,319 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 993.26, Avg Reward: 970.77, Epsilon: 0.0100, LR: 0.000055, Traffic: uniform
2025-03-17 17:17:26,696 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 989.88, Avg Reward: 971.32, Epsilon: 0.0100, LR: 0.000052, Traffic: uniform
2025-03-17 17:17:28,088 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 991.89, Avg Reward: 971.89, Epsilon: 0.0100, LR: 0.000050, Traffic: uniform
2025-03-17 17:17:29,486 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 995.92, Avg Reward: 972.54, Epsilon: 0.0100, LR: 0.000047, Traffic: uniform
2025-03-17 17:17:30,913 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 993.48, Avg Reward: 973.09, Epsilon: 0.0100, LR: 0.000045, Traffic: uniform
2025-03-17 17:17:32,354 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 982.94, Avg Reward: 973.34, Epsilon: 0.0100, LR: 0.000043, Traffic: uniform
2025-03-17 17:17:33,812 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 990.59, Avg Reward: 973.77, Epsilon: 0.0100, LR: 0.000041, Traffic: uniform
2025-03-17 17:17:33,812 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-17 17:17:35,038 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 230516.59
2025-03-17 17:17:35,038 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:17:36,511 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 990.84, Avg Reward: 974.19, Epsilon: 0.0100, LR: 0.000039, Traffic: uniform
2025-03-17 17:17:38,003 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 990.92, Avg Reward: 974.59, Epsilon: 0.0100, LR: 0.000037, Traffic: uniform
2025-03-17 17:17:39,514 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 984.69, Avg Reward: 974.82, Epsilon: 0.0100, LR: 0.000035, Traffic: uniform
2025-03-17 17:17:41,052 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 994.76, Avg Reward: 975.27, Epsilon: 0.0100, LR: 0.000033, Traffic: uniform
2025-03-17 17:17:42,598 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 991.89, Avg Reward: 975.64, Epsilon: 0.0100, LR: 0.000031, Traffic: uniform
2025-03-17 17:17:44,246 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 995.96, Avg Reward: 976.09, Epsilon: 0.0100, LR: 0.000030, Traffic: uniform
2025-03-17 17:17:45,913 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 990.84, Avg Reward: 976.40, Epsilon: 0.0100, LR: 0.000028, Traffic: uniform
2025-03-17 17:17:47,558 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 990.75, Avg Reward: 976.70, Epsilon: 0.0100, LR: 0.000027, Traffic: uniform
2025-03-17 17:17:49,219 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 983.31, Avg Reward: 976.83, Epsilon: 0.0100, LR: 0.000026, Traffic: uniform
2025-03-17 17:17:50,903 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 993.68, Avg Reward: 977.17, Epsilon: 0.0100, LR: 0.000024, Traffic: uniform
2025-03-17 17:17:50,909 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_50.pth
2025-03-17 17:17:50,909 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-17 17:17:52,623 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 991.14, Avg Reward: 977.44, Epsilon: 0.0100, LR: 0.000023, Traffic: uniform
2025-03-17 17:17:54,346 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 991.89, Avg Reward: 977.72, Epsilon: 0.0100, LR: 0.000022, Traffic: uniform
2025-03-17 17:17:56,193 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 992.79, Avg Reward: 978.01, Epsilon: 0.0100, LR: 0.000021, Traffic: uniform
2025-03-17 17:17:58,012 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 995.05, Avg Reward: 978.32, Epsilon: 0.0100, LR: 0.000020, Traffic: uniform
2025-03-17 17:17:59,827 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 990.23, Avg Reward: 978.54, Epsilon: 0.0100, LR: 0.000019, Traffic: uniform
2025-03-17 17:18:01,710 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 995.68, Avg Reward: 978.84, Epsilon: 0.0100, LR: 0.000018, Traffic: uniform
2025-03-17 17:18:03,593 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 993.55, Avg Reward: 979.10, Epsilon: 0.0100, LR: 0.000017, Traffic: uniform
2025-03-17 17:18:05,471 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 988.77, Avg Reward: 979.27, Epsilon: 0.0100, LR: 0.000016, Traffic: uniform
2025-03-17 17:18:07,373 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 991.02, Avg Reward: 979.47, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-17 17:18:09,355 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 995.73, Avg Reward: 979.74, Epsilon: 0.0100, LR: 0.000015, Traffic: uniform
2025-03-17 17:18:09,355 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-17 17:18:10,632 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 155853.52
2025-03-17 17:18:10,632 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:18:12,551 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 985.28, Avg Reward: 979.83, Epsilon: 0.0100, LR: 0.000014, Traffic: uniform
2025-03-17 17:18:14,503 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.21, Avg Reward: 980.05, Epsilon: 0.0100, LR: 0.000013, Traffic: uniform
2025-03-17 17:18:16,506 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 985.43, Avg Reward: 980.13, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-17 17:18:18,500 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 993.30, Avg Reward: 980.34, Epsilon: 0.0100, LR: 0.000012, Traffic: uniform
2025-03-17 17:18:20,498 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 989.39, Avg Reward: 980.48, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-17 17:18:22,512 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 992.13, Avg Reward: 980.65, Epsilon: 0.0100, LR: 0.000011, Traffic: uniform
2025-03-17 17:18:24,600 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 993.89, Avg Reward: 980.85, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-17 17:18:26,666 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 988.97, Avg Reward: 980.97, Epsilon: 0.0100, LR: 0.000010, Traffic: uniform
2025-03-17 17:18:28,784 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 994.94, Avg Reward: 981.17, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-17 17:18:30,898 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 984.68, Avg Reward: 981.22, Epsilon: 0.0100, LR: 0.000009, Traffic: uniform
2025-03-17 17:18:33,025 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 987.38, Avg Reward: 981.31, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-17 17:18:35,223 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 978.21, Avg Reward: 981.27, Epsilon: 0.0100, LR: 0.000008, Traffic: uniform
2025-03-17 17:18:37,389 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 989.65, Avg Reward: 981.38, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-17 17:18:39,642 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 985.40, Avg Reward: 981.44, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-17 17:18:41,906 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 992.40, Avg Reward: 981.58, Epsilon: 0.0100, LR: 0.000007, Traffic: uniform
2025-03-17 17:18:41,913 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_75.pth
2025-03-17 17:18:41,913 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-17 17:18:44,290 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 990.90, Avg Reward: 981.70, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-17 17:18:46,715 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 981.89, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-17 17:18:49,034 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 991.79, Avg Reward: 982.02, Epsilon: 0.0100, LR: 0.000006, Traffic: uniform
2025-03-17 17:18:51,254 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 991.86, Avg Reward: 982.14, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-17 17:18:53,585 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 990.12, Avg Reward: 982.24, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-17 17:18:53,586 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-17 17:18:54,821 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 194654.10
2025-03-17 17:18:54,821 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:18:57,195 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 994.00, Avg Reward: 982.39, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-17 17:18:59,503 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 988.14, Avg Reward: 982.46, Epsilon: 0.0100, LR: 0.000005, Traffic: uniform
2025-03-17 17:19:01,869 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 990.70, Avg Reward: 982.56, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-17 17:19:04,221 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 995.05, Avg Reward: 982.71, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-17 17:19:06,654 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 993.68, Avg Reward: 982.84, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-17 17:19:09,092 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 980.68, Avg Reward: 982.81, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-17 17:19:11,596 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 991.66, Avg Reward: 982.91, Epsilon: 0.0100, LR: 0.000004, Traffic: uniform
2025-03-17 17:19:14,077 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 994.92, Avg Reward: 983.05, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:16,611 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 996.73, Avg Reward: 983.20, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:19,030 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 988.57, Avg Reward: 983.26, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:21,561 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 993.76, Avg Reward: 983.38, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:24,071 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 993.96, Avg Reward: 983.49, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:26,640 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 990.63, Avg Reward: 983.57, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:29,160 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 993.85, Avg Reward: 983.68, Epsilon: 0.0100, LR: 0.000003, Traffic: uniform
2025-03-17 17:19:31,744 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 990.86, Avg Reward: 983.75, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-17 17:19:34,380 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 994.70, Avg Reward: 983.87, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-17 17:19:37,057 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 992.37, Avg Reward: 983.96, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-17 17:19:39,854 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 995.14, Avg Reward: 984.07, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-17 17:19:42,484 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 994.91, Avg Reward: 984.18, Epsilon: 0.0100, LR: 0.000002, Traffic: uniform
2025-03-17 17:19:42,484 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-17 17:19:45,100 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 995.46, Avg Reward: 984.29, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-17 17:19:45,100 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-17 17:19:46,309 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 98443.74
2025-03-17 17:19:46,309 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:19:46,318 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_100.pth
2025-03-17 17:19:46,318 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-17 17:19:49,243 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 993.27, Avg Reward: 984.29, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-17 17:19:52,056 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 996.71, Avg Reward: 984.33, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-17 17:19:54,834 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 990.11, Avg Reward: 984.27, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-17 17:19:57,432 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 994.55, Avg Reward: 984.28, Epsilon: 0.0100, LR: 0.000002, Traffic: rush_hour
2025-03-17 17:20:00,044 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 991.80, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:02,707 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 993.02, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:05,309 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 995.33, Avg Reward: 984.24, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:07,854 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 994.78, Avg Reward: 984.26, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:10,439 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 993.29, Avg Reward: 984.26, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:12,971 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 994.69, Avg Reward: 984.27, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:15,531 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 992.72, Avg Reward: 984.35, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:18,085 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 990.72, Avg Reward: 984.30, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:20,626 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 993.27, Avg Reward: 984.36, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:23,185 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 994.23, Avg Reward: 984.64, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:25,729 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 992.33, Avg Reward: 984.67, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:28,275 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 987.03, Avg Reward: 984.61, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:30,817 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 996.74, Avg Reward: 986.52, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:33,350 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 995.74, Avg Reward: 991.39, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:35,896 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 992.98, Avg Reward: 991.51, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:38,433 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 991.13, Avg Reward: 991.50, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:38,434 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-17 17:20:39,642 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 106344.63
2025-03-17 17:20:39,642 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-17 17:20:42,191 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 989.46, Avg Reward: 991.51, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:44,745 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 993.89, Avg Reward: 991.53, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:47,281 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 993.88, Avg Reward: 991.55, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:49,835 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 995.06, Avg Reward: 991.56, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:52,368 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 995.11, Avg Reward: 991.58, Epsilon: 0.0100, LR: 0.000001, Traffic: rush_hour
2025-03-17 17:20:52,377 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_125.pth
2025-03-17 17:20:52,377 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-17 17:20:54,950 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 993.61, Avg Reward: 991.65, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:20:57,500 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 991.95, Avg Reward: 991.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:00,058 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 991.42, Avg Reward: 991.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:02,589 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 996.12, Avg Reward: 991.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:05,141 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 990.08, Avg Reward: 991.79, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:07,683 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 994.82, Avg Reward: 991.81, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:10,235 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 996.54, Avg Reward: 991.91, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:12,851 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 993.42, Avg Reward: 991.96, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:15,398 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 994.95, Avg Reward: 991.98, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:17,938 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 990.28, Avg Reward: 991.98, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:20,489 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 993.89, Avg Reward: 992.00, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:23,067 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 996.54, Avg Reward: 992.01, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:25,616 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 994.40, Avg Reward: 992.02, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:28,199 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 996.64, Avg Reward: 992.15, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:30,752 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 994.57, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:30,752 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-17 17:21:31,957 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 129038.54
2025-03-17 17:21:31,958 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-17 17:21:34,496 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 993.92, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:37,021 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 991.50, Avg Reward: 992.23, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:39,543 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 994.74, Avg Reward: 992.33, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:42,076 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 995.70, Avg Reward: 992.34, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:44,594 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 994.72, Avg Reward: 992.37, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:47,120 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 996.32, Avg Reward: 992.37, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:49,646 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 995.43, Avg Reward: 992.42, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:52,167 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 995.56, Avg Reward: 992.47, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:54,684 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 990.16, Avg Reward: 992.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:57,212 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 990.50, Avg Reward: 992.50, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:21:57,222 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_150.pth
2025-03-17 17:21:57,222 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-17 17:21:59,785 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 993.10, Avg Reward: 992.52, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:02,304 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.22, Avg Reward: 992.55, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:04,824 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 995.92, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:07,342 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 995.96, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:09,935 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 992.21, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:12,563 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 990.03, Avg Reward: 992.55, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:15,151 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 995.35, Avg Reward: 992.57, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:17,750 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 989.34, Avg Reward: 992.57, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:20,336 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 995.40, Avg Reward: 992.62, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:22,949 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 993.00, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:22,949 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-17 17:22:24,152 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 101362.45
2025-03-17 17:22:24,153 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-17 17:22:26,717 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 992.70, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:29,227 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 994.39, Avg Reward: 992.68, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:31,756 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 994.45, Avg Reward: 992.77, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:34,296 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 992.60, Avg Reward: 992.76, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:36,841 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 996.95, Avg Reward: 992.83, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:39,448 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 995.65, Avg Reward: 992.87, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:42,029 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 995.67, Avg Reward: 992.89, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:44,555 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 994.09, Avg Reward: 992.94, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:47,067 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 994.03, Avg Reward: 992.93, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:49,769 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 993.03, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:52,415 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 991.94, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:54,939 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 995.27, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:22:57,467 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.73, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:00,045 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 995.39, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:02,659 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 994.43, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:02,669 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_175.pth
2025-03-17 17:23:02,669 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-17 17:23:05,261 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 995.99, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:07,794 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 996.36, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:10,457 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 996.30, Avg Reward: 993.51, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:13,123 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 994.46, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:15,648 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 993.17, Avg Reward: 993.56, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:15,648 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-17 17:23:16,845 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 110604.08
2025-03-17 17:23:16,845 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-17 17:23:19,408 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 996.53, Avg Reward: 993.59, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:21,933 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 992.07, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:24,452 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 991.25, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:26,975 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 991.62, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:29,493 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 994.05, Avg Reward: 993.60, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:32,027 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 989.85, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:34,555 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 993.60, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:37,094 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 994.91, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:39,662 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 992.07, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:42,217 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 992.99, Avg Reward: 993.71, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:44,740 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 989.28, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:47,265 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 996.63, Avg Reward: 993.69, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:49,824 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 993.72, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:52,345 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 994.74, Avg Reward: 993.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:54,871 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 994.54, Avg Reward: 993.77, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:23:57,389 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 992.55, Avg Reward: 993.75, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:24:00,045 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 991.08, Avg Reward: 993.74, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:24:02,679 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 993.70, Avg Reward: 993.72, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:24:05,362 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 995.42, Avg Reward: 993.73, Epsilon: 0.0100, LR: 0.000000, Traffic: rush_hour
2025-03-17 17:24:05,362 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-17 17:24:08,774 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 989.71, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:08,774 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-17 17:24:10,002 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 566000.76
2025-03-17 17:24:10,012 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-17 17:24:10,012 - TrafficRL.Train - INFO - New best model saved with reward: 566000.76
2025-03-17 17:24:10,023 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_200.pth
2025-03-17 17:24:10,023 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-17 17:24:12,593 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 993.83, Avg Reward: 993.67, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:15,145 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 993.05, Avg Reward: 993.64, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:17,803 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 994.46, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:20,352 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 994.60, Avg Reward: 993.68, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:22,930 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 989.40, Avg Reward: 993.66, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:25,477 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 991.30, Avg Reward: 993.64, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:28,012 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 993.84, Avg Reward: 993.63, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:30,546 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 990.68, Avg Reward: 993.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:33,089 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 990.47, Avg Reward: 993.56, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:35,768 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 990.61, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:38,383 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 994.33, Avg Reward: 993.53, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:41,017 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 989.67, Avg Reward: 993.52, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:43,737 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 991.58, Avg Reward: 993.50, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:46,387 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 989.71, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:49,049 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 992.58, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:51,664 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 991.89, Avg Reward: 993.51, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:54,347 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 991.52, Avg Reward: 993.46, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:57,007 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 994.02, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:24:59,691 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 991.01, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:02,430 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 990.65, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:02,431 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-17 17:25:03,679 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 567757.29
2025-03-17 17:25:03,690 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-17 17:25:03,690 - TrafficRL.Train - INFO - New best model saved with reward: 567757.29
2025-03-17 17:25:06,454 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 991.86, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:09,171 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 991.50, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:11,978 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 996.10, Avg Reward: 993.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:14,720 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 993.71, Avg Reward: 993.43, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:17,501 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 991.03, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:17,513 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_225.pth
2025-03-17 17:25:17,513 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-17 17:25:20,233 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 991.98, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:22,948 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 991.30, Avg Reward: 993.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:25,678 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 987.84, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:28,872 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 995.41, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:31,663 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 988.21, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:34,590 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 990.65, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:37,480 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 994.30, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:40,232 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 992.16, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:43,087 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 990.73, Avg Reward: 993.18, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:46,017 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 992.28, Avg Reward: 993.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:48,887 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 992.88, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:51,693 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 992.38, Avg Reward: 993.15, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:54,548 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 989.49, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:25:57,356 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 991.89, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:00,148 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 993.85, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:00,148 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-17 17:26:01,434 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 563523.16
2025-03-17 17:26:01,434 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:26:04,414 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 992.24, Avg Reward: 993.03, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:07,554 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 994.67, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:08,632 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:26:08,632 - TrafficRL.Config - ERROR - Error loading configuration from configs/simple_dqn_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:26:08,632 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:26:08,633 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:26:08,633 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-17 17:26:08,633 - TrafficRL - INFO - Starting training with simple_dqn agent...
2025-03-17 17:26:08,634 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:26:09,188 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,190 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,191 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,196 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,200 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,201 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,203 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,209 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,211 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,215 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,216 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,218 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,219 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,221 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,222 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,224 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,225 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,232 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,234 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,239 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,241 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,243 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,245 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,247 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,250 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,251 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,253 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,254 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,257 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,259 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,261 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,263 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,264 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,265 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,267 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,269 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,271 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,272 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,274 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,278 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,279 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,280 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,282 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,283 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,286 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,287 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,290 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,295 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,297 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,299 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,302 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,303 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,304 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,306 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,307 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,308 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,310 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,311 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,312 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,314 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,315 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,316 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,319 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,321 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,322 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,323 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,325 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,326 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,328 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,330 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,334 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,337 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,339 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,340 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,343 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,345 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,347 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,348 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,349 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,351 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,352 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,353 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,354 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,356 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,357 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,358 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,359 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,361 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,362 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,363 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,365 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,366 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,367 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,368 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,370 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,371 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,372 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,373 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,375 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,376 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,377 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,379 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,380 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,381 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,382 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,384 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,385 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,386 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,387 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,388 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,390 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,391 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,392 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,394 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,395 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,397 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,398 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,399 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,401 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,402 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,403 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,404 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,406 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,407 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,408 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,409 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,411 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,412 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,414 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,415 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,416 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,418 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,419 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,420 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,422 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,423 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,424 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,425 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,427 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,428 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,429 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,431 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,432 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,434 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,435 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,437 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,438 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,440 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,441 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,442 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,443 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,445 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,446 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,447 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,448 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,450 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,451 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,452 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,454 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,455 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,456 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,458 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,459 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,460 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,461 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,462 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,462 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:09,464 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,465 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,467 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,468 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,470 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,471 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,472 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,474 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,475 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,476 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,478 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,479 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,480 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,482 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,483 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,484 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,486 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,488 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,489 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,490 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,492 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,493 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,495 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,496 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,497 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,499 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,500 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,501 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,502 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,504 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,505 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,506 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,507 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,510 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,511 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,513 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,514 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,515 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,517 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,519 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,520 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,522 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,524 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,525 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,527 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,528 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,529 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,530 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,532 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,533 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,534 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,535 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,537 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,538 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,539 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,540 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,542 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,544 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,545 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,546 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,548 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,549 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,550 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,552 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,553 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,554 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,556 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,557 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,559 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,560 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,561 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,563 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,564 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,565 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,567 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,568 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,569 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,571 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,572 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,573 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,575 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,576 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,577 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,579 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,580 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,581 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,583 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,584 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,585 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,586 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,588 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,589 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,590 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,592 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,593 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,594 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,596 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,597 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,598 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,600 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,601 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,602 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,603 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,605 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,606 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,607 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,608 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,610 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,611 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,612 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,613 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,614 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,616 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,617 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,619 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,620 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,621 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,623 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,624 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,626 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,627 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,628 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,629 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,630 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,632 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,633 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,634 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,635 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,637 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,638 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,639 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,641 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,642 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,644 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,645 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,646 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,648 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,649 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,650 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,652 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,653 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,654 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,655 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,656 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,658 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,659 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,660 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,662 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,663 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,664 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,666 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,667 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,668 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,670 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,671 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,672 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,673 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,674 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,676 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,677 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,679 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,680 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,681 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,683 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,684 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,686 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,687 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,688 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,690 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,691 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,692 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,693 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,695 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,696 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,697 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,698 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,700 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,701 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,702 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,703 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,704 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,706 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,707 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,708 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,710 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,711 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,712 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,714 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,715 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,716 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,718 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,719 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,720 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,722 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,724 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,726 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,727 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,728 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,729 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,731 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,731 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 994.07, Avg Reward: 993.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:09,732 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,733 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,735 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,736 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,738 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,739 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,740 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,742 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,743 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,744 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,746 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,747 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,748 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,749 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,751 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,752 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,753 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,755 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,756 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,757 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,760 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,761 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,762 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,764 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,765 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,767 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,768 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,769 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,771 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,772 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,774 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,775 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,776 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,777 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,779 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,780 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,781 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,783 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,784 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,785 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,787 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,788 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,789 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,790 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,791 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,793 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,794 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,795 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,797 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,798 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,799 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,801 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,802 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,804 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,805 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,806 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,807 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,809 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,810 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,812 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,813 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,814 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,816 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,817 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,818 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,820 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,821 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,822 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,824 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,825 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,826 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,828 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,829 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,830 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,831 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,833 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,834 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,836 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,837 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,839 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,840 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,842 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,843 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,844 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,846 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,847 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,848 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,850 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,851 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,852 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,854 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,855 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,857 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,858 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,859 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,860 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,862 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,863 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,864 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,865 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,867 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,868 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,869 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,870 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,872 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,873 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,874 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,875 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,877 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,878 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,879 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,881 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,882 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,883 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,884 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,886 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,887 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,888 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,889 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,891 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,892 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,893 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,894 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,896 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,897 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,898 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,900 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,901 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,902 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,903 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,905 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,906 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,907 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,908 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,910 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,911 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,913 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,914 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,916 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,917 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,918 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,919 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,921 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,922 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,923 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,924 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,926 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,927 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,928 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,930 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,931 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,932 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,933 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,934 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,936 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,937 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,938 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,939 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,941 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,942 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,943 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,945 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,946 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,948 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,949 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,950 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,951 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,952 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,954 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,955 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,956 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,957 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,959 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,961 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,963 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,964 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,965 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,967 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,968 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,969 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,970 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,972 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,973 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,974 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,975 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,977 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,978 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,980 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,981 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,982 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,984 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,985 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,986 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,988 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,989 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,990 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,991 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,993 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,994 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,995 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,995 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 995.83, Avg Reward: 994.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:09,997 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,998 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:09,999 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,001 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,002 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,004 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,005 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,006 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,007 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,009 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,010 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,012 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,013 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,014 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,016 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,017 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,018 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,020 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,021 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,022 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,023 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,025 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,026 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,027 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,028 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,030 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,031 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,032 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,034 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,035 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,036 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,037 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,039 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,040 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,041 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,043 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,045 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,046 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,047 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,049 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,050 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,051 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,052 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,054 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,055 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,056 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,058 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,059 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,060 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,061 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,063 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,064 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,065 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,066 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,068 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,069 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,070 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,071 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,072 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,074 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,075 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,076 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,077 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,079 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,080 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,081 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,082 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,084 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,085 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,087 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,088 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,089 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,091 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,092 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,093 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,094 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,096 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,097 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,098 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,099 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,101 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,102 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,103 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,104 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,105 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,107 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,108 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,109 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,111 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,112 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,113 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,114 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,116 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,117 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,118 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,119 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,121 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,122 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,123 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,124 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,126 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,127 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,128 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,129 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,131 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,132 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,133 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,134 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,136 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,137 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,138 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,139 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,141 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,142 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,143 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,144 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,145 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,147 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,148 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,149 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,150 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,151 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,153 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,154 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,155 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,157 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,158 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,159 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,160 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,162 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,163 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,164 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,166 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,167 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,169 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,170 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,171 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,173 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,174 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,176 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,177 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,178 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,180 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,181 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,182 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,184 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,185 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,186 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,188 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,189 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,190 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,192 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,194 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,195 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,197 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,199 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,200 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,202 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,203 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,204 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,205 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,208 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,209 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,210 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,212 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,215 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,216 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,217 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,219 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,220 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,221 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,223 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,225 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,226 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,227 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,229 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,230 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,232 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,233 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,234 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,236 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,237 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,238 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,240 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,241 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,242 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,243 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,245 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,246 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,247 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,250 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,251 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,252 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,253 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,255 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,255 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 994.14, Avg Reward: 994.35, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:10,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,259 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,261 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,262 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,263 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,265 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,266 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,267 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,269 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,270 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,271 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,273 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,274 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,278 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,279 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,280 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,281 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,283 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,285 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,287 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,288 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,290 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,294 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,295 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,298 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,299 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,302 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,303 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,304 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,305 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,307 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,308 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,309 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,311 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,312 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,313 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,315 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,316 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,319 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,320 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,321 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,323 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,324 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,327 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,328 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,331 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,335 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,338 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,339 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,342 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,343 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,346 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,347 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,348 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,349 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,351 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,352 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,354 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,355 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,357 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,358 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,360 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,361 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,362 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,363 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,365 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,366 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,367 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,369 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,370 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,371 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,372 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,374 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,375 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,376 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,377 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,379 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,380 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,381 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,382 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,384 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,385 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,386 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,387 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,389 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,390 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,391 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,393 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,394 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,395 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,396 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,398 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,399 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,400 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,401 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,403 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,404 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,405 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,406 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,408 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,409 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,410 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,412 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,413 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,414 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,416 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,417 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,418 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,419 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,421 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,422 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,423 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,424 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,426 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,427 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,429 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,430 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,431 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,432 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,434 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,435 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,436 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,438 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,439 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,440 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,441 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,443 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,444 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,445 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,446 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,448 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,449 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,450 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,452 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,453 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,454 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,455 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,457 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,458 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,459 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,461 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,462 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,463 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,465 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,466 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,467 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,469 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,470 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,471 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,472 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,473 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,475 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,477 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,478 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,479 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,481 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,482 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,483 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,484 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,486 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,487 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,488 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,490 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,491 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,492 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,494 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,495 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,496 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,497 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,499 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,500 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,501 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,502 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,504 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,505 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,506 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,507 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,510 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,512 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,513 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,514 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,516 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,517 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,518 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,518 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 993.84, Avg Reward: 994.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:10,520 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,521 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,522 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,524 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,525 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,527 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,528 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,529 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,530 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,532 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,533 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,534 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,536 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,537 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,538 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,539 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,541 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,542 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,543 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,545 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,546 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,547 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,548 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,550 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,551 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,552 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,553 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,555 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,556 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,557 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,559 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,560 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,561 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,563 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,564 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,565 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,566 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,568 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,569 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,570 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,571 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,573 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,574 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,575 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,576 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,578 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,579 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,580 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,581 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,583 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,584 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,585 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,586 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,588 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,589 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,590 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,591 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,593 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,594 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,595 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,596 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,598 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,599 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,600 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,601 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,603 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,604 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,605 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,607 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,608 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,609 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,611 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,612 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,613 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,615 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,616 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,617 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,618 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,620 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,621 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,622 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,623 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,625 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,627 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,628 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,629 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,630 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,632 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,633 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,634 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,636 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,637 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,638 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,640 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,641 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,646 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,650 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,655 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,659 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,663 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,668 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,672 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,675 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,678 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,680 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,682 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,683 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,686 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,689 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,691 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,693 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,694 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,695 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,697 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,698 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,700 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,701 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,703 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,704 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,705 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,707 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,708 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,709 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,711 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,712 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,713 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,715 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,716 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,717 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,719 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,720 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,722 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,723 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,724 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,726 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,727 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,729 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,730 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,731 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,733 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,734 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,735 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,737 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,738 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,739 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,741 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,742 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,743 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,744 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,746 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,747 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,748 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,749 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,751 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,752 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,754 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,755 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,756 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,758 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,759 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,760 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,762 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,763 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,764 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,765 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,767 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,768 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,769 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,771 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,772 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,773 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,774 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,776 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,777 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,778 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,779 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,780 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,782 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,783 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,784 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,786 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,787 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,788 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,790 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,791 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,792 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,794 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,795 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,796 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,798 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,799 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,801 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,802 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,803 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,804 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,806 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,807 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,808 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,809 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,811 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,811 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 994.68, Avg Reward: 994.32, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:10,812 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,813 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,815 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,816 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,817 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,819 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,820 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,822 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,823 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,824 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,826 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,827 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,829 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,830 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,831 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,833 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,834 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,836 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,837 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,838 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,840 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,841 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,843 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,844 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,845 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,847 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,848 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,849 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,851 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,852 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,853 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,854 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,856 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,857 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,858 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,860 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,861 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,862 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,864 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,865 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,866 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,868 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,869 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,870 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,872 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,873 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,874 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,876 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,877 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,878 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,880 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,881 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,882 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,884 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,885 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,886 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,887 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,889 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,890 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,891 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,892 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,894 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,895 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,897 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,898 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,899 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,901 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,902 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,904 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,905 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,906 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,908 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,911 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,912 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,914 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,915 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,916 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,918 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,919 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,920 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,922 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,923 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,924 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,926 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,927 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,929 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,930 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,931 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,933 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,934 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,935 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,937 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,938 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,939 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,941 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,942 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,943 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,945 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,946 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,949 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,951 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,952 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,953 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,955 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,956 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,958 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,960 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,961 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,962 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,964 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,965 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,966 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,968 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,969 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,970 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,972 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,973 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,974 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,976 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,977 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,979 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,980 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,981 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,983 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,984 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,986 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,987 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,988 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,990 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,991 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,992 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,994 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,995 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,996 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,997 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:10,999 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,000 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,001 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,003 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,004 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,005 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,007 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,008 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,009 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,010 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,012 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,013 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,014 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,016 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,017 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,018 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,020 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,021 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,022 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,024 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,025 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,026 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,028 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,029 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,030 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,031 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,033 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,034 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,035 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,037 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,038 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,039 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,041 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,042 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,043 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,044 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,046 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,047 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,048 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,049 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,051 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,052 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,053 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,054 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,056 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,057 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,058 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,060 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,061 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,062 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,063 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,065 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,066 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,067 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,068 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,070 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,071 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,072 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,074 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,075 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,076 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,077 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,079 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,080 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,081 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,081 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 984.36, Avg Reward: 992.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:11,083 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,084 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,085 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,087 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,088 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,089 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,091 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,092 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,093 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,095 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,096 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,097 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,098 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,100 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,101 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,102 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,103 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,105 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,106 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,107 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,109 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,110 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,110 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 994.56, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:11,111 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,113 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,114 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,115 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,116 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,118 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,119 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,121 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,122 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,124 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,125 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,126 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,128 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,129 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,130 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,131 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,133 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,134 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,135 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,136 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,138 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,139 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,140 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,141 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,143 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,144 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,145 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,146 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,148 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,149 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,150 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,152 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,153 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,155 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,156 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,157 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,159 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,160 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,162 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,163 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,164 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,166 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,167 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,168 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,169 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,171 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,172 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,173 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,174 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,176 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,177 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,178 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,180 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,181 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,182 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,183 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,185 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,186 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,187 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,189 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,191 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,194 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,196 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,197 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,200 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,201 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,202 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,204 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,206 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,208 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,209 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,211 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,212 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,214 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,216 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,217 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,218 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,220 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,221 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,222 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,223 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,225 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,226 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,227 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,229 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,230 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,231 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,233 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,235 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,237 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,238 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,239 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,240 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,242 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,243 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,244 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,245 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,247 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,249 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,250 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,252 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,253 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,254 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,260 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,261 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,262 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,263 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,265 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,266 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,267 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,269 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,270 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,271 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,273 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,274 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,278 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,279 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,280 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,281 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,283 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,285 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,287 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,288 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,291 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,295 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,297 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,299 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,301 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,303 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,305 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,306 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,307 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,309 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,310 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,311 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,313 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,314 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,315 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,317 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,319 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,320 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,322 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,323 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,324 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,326 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,327 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,328 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,331 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,334 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,337 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,338 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,340 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,345 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,346 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,347 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,349 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,349 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 995.70, Avg Reward: 993.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:11,350 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,352 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,353 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,354 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,355 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,357 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,358 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,359 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,361 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,362 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,364 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,365 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,367 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,368 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,369 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,370 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,372 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,373 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,374 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,376 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,377 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,378 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,379 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,381 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,382 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,383 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,384 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,386 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,387 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,388 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,389 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,391 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,392 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,393 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,395 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,396 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,397 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,399 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,400 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,401 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,402 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,404 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,405 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,406 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,408 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,409 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,410 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,411 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,413 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,414 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,415 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,416 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,418 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,419 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,420 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,421 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,422 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,424 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,425 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,426 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,428 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,429 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,430 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,434 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,438 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,442 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,447 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,449 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,450 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,451 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,453 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,454 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,455 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,456 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,458 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,459 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,460 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,462 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,463 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,464 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,466 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,467 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,469 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,470 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,471 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,473 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,474 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,475 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,476 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,478 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,479 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,480 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,482 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,483 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,484 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,485 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,487 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,488 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,489 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,490 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,492 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,493 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,495 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,496 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,497 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,499 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,500 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,501 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,502 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,504 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,505 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,506 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,507 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,509 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,510 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,511 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,513 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,514 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,516 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,517 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,518 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,519 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,521 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,522 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,523 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,524 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,526 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,527 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,529 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,530 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,532 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,533 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,534 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,535 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,537 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,538 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,539 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,541 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,542 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,543 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,544 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,546 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,547 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,548 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,550 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,551 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,552 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,553 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,555 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,556 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,558 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,559 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,560 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,561 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,563 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,564 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,565 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,567 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,568 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,569 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,570 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,572 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,573 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,574 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,575 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,577 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,578 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,579 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,581 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,582 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,583 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,584 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,586 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,587 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,588 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,589 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,591 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,592 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,593 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,594 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,596 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,597 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,598 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,600 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,601 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,602 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,603 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,605 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,606 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,607 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,608 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,610 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,611 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,613 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,614 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,615 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,616 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,618 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,619 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,620 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,620 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 994.71, Avg Reward: 993.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:11,622 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,623 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,624 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,626 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,627 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,628 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,630 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,631 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,632 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,633 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,635 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,636 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,638 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,639 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,640 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,642 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,643 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,644 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,645 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,647 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,648 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,649 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,650 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,652 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,653 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,655 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,656 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,657 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,658 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,660 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,661 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,662 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,663 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,665 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,666 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,667 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,668 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,670 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,671 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,673 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,674 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,675 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,676 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,678 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,679 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,680 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,682 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,683 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,684 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,685 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,687 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,688 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,689 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,691 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,692 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,693 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,694 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,696 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,697 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,698 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,700 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,701 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,702 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,703 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,705 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,706 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,707 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,709 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,710 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,712 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,713 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,715 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,716 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,717 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,719 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,720 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,721 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,722 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,724 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,725 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,727 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,728 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,729 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,730 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,732 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,733 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,735 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,736 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,737 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,739 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,740 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,742 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,743 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,744 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,746 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,747 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,748 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,749 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,751 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,752 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,753 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,755 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,756 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,758 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,759 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,760 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,761 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,763 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,764 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,765 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,767 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,768 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,769 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,770 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,772 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,773 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,774 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,775 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,777 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,778 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,779 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,781 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,782 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,783 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,784 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,786 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,788 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,789 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,791 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,792 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,794 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,795 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,797 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,798 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,800 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,801 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,802 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,804 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,805 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,806 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,808 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,809 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,810 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,812 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,813 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,815 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,816 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,817 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,819 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,820 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,821 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,822 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,824 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,825 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,826 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,828 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,829 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,830 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,831 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,833 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,834 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,835 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,837 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,838 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,839 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,840 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,842 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,843 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,844 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,845 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,847 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,848 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,849 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,851 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,852 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,853 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,855 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,857 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,859 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,860 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,862 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,863 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,864 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,866 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,867 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,868 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,870 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,871 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,872 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,873 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,875 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,876 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,877 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,879 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,880 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,881 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,883 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,884 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,885 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,886 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,886 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 991.91, Avg Reward: 993.26, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:11,888 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,890 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,891 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,892 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,894 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,895 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,896 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,897 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,899 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,900 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,901 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,903 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,904 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,905 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,907 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,908 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,909 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,910 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,912 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,913 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,915 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,916 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,917 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,919 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,920 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,921 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,922 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,924 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,925 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,926 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,927 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,929 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,930 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,931 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,933 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,934 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,935 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,937 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,938 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,939 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,941 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,943 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,944 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,945 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,947 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,948 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,949 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,951 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,952 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,954 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,955 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,957 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,958 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,959 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,960 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,962 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,963 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,964 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,966 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,967 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,968 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,969 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,971 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,972 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,973 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,975 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,976 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,977 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,978 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,980 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,981 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,982 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,984 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,985 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,986 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,987 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,988 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,990 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,991 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,992 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,994 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,995 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,996 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:11,998 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,000 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,001 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,002 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,003 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,005 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,006 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,007 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,008 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,010 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,011 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,012 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,014 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,015 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,016 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,017 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,019 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,020 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,022 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,023 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,024 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,026 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,027 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,028 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,029 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,031 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,032 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,033 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,034 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,036 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,037 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,038 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,040 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,041 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,042 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,043 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,045 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,046 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,047 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,049 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,050 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,052 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,053 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,054 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,056 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,057 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,058 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,060 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,061 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,062 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,063 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,065 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,066 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,067 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,069 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,071 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,072 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,074 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,076 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,077 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,078 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,080 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,081 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,082 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,083 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,085 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,086 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,087 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,089 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,090 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,091 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,093 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,095 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,096 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,097 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,099 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,100 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,101 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,103 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,104 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,105 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,106 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,108 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,109 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,110 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,112 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,113 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,114 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,116 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,117 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,118 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,120 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,121 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,122 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,124 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,125 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,126 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,127 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,129 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,130 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,131 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,133 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,134 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,135 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,137 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,138 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,139 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,140 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,142 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,143 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,144 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,145 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,147 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,148 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,149 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,151 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,152 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,153 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 990.15, Avg Reward: 992.98, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:12,154 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,155 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,157 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,158 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,160 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,161 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,162 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,163 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,165 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,166 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,167 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,169 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,170 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,172 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,173 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,175 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,176 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,177 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,179 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,180 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,181 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,183 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,184 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,185 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,187 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,188 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,189 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,190 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,192 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,194 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,196 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,197 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,200 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,202 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,203 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,204 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,206 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,208 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,210 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,211 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,214 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,215 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,217 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,218 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,219 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,221 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,222 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,223 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,225 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,226 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,227 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,229 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,230 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,231 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,233 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,234 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,236 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,237 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,238 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,240 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,241 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,242 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,244 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,245 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,246 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,249 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,251 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,252 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,253 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,255 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,259 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,260 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,262 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,263 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,264 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,266 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,268 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,269 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,270 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,272 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,273 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,277 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,279 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,280 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,281 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,282 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,285 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,287 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,288 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,291 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,294 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,297 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,298 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,301 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,303 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,304 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,306 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,307 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,308 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,310 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,311 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,313 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,314 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,315 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,317 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,320 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,321 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,322 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,324 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,325 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,326 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,328 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,330 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,334 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,337 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,339 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,340 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,343 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,345 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,347 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,348 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,349 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,351 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,352 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,353 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,355 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,356 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,357 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,359 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,360 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,362 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,363 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,364 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,366 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,367 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,369 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,372 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,375 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,377 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,381 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,384 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,388 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,390 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,393 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,398 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,402 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,406 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,409 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,411 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,413 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,414 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,416 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,418 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,419 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,424 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,425 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,426 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,428 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,429 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,431 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,432 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,433 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,435 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,436 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,437 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,438 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,440 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,441 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,442 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,444 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,445 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,447 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,448 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,449 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,451 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,452 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,453 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,454 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,455 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 995.10, Avg Reward: 993.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:12,456 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,457 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,459 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,460 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,461 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,463 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,464 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,466 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,467 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,469 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,470 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,471 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,473 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,474 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,475 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,477 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,478 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,480 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,481 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,482 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,484 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,485 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,486 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,488 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,489 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,490 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,492 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,493 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,494 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,495 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,497 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,498 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,500 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,501 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,502 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,504 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,505 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,507 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,508 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,509 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,511 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,512 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,513 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,514 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,516 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,517 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,519 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,520 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,521 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,523 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,524 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,525 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,527 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,528 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,529 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,530 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,532 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,533 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,534 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,535 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,537 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,538 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,539 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,540 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,542 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,543 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,544 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,545 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,546 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,548 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,549 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,551 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,552 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,553 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,554 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,556 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,557 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,558 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,560 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,561 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,562 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,563 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,565 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,566 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,568 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,569 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,571 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,572 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,574 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,575 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,576 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,578 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,579 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,580 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,581 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,583 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,584 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,586 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,587 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,588 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,590 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,591 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,593 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,594 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,595 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,597 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,598 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,599 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,601 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,602 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,603 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,605 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,606 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,607 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,608 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,610 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,611 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,612 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,613 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,615 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,616 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,617 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,618 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,620 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,621 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,623 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,624 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,625 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,627 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,628 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,629 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,630 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,632 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,634 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,635 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,637 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,638 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,639 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,641 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,642 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,644 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,645 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,646 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,647 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,649 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,650 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,651 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,653 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,654 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,655 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,657 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,658 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,659 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,661 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,662 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,664 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,665 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,666 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,668 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,669 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,671 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,672 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,673 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,675 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,676 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,678 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,679 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,680 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,682 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,683 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,684 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,686 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,687 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,688 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,689 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,691 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,692 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,693 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,695 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,696 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,698 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,699 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,700 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,702 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,703 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,705 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,706 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,707 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,709 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,710 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,711 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,713 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,714 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,715 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,716 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,718 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,719 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,720 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,722 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,723 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,723 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 993.82, Avg Reward: 993.21, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:12,725 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,726 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,728 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,729 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,730 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,732 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,733 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,734 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,736 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,737 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,739 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,740 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,741 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,743 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,744 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,745 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,746 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,748 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,749 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,751 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,752 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,753 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,755 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,756 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,757 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,759 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,760 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,762 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,763 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,764 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,766 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,767 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,768 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,769 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,771 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,772 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,773 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,774 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,776 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,777 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,779 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,780 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,781 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,783 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,784 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,785 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,787 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,788 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,789 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,791 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,792 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,794 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,795 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,796 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,797 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,799 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,800 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,801 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,803 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,804 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,805 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,807 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,808 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,809 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,811 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,812 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,813 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,814 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,816 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,817 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,818 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,819 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,821 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,822 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,823 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,824 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,826 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,827 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,828 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,830 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,831 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,832 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,834 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,835 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,836 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,838 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,839 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,841 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,842 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,844 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,845 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,847 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,848 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,849 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,851 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,852 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,853 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,855 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,856 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,857 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,859 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,860 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,861 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,863 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,864 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,865 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,866 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,868 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,869 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,870 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,872 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,873 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,874 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,876 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,877 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,879 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,880 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,881 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,883 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,884 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,885 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,887 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,891 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,892 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,893 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,895 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,896 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,897 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,898 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,900 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,901 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,902 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,904 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,905 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,906 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,908 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,909 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,910 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,912 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,913 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,915 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,916 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,917 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,919 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,920 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,921 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,923 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,924 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,925 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,927 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,928 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,929 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,930 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,932 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,933 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,934 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,936 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,937 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,938 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,940 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,943 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,944 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,946 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,947 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,948 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,950 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,951 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,952 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,954 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,955 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,956 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,957 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,959 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,960 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,962 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,963 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,964 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,966 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,967 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,968 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,970 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,971 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,973 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,974 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,975 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,977 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,978 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,979 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,980 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,982 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,983 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,984 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,985 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,987 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,988 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,989 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,990 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,992 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,993 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,995 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,995 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 986.98, Avg Reward: 992.76, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:12,996 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,997 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:12,999 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,000 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,002 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,004 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,005 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,006 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,008 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,009 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,010 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,012 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,013 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,014 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,015 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,017 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,018 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,020 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,021 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,022 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,024 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,025 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,027 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,028 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,030 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,031 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,032 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,034 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,035 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,036 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,038 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,039 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,040 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,041 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,043 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,044 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,045 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,046 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,048 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,049 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,050 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,052 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,053 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,055 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,056 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,057 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,059 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,060 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,061 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,063 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,064 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,065 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,066 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,068 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,069 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,070 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,071 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,073 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,074 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,075 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,077 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,078 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,079 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,081 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,082 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,084 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,085 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,087 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,088 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,090 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,092 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,093 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,094 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,096 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,098 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,099 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,100 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,101 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,103 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,104 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,105 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,106 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,108 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,109 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,110 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,112 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,113 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,114 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,115 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,116 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,118 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,119 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,121 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,122 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,123 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,125 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,126 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,127 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,128 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,130 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,131 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,132 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,133 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,135 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,136 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,138 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,139 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,141 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,144 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,145 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,147 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,148 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,149 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,151 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,152 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,153 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,155 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,156 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,158 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,159 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,161 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,162 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,164 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,165 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,166 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,168 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,169 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,171 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,172 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,174 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,175 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,176 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,178 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,179 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,181 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,182 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,183 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,185 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,186 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,188 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,189 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,190 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,192 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,194 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,195 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,197 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,199 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,201 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,202 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,203 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,205 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,206 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,209 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,210 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,211 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,214 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,215 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,217 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,218 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,219 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,221 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,222 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,223 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,224 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,226 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,227 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,229 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,230 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,231 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,233 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,234 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,235 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,236 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,238 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,239 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,240 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,241 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,242 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,244 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,245 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,246 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,249 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,251 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,252 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,253 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,254 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,257 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,259 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,261 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,262 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,264 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,265 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,266 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,266 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 993.18, Avg Reward: 992.79, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:13,268 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,269 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,271 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,272 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,273 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,277 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,278 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,280 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,281 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,282 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,285 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,286 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,288 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,294 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,297 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,299 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,301 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,302 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,304 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,305 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,306 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,308 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,309 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,310 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,312 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,313 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,314 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,316 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,317 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,320 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,321 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,322 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,324 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,325 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,326 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,327 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,330 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,335 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,337 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,339 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,340 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,343 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,345 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,347 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,348 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,349 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,351 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,352 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,353 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,355 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,356 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,357 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,358 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,360 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,361 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,362 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,364 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,365 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,366 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,367 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,369 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,370 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,372 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,373 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,374 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,376 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,377 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,378 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,379 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,381 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,382 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,383 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,385 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,386 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,387 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,389 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,390 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,391 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,393 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,394 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,395 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,397 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,398 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,399 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,400 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,402 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,403 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,404 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,406 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,407 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,408 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,409 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,411 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,412 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,413 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,414 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,416 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,417 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,419 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,420 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,422 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,423 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,424 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,426 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,427 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,429 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,430 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,431 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,433 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,434 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,435 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,437 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,438 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,440 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,441 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,442 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,444 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,445 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,446 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,447 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,449 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,450 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,451 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,453 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,454 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,455 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,457 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,458 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,459 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,460 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,462 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,463 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,464 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,466 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,467 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,468 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,470 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,471 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,472 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,473 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,475 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,476 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,477 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,479 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,480 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,481 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,483 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,484 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,486 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,487 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,488 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,490 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,492 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,493 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,494 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,496 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,497 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,498 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,499 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,501 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,502 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,503 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,505 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,506 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,508 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,510 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,511 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,513 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,514 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,515 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,517 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,518 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,519 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,520 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,522 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,523 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,524 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,526 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,527 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,529 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,530 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,532 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,533 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,534 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,535 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,535 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 994.36, Avg Reward: 992.89, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:13,537 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,538 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,540 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,541 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,542 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,543 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,545 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,546 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,547 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,549 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,550 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,551 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,553 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,554 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,555 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,561 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,564 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,567 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,573 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,576 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,580 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,585 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,588 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,591 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,594 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,596 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,597 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,598 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,601 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,604 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,609 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,611 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,612 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,613 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,615 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,616 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,617 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,619 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,620 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,621 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,623 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,625 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,626 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,628 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,629 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,630 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,632 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,633 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,635 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,636 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,637 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,639 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,640 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,641 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,643 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,644 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,645 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,647 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,648 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,650 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,651 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,652 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,654 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,655 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,656 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,657 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,659 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,660 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,661 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,663 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,664 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,666 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,667 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,668 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,670 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,671 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,672 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,673 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,675 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,676 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,677 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,679 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,680 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,681 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,683 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,684 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,686 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,687 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,688 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,689 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,691 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,692 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,693 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,695 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,696 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,697 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,699 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,701 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,703 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,704 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,705 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,707 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,708 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,709 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,710 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,712 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,713 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,715 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,716 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,717 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,719 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,720 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,721 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,723 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,724 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,725 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,727 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,728 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,729 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,731 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,732 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,733 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,735 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,736 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,737 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,738 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,740 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,741 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,742 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,744 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,745 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,746 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,747 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,749 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,750 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,751 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,753 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,754 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,756 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,757 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,759 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,760 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,761 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,763 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,764 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,766 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,767 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,769 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,770 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,772 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,773 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,774 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,776 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,777 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,778 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,779 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,781 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,782 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,783 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,785 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,786 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,787 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,788 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,790 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,791 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,792 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,794 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,795 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,797 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,798 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,800 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,801 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,802 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,803 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,805 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,806 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,808 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,810 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,812 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,813 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,814 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,816 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,817 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,819 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,820 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,821 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,823 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,824 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,825 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,827 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,828 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,830 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,831 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,832 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,834 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,835 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,837 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,838 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,839 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,841 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,841 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 995.24, Avg Reward: 993.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:13,842 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,844 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,845 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,846 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,848 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,849 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,851 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,852 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,853 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,855 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,856 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,857 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,859 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,860 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,861 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,863 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,864 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,865 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,867 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,868 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,870 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,871 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,872 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,874 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,876 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,877 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,878 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,880 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,881 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,882 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,884 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,885 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,886 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,888 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,889 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,890 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,891 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,893 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,894 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,895 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,897 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,898 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,900 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,901 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,902 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,904 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,905 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,906 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,908 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,909 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,911 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,912 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,913 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,915 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,916 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,917 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,919 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,920 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,921 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,923 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,924 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,926 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,927 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,928 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,930 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,931 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,932 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,934 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,935 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,936 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,937 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,939 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,940 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,941 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,942 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,944 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,945 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,947 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,948 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,949 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,951 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,952 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,953 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,955 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,956 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,957 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,959 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,960 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,961 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,962 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,964 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,965 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,966 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,967 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,969 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,970 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,971 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,972 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,974 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,975 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,976 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,978 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,979 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,980 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,981 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,983 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,984 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,986 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,987 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,988 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,990 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,991 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,992 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,994 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,996 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,997 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:13,998 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,000 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,001 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,003 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,004 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,005 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,006 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,008 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,009 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,010 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,011 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,013 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,014 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,015 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,017 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,018 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,020 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,021 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,022 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,024 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,025 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,026 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,028 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,029 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,031 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,032 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,034 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,035 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,037 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,038 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,039 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,041 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,042 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,044 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,045 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,047 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,048 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,049 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,051 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,052 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,054 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,055 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,057 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,058 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,059 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,061 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,062 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,064 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,065 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,067 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,068 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,070 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,071 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,072 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,073 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,075 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,076 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,077 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,078 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,080 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,081 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,082 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,083 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,085 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,086 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,088 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,089 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,090 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,091 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,093 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,094 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,095 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,097 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,098 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,099 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,100 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,102 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,103 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,104 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,105 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,107 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,108 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,109 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,111 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,111 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 994.49, Avg Reward: 993.11, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:14,112 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,113 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,115 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,116 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,117 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,119 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,120 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,122 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,123 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,125 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,126 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,128 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,129 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,131 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,132 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,133 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,135 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,136 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,138 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,139 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,140 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,142 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,143 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,145 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,146 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,147 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,149 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,150 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,152 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,153 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,154 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,156 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,157 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,159 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,160 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,162 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,163 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,164 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,166 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,167 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,169 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,170 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,171 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,173 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,174 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,175 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,177 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,178 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,179 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,180 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,182 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,183 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,184 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,186 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,187 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,189 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,190 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,192 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,193 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,194 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,197 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,198 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,199 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,201 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,202 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,203 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,205 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,206 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,207 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,209 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,210 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,212 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,213 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,214 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,215 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,217 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,218 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,219 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,220 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,222 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,223 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,225 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,226 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,227 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,229 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,230 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,232 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,233 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,234 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,236 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,237 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,239 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,240 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,241 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,243 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,244 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,246 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,247 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,248 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,250 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,251 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,252 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,254 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,255 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,256 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,258 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,259 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,261 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,262 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,263 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,265 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,266 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,268 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,270 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,271 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,272 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,274 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,275 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,276 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,278 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,279 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,281 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,282 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,284 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,285 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,286 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,288 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,289 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,290 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,292 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,293 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,295 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,296 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,298 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,299 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,300 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,301 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,303 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,304 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,305 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,306 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,308 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,309 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,311 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,312 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,313 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,315 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,316 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,317 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,318 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,320 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,321 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,322 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,324 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,326 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,328 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,329 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,331 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,332 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,333 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,335 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,336 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,337 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,338 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,340 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,341 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,342 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,344 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,345 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,346 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,348 - TrafficRL.Agent - ERROR - Error in learn() method: name 'F' is not defined
2025-03-17 17:26:14,686 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 993.93, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:17,605 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 994.46, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:20,532 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 989.88, Avg Reward: 992.97, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:23,463 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 989.17, Avg Reward: 992.91, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:26,462 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 984.80, Avg Reward: 992.80, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:29,250 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 991.55, Avg Reward: 992.82, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:32,068 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 992.04, Avg Reward: 992.83, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:32,079 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_250.pth
2025-03-17 17:26:32,080 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-17 17:26:35,025 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 987.78, Avg Reward: 992.78, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:37,884 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 988.23, Avg Reward: 992.72, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:41,017 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 993.38, Avg Reward: 992.70, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:41,665 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:26:41,666 - TrafficRL.Config - ERROR - Error loading configuration from configs/simple_dqn_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:26:41,666 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:26:41,666 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:26:41,666 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-17 17:26:41,666 - TrafficRL - INFO - Starting training with simple_dqn agent...
2025-03-17 17:26:41,667 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:26:42,488 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:42,893 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 974.08, Avg Reward: 983.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:43,226 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 969.67, Avg Reward: 979.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:43,551 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 865.59, Avg Reward: 950.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:43,881 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 843.29, Avg Reward: 929.20, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:44,203 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 802.32, Avg Reward: 908.05, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:44,321 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 987.60, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:44,531 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 876.73, Avg Reward: 903.58, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:44,869 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 993.87, Avg Reward: 914.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:45,213 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 972.21, Avg Reward: 921.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:45,552 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 973.94, Avg Reward: 926.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:45,878 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 950.31, Avg Reward: 928.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:46,209 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 963.65, Avg Reward: 931.58, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:46,537 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 989.57, Avg Reward: 936.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:46,869 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 983.54, Avg Reward: 939.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:47,212 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 995.15, Avg Reward: 943.15, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:47,550 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 988.64, Avg Reward: 945.99, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:47,670 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 990.94, Avg Reward: 992.60, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:47,887 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 994.90, Avg Reward: 948.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:48,227 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 987.83, Avg Reward: 951.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:48,560 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 989.15, Avg Reward: 953.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:48,892 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 991.15, Avg Reward: 954.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:48,892 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-17 17:26:49,781 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 166125.06
2025-03-17 17:26:49,783 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-17 17:26:49,783 - TrafficRL.Train - INFO - New best model saved with reward: 166125.06
2025-03-17 17:26:50,132 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 994.15, Avg Reward: 956.81, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:50,472 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 988.09, Avg Reward: 958.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:50,799 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 991.33, Avg Reward: 959.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:50,933 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 991.15, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:51,132 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 987.63, Avg Reward: 960.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:51,470 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 995.88, Avg Reward: 962.24, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:51,474 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_25.pth
2025-03-17 17:26:51,474 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-17 17:26:51,826 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 983.79, Avg Reward: 963.07, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:52,246 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 986.16, Avg Reward: 963.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:52,631 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 989.83, Avg Reward: 964.85, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:52,967 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 990.69, Avg Reward: 965.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:53,303 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 996.59, Avg Reward: 966.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:53,640 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 988.97, Avg Reward: 967.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:53,987 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 990.33, Avg Reward: 968.20, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:54,343 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 992.05, Avg Reward: 968.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:54,351 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 988.73, Avg Reward: 992.54, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:54,687 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 984.00, Avg Reward: 969.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:55,026 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 985.54, Avg Reward: 969.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:55,364 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 990.97, Avg Reward: 970.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:55,703 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 978.37, Avg Reward: 970.63, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:56,047 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 980.06, Avg Reward: 970.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:56,393 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 995.90, Avg Reward: 971.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:56,740 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 965.59, Avg Reward: 971.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:56,740 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-17 17:26:57,583 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 993.39, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:26:57,623 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 6402.15
2025-03-17 17:26:57,623 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:26:57,984 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 655.78, Avg Reward: 963.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:58,334 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 915.35, Avg Reward: 962.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:58,670 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 964.28, Avg Reward: 962.56, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:59,006 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 986.87, Avg Reward: 963.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:59,346 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 985.43, Avg Reward: 963.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:26:59,695 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 995.09, Avg Reward: 964.30, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:00,047 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 985.62, Avg Reward: 964.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:00,398 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 982.45, Avg Reward: 965.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:00,741 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 972.29, Avg Reward: 965.27, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:00,986 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 994.60, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:01,112 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 992.01, Avg Reward: 965.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:01,116 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_50.pth
2025-03-17 17:27:01,116 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-17 17:27:01,456 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 988.54, Avg Reward: 966.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:01,794 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 985.58, Avg Reward: 966.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:02,146 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 987.87, Avg Reward: 967.02, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:02,505 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 994.79, Avg Reward: 967.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:02,856 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 985.46, Avg Reward: 967.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:03,197 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 995.57, Avg Reward: 968.35, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:03,535 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 987.28, Avg Reward: 968.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:03,872 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 983.95, Avg Reward: 968.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:04,217 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 988.34, Avg Reward: 969.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:04,323 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 993.94, Avg Reward: 992.59, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:04,323 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-17 17:27:04,565 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 995.73, Avg Reward: 969.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:04,565 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-17 17:27:05,446 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 117171.64
2025-03-17 17:27:05,446 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:27:05,644 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 559163.98
2025-03-17 17:27:05,645 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:27:05,789 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 985.28, Avg Reward: 969.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:06,148 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.21, Avg Reward: 970.35, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:06,513 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 985.43, Avg Reward: 970.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:06,867 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 991.50, Avg Reward: 970.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:07,214 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 984.65, Avg Reward: 971.13, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:07,553 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 992.13, Avg Reward: 971.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:07,897 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 992.37, Avg Reward: 971.76, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:08,246 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 983.85, Avg Reward: 971.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:08,602 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 994.52, Avg Reward: 972.26, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:08,959 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 984.68, Avg Reward: 972.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:08,989 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 991.64, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:09,315 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 987.38, Avg Reward: 972.65, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:09,664 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 985.18, Avg Reward: 972.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:10,011 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 984.92, Avg Reward: 972.99, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:10,354 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 985.40, Avg Reward: 973.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:10,711 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 992.40, Avg Reward: 973.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:10,714 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_75.pth
2025-03-17 17:27:10,714 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-17 17:27:11,069 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 990.90, Avg Reward: 973.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:11,453 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 973.94, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:11,805 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 973.51, Avg Reward: 973.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:12,152 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 988.32, Avg Reward: 974.11, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:12,364 - TrafficRL.Train - INFO - Episode 262/500 - Reward: 994.99, Avg Reward: 992.58, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:12,503 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 987.13, Avg Reward: 974.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:12,504 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-17 17:27:13,397 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147129.04
2025-03-17 17:27:13,397 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:27:13,767 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 992.98, Avg Reward: 974.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:14,140 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 988.14, Avg Reward: 974.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:14,505 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 990.70, Avg Reward: 974.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:14,864 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 982.44, Avg Reward: 974.96, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:15,232 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 982.21, Avg Reward: 975.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:15,593 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 962.55, Avg Reward: 974.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:15,661 - TrafficRL.Train - INFO - Episode 263/500 - Reward: 990.36, Avg Reward: 992.54, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:15,951 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 990.00, Avg Reward: 975.07, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:16,312 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 985.34, Avg Reward: 975.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:16,690 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 979.00, Avg Reward: 975.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:17,058 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 966.15, Avg Reward: 975.13, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:17,424 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 984.71, Avg Reward: 975.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:17,787 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 986.75, Avg Reward: 975.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:18,141 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 993.40, Avg Reward: 975.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:18,489 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 985.30, Avg Reward: 975.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:18,851 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 992.59, Avg Reward: 975.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:19,054 - TrafficRL.Train - INFO - Episode 264/500 - Reward: 993.10, Avg Reward: 992.55, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:19,214 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 984.62, Avg Reward: 975.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:19,576 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 988.81, Avg Reward: 976.06, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:19,935 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 984.62, Avg Reward: 976.15, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:20,288 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 979.18, Avg Reward: 976.18, LR: 0.000300, Traffic: uniform
2025-03-17 17:27:20,289 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-17 17:27:20,636 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 990.75, Avg Reward: 976.32, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:20,636 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-17 17:27:21,534 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 156290.54
2025-03-17 17:27:21,535 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:27:21,539 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_100.pth
2025-03-17 17:27:21,539 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-17 17:27:21,903 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 993.92, Avg Reward: 976.33, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:22,264 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 986.48, Avg Reward: 976.45, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:22,371 - TrafficRL.Train - INFO - Episode 265/500 - Reward: 991.03, Avg Reward: 992.49, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:22,630 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 996.08, Avg Reward: 976.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:22,997 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 992.06, Avg Reward: 977.98, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:23,362 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 990.75, Avg Reward: 979.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:23,720 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 996.45, Avg Reward: 981.40, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:24,078 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 990.63, Avg Reward: 982.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:24,428 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 992.64, Avg Reward: 982.52, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:24,767 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 993.13, Avg Reward: 982.73, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:25,118 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 991.96, Avg Reward: 982.91, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:25,469 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 994.47, Avg Reward: 983.36, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:25,726 - TrafficRL.Train - INFO - Episode 266/500 - Reward: 995.17, Avg Reward: 992.48, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:25,825 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 995.95, Avg Reward: 983.68, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:26,185 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 993.63, Avg Reward: 983.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:26,537 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 992.43, Avg Reward: 983.81, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:26,882 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 994.52, Avg Reward: 983.80, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:27,226 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 983.47, Avg Reward: 983.75, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:27,561 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 987.36, Avg Reward: 983.67, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:27,915 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 988.93, Avg Reward: 983.69, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:28,278 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 992.66, Avg Reward: 983.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:28,633 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 995.55, Avg Reward: 983.76, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:28,634 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-17 17:27:29,028 - TrafficRL.Train - INFO - Episode 267/500 - Reward: 994.13, Avg Reward: 992.47, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:29,513 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 307742.13
2025-03-17 17:27:29,517 - TrafficRL.Agent - INFO - Model saved to results/training/best_model.pth
2025-03-17 17:27:29,517 - TrafficRL.Train - INFO - New best model saved with reward: 307742.13
2025-03-17 17:27:29,913 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 996.36, Avg Reward: 983.79, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:30,266 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 995.68, Avg Reward: 983.86, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:30,608 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 993.45, Avg Reward: 983.88, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:30,959 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 991.03, Avg Reward: 983.92, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:31,307 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 991.32, Avg Reward: 983.87, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:31,312 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_125.pth
2025-03-17 17:27:31,312 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-17 17:27:31,672 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 993.61, Avg Reward: 983.97, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:32,033 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 995.18, Avg Reward: 984.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:32,332 - TrafficRL.Train - INFO - Episode 268/500 - Reward: 996.95, Avg Reward: 992.49, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:32,396 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 995.32, Avg Reward: 984.12, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:32,745 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 988.02, Avg Reward: 984.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:33,094 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 996.09, Avg Reward: 984.08, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:33,436 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 991.94, Avg Reward: 984.11, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:33,793 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 987.59, Avg Reward: 984.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:34,149 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 993.69, Avg Reward: 984.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:34,503 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 991.23, Avg Reward: 984.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:34,852 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 996.00, Avg Reward: 984.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:35,197 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 993.06, Avg Reward: 984.30, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:35,538 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 986.76, Avg Reward: 984.38, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:35,676 - TrafficRL.Train - INFO - Episode 269/500 - Reward: 991.33, Avg Reward: 992.47, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:35,889 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 992.77, Avg Reward: 984.51, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:36,254 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 988.34, Avg Reward: 984.44, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:36,614 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 994.57, Avg Reward: 984.73, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:36,614 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-17 17:27:37,485 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 58479.78
2025-03-17 17:27:37,485 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:27:37,850 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 993.06, Avg Reward: 988.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:38,212 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 994.99, Avg Reward: 988.89, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:38,575 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 991.79, Avg Reward: 989.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:38,935 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 991.10, Avg Reward: 989.21, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:38,958 - TrafficRL.Train - INFO - Episode 270/500 - Reward: 992.64, Avg Reward: 992.44, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:39,290 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 992.28, Avg Reward: 989.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:39,644 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 989.77, Avg Reward: 989.23, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:40,039 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 992.75, Avg Reward: 989.30, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:40,399 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 990.84, Avg Reward: 989.38, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:40,751 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 988.37, Avg Reward: 989.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:41,121 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 995.68, Avg Reward: 989.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:41,127 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_150.pth
2025-03-17 17:27:41,127 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-17 17:27:41,477 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 996.35, Avg Reward: 989.66, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:41,834 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.30, Avg Reward: 989.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:42,195 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 988.55, Avg Reward: 989.75, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:42,399 - TrafficRL.Train - INFO - Episode 271/500 - Reward: 992.21, Avg Reward: 992.45, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:42,555 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 987.60, Avg Reward: 989.68, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:42,911 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 994.75, Avg Reward: 989.77, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:43,264 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 987.91, Avg Reward: 989.70, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:43,614 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 992.04, Avg Reward: 989.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:43,961 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 996.04, Avg Reward: 989.86, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:44,323 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 991.82, Avg Reward: 989.90, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:44,681 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 994.43, Avg Reward: 989.89, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:44,682 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-17 17:27:45,558 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 46257.14
2025-03-17 17:27:45,558 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:27:45,672 - TrafficRL.Train - INFO - Episode 272/500 - Reward: 986.70, Avg Reward: 992.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:45,928 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 994.41, Avg Reward: 989.98, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:46,300 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 991.82, Avg Reward: 989.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:46,674 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 995.07, Avg Reward: 990.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:47,038 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 994.61, Avg Reward: 990.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:47,431 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 982.06, Avg Reward: 990.07, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:47,777 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 989.72, Avg Reward: 990.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:48,115 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 989.53, Avg Reward: 990.01, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:48,460 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 995.15, Avg Reward: 990.13, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:48,816 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 992.36, Avg Reward: 990.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:49,056 - TrafficRL.Train - INFO - Episode 273/500 - Reward: 996.44, Avg Reward: 992.39, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:49,177 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 990.21, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:49,536 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 995.39, Avg Reward: 990.29, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:49,889 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 990.88, Avg Reward: 990.34, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:50,234 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.69, Avg Reward: 990.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:50,577 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 990.09, Avg Reward: 990.48, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:50,921 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 994.46, Avg Reward: 990.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:50,928 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_175.pth
2025-03-17 17:27:50,928 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-17 17:27:51,289 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 990.72, Avg Reward: 990.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:51,648 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 986.36, Avg Reward: 990.40, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:52,002 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 987.82, Avg Reward: 990.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:52,354 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 992.84, Avg Reward: 990.59, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:52,394 - TrafficRL.Train - INFO - Episode 274/500 - Reward: 992.79, Avg Reward: 992.36, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:52,703 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 993.69, Avg Reward: 990.65, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:52,703 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-17 17:27:53,572 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 50514.73
2025-03-17 17:27:53,572 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:27:53,939 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 986.52, Avg Reward: 990.59, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:54,297 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 994.98, Avg Reward: 990.66, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:54,660 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 995.57, Avg Reward: 990.71, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:55,022 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 995.29, Avg Reward: 990.83, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:55,384 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 993.15, Avg Reward: 990.94, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:55,710 - TrafficRL.Train - INFO - Episode 275/500 - Reward: 992.49, Avg Reward: 992.34, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:55,725 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_275.pth
2025-03-17 17:27:55,726 - TrafficRL.Train - INFO - Model checkpoint saved at episode 275
2025-03-17 17:27:55,741 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 996.26, Avg Reward: 991.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:56,101 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 995.32, Avg Reward: 991.33, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:56,463 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 993.22, Avg Reward: 991.41, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:56,818 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 994.53, Avg Reward: 991.57, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:57,200 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 994.20, Avg Reward: 991.85, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:57,545 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 996.13, Avg Reward: 991.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:57,896 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 987.48, Avg Reward: 991.97, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:58,256 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 992.62, Avg Reward: 991.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:58,612 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 992.00, Avg Reward: 992.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:58,965 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 992.57, Avg Reward: 992.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:59,131 - TrafficRL.Train - INFO - Episode 276/500 - Reward: 994.36, Avg Reward: 992.33, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:27:59,311 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 994.63, Avg Reward: 992.13, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:59,656 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 995.85, Avg Reward: 992.20, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:27:59,995 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 995.79, Avg Reward: 992.31, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:28:00,351 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 989.91, Avg Reward: 992.42, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:28:00,352 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-17 17:28:00,720 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 985.91, Avg Reward: 992.37, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:00,720 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-17 17:28:01,620 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 151384.30
2025-03-17 17:28:01,620 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:28:01,627 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_200.pth
2025-03-17 17:28:01,627 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-17 17:28:01,999 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 990.66, Avg Reward: 992.34, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:02,358 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 990.34, Avg Reward: 992.38, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:02,396 - TrafficRL.Train - INFO - Episode 277/500 - Reward: 994.78, Avg Reward: 992.31, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:02,722 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 987.87, Avg Reward: 992.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:03,086 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 988.37, Avg Reward: 992.26, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:03,450 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 989.40, Avg Reward: 992.24, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:03,804 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 874.47, Avg Reward: 991.02, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:04,159 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 716.83, Avg Reward: 988.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:04,514 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 894.77, Avg Reward: 987.31, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:04,867 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 952.38, Avg Reward: 986.90, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:05,234 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 990.61, Avg Reward: 986.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:05,596 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 674.67, Avg Reward: 983.69, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:05,778 - TrafficRL.Train - INFO - Episode 278/500 - Reward: 991.89, Avg Reward: 992.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:05,954 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 985.05, Avg Reward: 983.58, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:06,310 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 980.45, Avg Reward: 983.45, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:06,656 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 987.11, Avg Reward: 983.39, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:07,011 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 988.33, Avg Reward: 983.33, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:07,371 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 990.27, Avg Reward: 983.40, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:07,762 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 976.90, Avg Reward: 983.30, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:08,124 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 977.55, Avg Reward: 983.18, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:08,482 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 976.75, Avg Reward: 983.02, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:08,836 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 981.85, Avg Reward: 982.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:08,836 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-17 17:28:09,137 - TrafficRL.Train - INFO - Episode 279/500 - Reward: 994.38, Avg Reward: 992.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:09,743 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 133598.44
2025-03-17 17:28:09,743 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-17 17:28:10,115 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 976.79, Avg Reward: 982.69, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:10,474 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 974.69, Avg Reward: 982.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:10,828 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 962.41, Avg Reward: 982.17, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:11,178 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 964.15, Avg Reward: 981.90, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:11,528 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 981.57, Avg Reward: 981.80, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:11,536 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_225.pth
2025-03-17 17:28:11,536 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-17 17:28:11,902 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 980.91, Avg Reward: 981.68, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:12,264 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 634.63, Avg Reward: 978.07, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:12,410 - TrafficRL.Train - INFO - Episode 280/500 - Reward: 993.73, Avg Reward: 992.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:12,410 - TrafficRL.Train - INFO - Evaluating agent at episode 280...
2025-03-17 17:28:12,623 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 984.70, Avg Reward: 977.96, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:12,971 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 969.16, Avg Reward: 977.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:13,318 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 991.84, Avg Reward: 977.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:13,660 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 979.63, Avg Reward: 977.61, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:13,774 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 559568.97
2025-03-17 17:28:13,774 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:28:14,014 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 988.79, Avg Reward: 977.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:14,376 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 994.02, Avg Reward: 977.63, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:14,752 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 988.75, Avg Reward: 977.60, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:15,123 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 984.14, Avg Reward: 977.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:15,497 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 977.05, Avg Reward: 977.32, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:15,868 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 975.28, Avg Reward: 977.21, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:16,237 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 961.03, Avg Reward: 976.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:16,604 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 976.87, Avg Reward: 976.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:16,965 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 965.67, Avg Reward: 976.49, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:16,965 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-17 17:28:17,192 - TrafficRL.Train - INFO - Episode 281/500 - Reward: 986.65, Avg Reward: 992.17, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:17,866 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147883.08
2025-03-17 17:28:17,867 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-17 17:28:18,269 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 982.87, Avg Reward: 976.38, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:18,630 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 993.71, Avg Reward: 976.37, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:18,978 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 535.70, Avg Reward: 971.81, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:19,329 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 976.90, Avg Reward: 971.67, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:19,687 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 975.90, Avg Reward: 971.51, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:20,049 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 981.11, Avg Reward: 971.42, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:20,421 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 980.00, Avg Reward: 971.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:20,484 - TrafficRL.Train - INFO - Episode 282/500 - Reward: 994.18, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:20,784 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 966.69, Avg Reward: 971.05, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:21,134 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 989.75, Avg Reward: 971.06, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:21,483 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 981.32, Avg Reward: 970.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:21,492 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_250.pth
2025-03-17 17:28:21,492 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-17 17:28:21,839 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 983.02, Avg Reward: 970.79, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:22,202 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 977.46, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:22,570 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 985.36, Avg Reward: 970.59, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:22,940 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 995.46, Avg Reward: 970.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:23,303 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 990.13, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:23,659 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 987.78, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:23,861 - TrafficRL.Train - INFO - Episode 283/500 - Reward: 994.22, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:24,012 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 993.34, Avg Reward: 970.63, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:24,366 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 987.18, Avg Reward: 970.54, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:24,727 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 993.54, Avg Reward: 970.56, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:25,090 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 966.16, Avg Reward: 970.28, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:25,090 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-17 17:28:26,027 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 277408.12
2025-03-17 17:28:26,027 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-17 17:28:26,400 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 977.87, Avg Reward: 970.11, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:26,771 - TrafficRL.Train - INFO - Episode 262/500 - Reward: 964.65, Avg Reward: 969.84, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:27,145 - TrafficRL.Train - INFO - Episode 263/500 - Reward: 989.40, Avg Reward: 969.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:27,155 - TrafficRL.Train - INFO - Episode 284/500 - Reward: 989.35, Avg Reward: 992.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:27,507 - TrafficRL.Train - INFO - Episode 264/500 - Reward: 982.13, Avg Reward: 969.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:27,868 - TrafficRL.Train - INFO - Episode 265/500 - Reward: 984.46, Avg Reward: 969.68, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:28,219 - TrafficRL.Train - INFO - Episode 266/500 - Reward: 974.38, Avg Reward: 969.53, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:28,566 - TrafficRL.Train - INFO - Episode 267/500 - Reward: 979.32, Avg Reward: 969.43, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:28,919 - TrafficRL.Train - INFO - Episode 268/500 - Reward: 965.16, Avg Reward: 969.13, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:29,281 - TrafficRL.Train - INFO - Episode 269/500 - Reward: 982.44, Avg Reward: 969.03, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:29,643 - TrafficRL.Train - INFO - Episode 270/500 - Reward: 992.93, Avg Reward: 969.01, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:30,008 - TrafficRL.Train - INFO - Episode 271/500 - Reward: 985.65, Avg Reward: 968.91, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:30,363 - TrafficRL.Train - INFO - Episode 272/500 - Reward: 995.42, Avg Reward: 968.96, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:30,493 - TrafficRL.Train - INFO - Episode 285/500 - Reward: 995.77, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:30,712 - TrafficRL.Train - INFO - Episode 273/500 - Reward: 922.82, Avg Reward: 968.25, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:31,067 - TrafficRL.Train - INFO - Episode 274/500 - Reward: 985.29, Avg Reward: 968.20, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:31,427 - TrafficRL.Train - INFO - Episode 275/500 - Reward: 982.89, Avg Reward: 968.08, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:31,438 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_275.pth
2025-03-17 17:28:31,438 - TrafficRL.Train - INFO - Model checkpoint saved at episode 275
2025-03-17 17:28:31,803 - TrafficRL.Train - INFO - Episode 276/500 - Reward: 985.10, Avg Reward: 968.03, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:32,172 - TrafficRL.Train - INFO - Episode 277/500 - Reward: 975.81, Avg Reward: 967.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:32,535 - TrafficRL.Train - INFO - Episode 278/500 - Reward: 986.66, Avg Reward: 967.91, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:32,886 - TrafficRL.Train - INFO - Episode 279/500 - Reward: 978.70, Avg Reward: 967.77, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:33,236 - TrafficRL.Train - INFO - Episode 280/500 - Reward: 982.32, Avg Reward: 967.65, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:33,237 - TrafficRL.Train - INFO - Evaluating agent at episode 280...
2025-03-17 17:28:33,766 - TrafficRL.Train - INFO - Episode 286/500 - Reward: 994.28, Avg Reward: 992.26, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:34,141 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 260368.81
2025-03-17 17:28:34,141 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-17 17:28:34,513 - TrafficRL.Train - INFO - Episode 281/500 - Reward: 994.22, Avg Reward: 967.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:34,886 - TrafficRL.Train - INFO - Episode 282/500 - Reward: 988.21, Avg Reward: 967.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:35,262 - TrafficRL.Train - INFO - Episode 283/500 - Reward: 986.71, Avg Reward: 967.58, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:35,631 - TrafficRL.Train - INFO - Episode 284/500 - Reward: 989.53, Avg Reward: 967.52, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:36,005 - TrafficRL.Train - INFO - Episode 285/500 - Reward: 971.00, Avg Reward: 967.30, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:36,376 - TrafficRL.Train - INFO - Episode 286/500 - Reward: 977.62, Avg Reward: 967.11, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:36,745 - TrafficRL.Train - INFO - Episode 287/500 - Reward: 978.10, Avg Reward: 966.94, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:37,118 - TrafficRL.Train - INFO - Episode 288/500 - Reward: 987.82, Avg Reward: 966.88, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:37,160 - TrafficRL.Train - INFO - Episode 287/500 - Reward: 994.53, Avg Reward: 992.27, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:37,490 - TrafficRL.Train - INFO - Episode 289/500 - Reward: 979.23, Avg Reward: 966.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:37,888 - TrafficRL.Train - INFO - Episode 290/500 - Reward: 986.58, Avg Reward: 966.65, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:38,251 - TrafficRL.Train - INFO - Episode 291/500 - Reward: 978.72, Avg Reward: 966.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:38,609 - TrafficRL.Train - INFO - Episode 292/500 - Reward: 974.48, Avg Reward: 966.35, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:38,963 - TrafficRL.Train - INFO - Episode 293/500 - Reward: 991.70, Avg Reward: 966.34, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:39,316 - TrafficRL.Train - INFO - Episode 294/500 - Reward: 963.52, Avg Reward: 966.06, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:39,680 - TrafficRL.Train - INFO - Episode 295/500 - Reward: 979.44, Avg Reward: 965.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:40,045 - TrafficRL.Train - INFO - Episode 296/500 - Reward: 979.59, Avg Reward: 965.77, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:40,409 - TrafficRL.Train - INFO - Episode 297/500 - Reward: 992.34, Avg Reward: 965.74, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:40,572 - TrafficRL.Train - INFO - Episode 288/500 - Reward: 991.03, Avg Reward: 992.23, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:40,766 - TrafficRL.Train - INFO - Episode 298/500 - Reward: 988.61, Avg Reward: 965.67, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:41,145 - TrafficRL.Train - INFO - Episode 299/500 - Reward: 989.48, Avg Reward: 965.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:28:41,145 - TrafficRL.Train - INFO - Switching to uniform traffic pattern at episode 300
2025-03-17 17:28:41,502 - TrafficRL.Train - INFO - Episode 300/500 - Reward: 986.19, Avg Reward: 965.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:41,502 - TrafficRL.Train - INFO - Evaluating agent at episode 300...
2025-03-17 17:28:42,399 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 111655.72
2025-03-17 17:28:42,400 - TrafficRL.Train - INFO - No improvement for 9 evaluations
2025-03-17 17:28:42,410 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_300.pth
2025-03-17 17:28:42,410 - TrafficRL.Train - INFO - Model checkpoint saved at episode 300
2025-03-17 17:28:42,783 - TrafficRL.Train - INFO - Episode 301/500 - Reward: 984.09, Avg Reward: 965.60, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:43,163 - TrafficRL.Train - INFO - Episode 302/500 - Reward: 994.03, Avg Reward: 965.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:43,538 - TrafficRL.Train - INFO - Episode 303/500 - Reward: 995.99, Avg Reward: 965.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:43,899 - TrafficRL.Train - INFO - Episode 304/500 - Reward: 991.54, Avg Reward: 965.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:43,923 - TrafficRL.Train - INFO - Episode 289/500 - Reward: 989.18, Avg Reward: 992.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:44,261 - TrafficRL.Train - INFO - Episode 305/500 - Reward: 989.33, Avg Reward: 965.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:44,618 - TrafficRL.Train - INFO - Episode 306/500 - Reward: 835.84, Avg Reward: 965.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:44,969 - TrafficRL.Train - INFO - Episode 307/500 - Reward: 991.25, Avg Reward: 968.11, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:45,335 - TrafficRL.Train - INFO - Episode 308/500 - Reward: 993.53, Avg Reward: 969.09, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:45,735 - TrafficRL.Train - INFO - Episode 309/500 - Reward: 989.89, Avg Reward: 969.47, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:46,095 - TrafficRL.Train - INFO - Episode 310/500 - Reward: 991.44, Avg Reward: 969.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:46,456 - TrafficRL.Train - INFO - Episode 311/500 - Reward: 993.71, Avg Reward: 972.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:46,815 - TrafficRL.Train - INFO - Episode 312/500 - Reward: 988.42, Avg Reward: 972.70, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:47,167 - TrafficRL.Train - INFO - Episode 313/500 - Reward: 992.19, Avg Reward: 972.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:47,347 - TrafficRL.Train - INFO - Episode 290/500 - Reward: 990.00, Avg Reward: 992.17, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:47,528 - TrafficRL.Train - INFO - Episode 314/500 - Reward: 993.35, Avg Reward: 972.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:47,883 - TrafficRL.Train - INFO - Episode 315/500 - Reward: 992.36, Avg Reward: 972.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:48,237 - TrafficRL.Train - INFO - Episode 316/500 - Reward: 991.22, Avg Reward: 972.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:48,595 - TrafficRL.Train - INFO - Episode 317/500 - Reward: 991.28, Avg Reward: 973.08, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:48,954 - TrafficRL.Train - INFO - Episode 318/500 - Reward: 994.69, Avg Reward: 973.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:49,324 - TrafficRL.Train - INFO - Episode 319/500 - Reward: 993.63, Avg Reward: 973.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:49,684 - TrafficRL.Train - INFO - Episode 320/500 - Reward: 994.13, Avg Reward: 973.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:49,684 - TrafficRL.Train - INFO - Evaluating agent at episode 320...
2025-03-17 17:28:50,587 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 222227.45
2025-03-17 17:28:50,587 - TrafficRL.Train - INFO - No improvement for 10 evaluations
2025-03-17 17:28:50,602 - TrafficRL.Train - INFO - Episode 291/500 - Reward: 993.66, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:50,970 - TrafficRL.Train - INFO - Episode 321/500 - Reward: 993.55, Avg Reward: 973.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:51,374 - TrafficRL.Train - INFO - Episode 322/500 - Reward: 993.33, Avg Reward: 973.89, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:51,741 - TrafficRL.Train - INFO - Episode 323/500 - Reward: 993.80, Avg Reward: 974.21, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:52,101 - TrafficRL.Train - INFO - Episode 324/500 - Reward: 993.16, Avg Reward: 974.50, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:52,463 - TrafficRL.Train - INFO - Episode 325/500 - Reward: 992.86, Avg Reward: 974.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:52,476 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_325.pth
2025-03-17 17:28:52,476 - TrafficRL.Train - INFO - Model checkpoint saved at episode 325
2025-03-17 17:28:52,835 - TrafficRL.Train - INFO - Episode 326/500 - Reward: 991.66, Avg Reward: 974.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:53,201 - TrafficRL.Train - INFO - Episode 327/500 - Reward: 988.05, Avg Reward: 978.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:53,577 - TrafficRL.Train - INFO - Episode 328/500 - Reward: 991.34, Avg Reward: 978.32, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:53,947 - TrafficRL.Train - INFO - Episode 329/500 - Reward: 990.80, Avg Reward: 978.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:54,060 - TrafficRL.Train - INFO - Episode 292/500 - Reward: 989.90, Avg Reward: 992.15, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:54,315 - TrafficRL.Train - INFO - Episode 330/500 - Reward: 991.82, Avg Reward: 978.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:54,665 - TrafficRL.Train - INFO - Episode 331/500 - Reward: 990.39, Avg Reward: 978.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:55,061 - TrafficRL.Train - INFO - Episode 332/500 - Reward: 981.39, Avg Reward: 978.57, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:55,418 - TrafficRL.Train - INFO - Episode 333/500 - Reward: 982.38, Avg Reward: 978.45, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:55,780 - TrafficRL.Train - INFO - Episode 334/500 - Reward: 991.62, Avg Reward: 978.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:56,142 - TrafficRL.Train - INFO - Episode 335/500 - Reward: 991.52, Avg Reward: 978.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:56,508 - TrafficRL.Train - INFO - Episode 336/500 - Reward: 995.99, Avg Reward: 978.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:56,867 - TrafficRL.Train - INFO - Episode 337/500 - Reward: 996.15, Avg Reward: 978.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:57,219 - TrafficRL.Train - INFO - Episode 338/500 - Reward: 989.89, Avg Reward: 979.24, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:57,470 - TrafficRL.Train - INFO - Episode 293/500 - Reward: 994.07, Avg Reward: 992.15, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:28:57,577 - TrafficRL.Train - INFO - Episode 339/500 - Reward: 994.06, Avg Reward: 979.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:57,937 - TrafficRL.Train - INFO - Episode 340/500 - Reward: 980.82, Avg Reward: 979.56, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:57,937 - TrafficRL.Train - INFO - Evaluating agent at episode 340...
2025-03-17 17:28:58,835 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 78237.34
2025-03-17 17:28:58,835 - TrafficRL.Train - INFO - No improvement for 11 evaluations
2025-03-17 17:28:59,212 - TrafficRL.Train - INFO - Episode 341/500 - Reward: 989.36, Avg Reward: 979.63, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:59,585 - TrafficRL.Train - INFO - Episode 342/500 - Reward: 985.26, Avg Reward: 979.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:28:59,950 - TrafficRL.Train - INFO - Episode 343/500 - Reward: 995.52, Avg Reward: 984.14, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:00,323 - TrafficRL.Train - INFO - Episode 344/500 - Reward: 987.69, Avg Reward: 984.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:00,689 - TrafficRL.Train - INFO - Episode 345/500 - Reward: 992.72, Avg Reward: 984.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:00,812 - TrafficRL.Train - INFO - Episode 294/500 - Reward: 996.71, Avg Reward: 992.17, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:01,065 - TrafficRL.Train - INFO - Episode 346/500 - Reward: 985.04, Avg Reward: 984.46, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:01,429 - TrafficRL.Train - INFO - Episode 347/500 - Reward: 996.61, Avg Reward: 984.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:01,825 - TrafficRL.Train - INFO - Episode 348/500 - Reward: 990.72, Avg Reward: 984.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:02,197 - TrafficRL.Train - INFO - Episode 349/500 - Reward: 990.70, Avg Reward: 984.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:02,554 - TrafficRL.Train - INFO - Episode 350/500 - Reward: 994.28, Avg Reward: 985.00, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:02,566 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_350.pth
2025-03-17 17:29:02,567 - TrafficRL.Train - INFO - Model checkpoint saved at episode 350
2025-03-17 17:29:02,918 - TrafficRL.Train - INFO - Episode 351/500 - Reward: 992.55, Avg Reward: 985.10, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:03,273 - TrafficRL.Train - INFO - Episode 352/500 - Reward: 990.93, Avg Reward: 985.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:03,627 - TrafficRL.Train - INFO - Episode 353/500 - Reward: 993.83, Avg Reward: 985.32, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:04,000 - TrafficRL.Train - INFO - Episode 354/500 - Reward: 993.30, Avg Reward: 985.30, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:04,192 - TrafficRL.Train - INFO - Episode 295/500 - Reward: 995.02, Avg Reward: 992.18, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:04,364 - TrafficRL.Train - INFO - Episode 355/500 - Reward: 994.15, Avg Reward: 985.34, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:04,726 - TrafficRL.Train - INFO - Episode 356/500 - Reward: 995.65, Avg Reward: 985.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:05,076 - TrafficRL.Train - INFO - Episode 357/500 - Reward: 993.43, Avg Reward: 985.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:05,426 - TrafficRL.Train - INFO - Episode 358/500 - Reward: 994.24, Avg Reward: 985.49, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:05,774 - TrafficRL.Train - INFO - Episode 359/500 - Reward: 995.54, Avg Reward: 985.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:06,133 - TrafficRL.Train - INFO - Episode 360/500 - Reward: 995.42, Avg Reward: 985.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:06,133 - TrafficRL.Train - INFO - Evaluating agent at episode 360...
2025-03-17 17:29:07,025 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 94281.69
2025-03-17 17:29:07,025 - TrafficRL.Train - INFO - No improvement for 12 evaluations
2025-03-17 17:29:07,395 - TrafficRL.Train - INFO - Episode 361/500 - Reward: 993.43, Avg Reward: 985.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:07,473 - TrafficRL.Train - INFO - Episode 296/500 - Reward: 993.58, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:07,791 - TrafficRL.Train - INFO - Episode 362/500 - Reward: 994.24, Avg Reward: 986.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:08,149 - TrafficRL.Train - INFO - Episode 363/500 - Reward: 993.82, Avg Reward: 986.29, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:08,502 - TrafficRL.Train - INFO - Episode 364/500 - Reward: 993.42, Avg Reward: 986.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:08,854 - TrafficRL.Train - INFO - Episode 365/500 - Reward: 995.12, Avg Reward: 986.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:09,212 - TrafficRL.Train - INFO - Episode 366/500 - Reward: 996.76, Avg Reward: 986.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:09,574 - TrafficRL.Train - INFO - Episode 367/500 - Reward: 992.96, Avg Reward: 986.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:09,943 - TrafficRL.Train - INFO - Episode 368/500 - Reward: 993.48, Avg Reward: 987.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:10,313 - TrafficRL.Train - INFO - Episode 369/500 - Reward: 994.51, Avg Reward: 987.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:10,672 - TrafficRL.Train - INFO - Episode 370/500 - Reward: 994.39, Avg Reward: 987.29, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:10,868 - TrafficRL.Train - INFO - Episode 297/500 - Reward: 993.10, Avg Reward: 992.21, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:11,023 - TrafficRL.Train - INFO - Episode 371/500 - Reward: 993.56, Avg Reward: 987.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:11,386 - TrafficRL.Train - INFO - Episode 372/500 - Reward: 995.15, Avg Reward: 987.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:11,805 - TrafficRL.Train - INFO - Episode 373/500 - Reward: 994.72, Avg Reward: 988.09, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:12,183 - TrafficRL.Train - INFO - Episode 374/500 - Reward: 995.68, Avg Reward: 988.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:12,555 - TrafficRL.Train - INFO - Episode 375/500 - Reward: 995.03, Avg Reward: 988.31, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:12,568 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_375.pth
2025-03-17 17:29:12,568 - TrafficRL.Train - INFO - Model checkpoint saved at episode 375
2025-03-17 17:29:12,932 - TrafficRL.Train - INFO - Episode 376/500 - Reward: 993.87, Avg Reward: 988.40, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:13,289 - TrafficRL.Train - INFO - Episode 377/500 - Reward: 994.75, Avg Reward: 988.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:13,644 - TrafficRL.Train - INFO - Episode 378/500 - Reward: 993.53, Avg Reward: 988.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:14,012 - TrafficRL.Train - INFO - Episode 379/500 - Reward: 996.46, Avg Reward: 988.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:14,386 - TrafficRL.Train - INFO - Episode 380/500 - Reward: 994.33, Avg Reward: 988.96, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:14,386 - TrafficRL.Train - INFO - Evaluating agent at episode 380...
2025-03-17 17:29:14,417 - TrafficRL.Train - INFO - Episode 298/500 - Reward: 992.75, Avg Reward: 992.20, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:15,281 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 31230.57
2025-03-17 17:29:15,282 - TrafficRL.Train - INFO - No improvement for 13 evaluations
2025-03-17 17:29:15,658 - TrafficRL.Train - INFO - Episode 381/500 - Reward: 995.54, Avg Reward: 988.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:16,029 - TrafficRL.Train - INFO - Episode 382/500 - Reward: 993.80, Avg Reward: 989.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:16,428 - TrafficRL.Train - INFO - Episode 383/500 - Reward: 995.79, Avg Reward: 989.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:16,784 - TrafficRL.Train - INFO - Episode 384/500 - Reward: 994.00, Avg Reward: 989.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:17,133 - TrafficRL.Train - INFO - Episode 385/500 - Reward: 992.66, Avg Reward: 989.38, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:17,483 - TrafficRL.Train - INFO - Episode 386/500 - Reward: 992.89, Avg Reward: 989.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:17,717 - TrafficRL.Train - INFO - Episode 299/500 - Reward: 991.36, Avg Reward: 992.16, Epsilon: 0.0100, LR: 0.000000, Traffic: weekend
2025-03-17 17:29:17,717 - TrafficRL.Train - INFO - Switching to uniform traffic pattern at episode 300
2025-03-17 17:29:17,843 - TrafficRL.Train - INFO - Episode 387/500 - Reward: 993.60, Avg Reward: 989.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:18,210 - TrafficRL.Train - INFO - Episode 388/500 - Reward: 993.97, Avg Reward: 989.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:18,561 - TrafficRL.Train - INFO - Episode 389/500 - Reward: 994.51, Avg Reward: 989.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:18,912 - TrafficRL.Train - INFO - Episode 390/500 - Reward: 993.35, Avg Reward: 989.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:19,257 - TrafficRL.Train - INFO - Episode 391/500 - Reward: 994.03, Avg Reward: 990.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:19,606 - TrafficRL.Train - INFO - Episode 392/500 - Reward: 981.70, Avg Reward: 990.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:19,964 - TrafficRL.Train - INFO - Episode 393/500 - Reward: 994.83, Avg Reward: 990.22, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:20,324 - TrafficRL.Train - INFO - Episode 394/500 - Reward: 996.42, Avg Reward: 990.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:20,685 - TrafficRL.Train - INFO - Episode 395/500 - Reward: 992.36, Avg Reward: 990.68, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:20,997 - TrafficRL.Train - INFO - Episode 300/500 - Reward: 990.33, Avg Reward: 992.17, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:20,997 - TrafficRL.Train - INFO - Evaluating agent at episode 300...
2025-03-17 17:29:21,037 - TrafficRL.Train - INFO - Episode 396/500 - Reward: 989.36, Avg Reward: 990.78, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:21,376 - TrafficRL.Train - INFO - Episode 397/500 - Reward: 991.58, Avg Reward: 990.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:21,715 - TrafficRL.Train - INFO - Episode 398/500 - Reward: 994.38, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:22,054 - TrafficRL.Train - INFO - Episode 399/500 - Reward: 989.92, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:22,342 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 388298.47
2025-03-17 17:29:22,342 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:29:22,356 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_300.pth
2025-03-17 17:29:22,356 - TrafficRL.Train - INFO - Model checkpoint saved at episode 300
2025-03-17 17:29:22,395 - TrafficRL.Train - INFO - Episode 400/500 - Reward: 994.51, Avg Reward: 990.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:22,395 - TrafficRL.Train - INFO - Evaluating agent at episode 400...
2025-03-17 17:29:23,289 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 83508.44
2025-03-17 17:29:23,290 - TrafficRL.Train - INFO - No improvement for 14 evaluations
2025-03-17 17:29:23,304 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_400.pth
2025-03-17 17:29:23,304 - TrafficRL.Train - INFO - Model checkpoint saved at episode 400
2025-03-17 17:29:23,672 - TrafficRL.Train - INFO - Episode 401/500 - Reward: 995.45, Avg Reward: 991.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:24,051 - TrafficRL.Train - INFO - Episode 402/500 - Reward: 985.56, Avg Reward: 990.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:24,433 - TrafficRL.Train - INFO - Episode 403/500 - Reward: 991.97, Avg Reward: 990.91, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:24,778 - TrafficRL.Train - INFO - Episode 404/500 - Reward: 993.49, Avg Reward: 990.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:25,130 - TrafficRL.Train - INFO - Episode 405/500 - Reward: 992.15, Avg Reward: 990.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:25,481 - TrafficRL.Train - INFO - Episode 406/500 - Reward: 994.42, Avg Reward: 992.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:25,627 - TrafficRL.Train - INFO - Episode 301/500 - Reward: 993.11, Avg Reward: 992.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:25,841 - TrafficRL.Train - INFO - Episode 407/500 - Reward: 996.11, Avg Reward: 992.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:26,207 - TrafficRL.Train - INFO - Episode 408/500 - Reward: 995.72, Avg Reward: 992.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:26,567 - TrafficRL.Train - INFO - Episode 409/500 - Reward: 994.52, Avg Reward: 992.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:26,919 - TrafficRL.Train - INFO - Episode 410/500 - Reward: 986.71, Avg Reward: 992.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:27,271 - TrafficRL.Train - INFO - Episode 411/500 - Reward: 994.82, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:27,626 - TrafficRL.Train - INFO - Episode 412/500 - Reward: 994.94, Avg Reward: 992.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:27,995 - TrafficRL.Train - INFO - Episode 413/500 - Reward: 996.05, Avg Reward: 992.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:28,362 - TrafficRL.Train - INFO - Episode 414/500 - Reward: 994.98, Avg Reward: 992.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:28,741 - TrafficRL.Train - INFO - Episode 415/500 - Reward: 992.46, Avg Reward: 992.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:29,016 - TrafficRL.Train - INFO - Episode 302/500 - Reward: 995.09, Avg Reward: 992.18, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:29,106 - TrafficRL.Train - INFO - Episode 416/500 - Reward: 990.39, Avg Reward: 992.73, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:29,452 - TrafficRL.Train - INFO - Episode 417/500 - Reward: 994.79, Avg Reward: 992.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:29,792 - TrafficRL.Train - INFO - Episode 418/500 - Reward: 986.30, Avg Reward: 992.68, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:30,191 - TrafficRL.Train - INFO - Episode 419/500 - Reward: 987.44, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:30,544 - TrafficRL.Train - INFO - Episode 420/500 - Reward: 984.60, Avg Reward: 992.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:30,545 - TrafficRL.Train - INFO - Evaluating agent at episode 420...
2025-03-17 17:29:31,440 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 73353.43
2025-03-17 17:29:31,440 - TrafficRL.Train - INFO - No improvement for 15 evaluations
2025-03-17 17:29:31,810 - TrafficRL.Train - INFO - Episode 421/500 - Reward: 994.11, Avg Reward: 992.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:32,277 - TrafficRL.Train - INFO - Episode 303/500 - Reward: 995.99, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:35,104 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:29:35,104 - TrafficRL.Config - ERROR - Error loading configuration from configs/simple_dqn_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:29:35,104 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:29:35,104 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:29:35,105 - TrafficRL.Config - INFO - Configuration saved to results/training/training_config.json
2025-03-17 17:29:35,105 - TrafficRL - INFO - Starting training with simple_dqn agent...
2025-03-17 17:29:35,105 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:29:35,492 - TrafficRL.Train - INFO - Episode 304/500 - Reward: 994.71, Avg Reward: 992.20, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:35,939 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:36,279 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 974.08, Avg Reward: 983.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:36,619 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 969.67, Avg Reward: 979.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:36,958 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 865.59, Avg Reward: 950.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:37,296 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 843.29, Avg Reward: 929.20, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:37,634 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 802.32, Avg Reward: 908.05, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:37,975 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 876.73, Avg Reward: 903.58, LR: 0.000300, Traffic: uniform
2025-03-17 17:29:38,808 - TrafficRL.Train - INFO - Episode 305/500 - Reward: 989.33, Avg Reward: 992.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:41,679 - TrafficRL.Train - INFO - Episode 306/500 - Reward: 995.21, Avg Reward: 992.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:44,479 - TrafficRL.Train - INFO - Episode 307/500 - Reward: 992.91, Avg Reward: 992.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:47,383 - TrafficRL.Train - INFO - Episode 308/500 - Reward: 994.62, Avg Reward: 992.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:50,293 - TrafficRL.Train - INFO - Episode 309/500 - Reward: 989.89, Avg Reward: 992.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:53,132 - TrafficRL.Train - INFO - Episode 310/500 - Reward: 991.44, Avg Reward: 992.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:56,036 - TrafficRL.Train - INFO - Episode 311/500 - Reward: 993.71, Avg Reward: 992.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:29:58,834 - TrafficRL.Train - INFO - Episode 312/500 - Reward: 988.42, Avg Reward: 992.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:01,693 - TrafficRL.Train - INFO - Episode 313/500 - Reward: 992.19, Avg Reward: 992.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:03,883 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:30:03,883 - TrafficRL.Config - ERROR - Error loading configuration from configs/simple_dqn_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:30:03,883 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:30:03,883 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:30:03,884 - TrafficRL.Config - INFO - Configuration saved to results/simple_dqn/training_config.json
2025-03-17 17:30:03,884 - TrafficRL - INFO - Starting training with simple_dqn agent...
2025-03-17 17:30:03,884 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:30:04,685 - TrafficRL.Train - INFO - Episode 1/500 - Reward: 993.36, Avg Reward: 993.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:04,908 - TrafficRL.Train - INFO - Episode 314/500 - Reward: 994.73, Avg Reward: 992.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:05,024 - TrafficRL.Train - INFO - Episode 2/500 - Reward: 974.08, Avg Reward: 983.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:05,370 - TrafficRL.Train - INFO - Episode 3/500 - Reward: 969.67, Avg Reward: 979.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:05,702 - TrafficRL.Train - INFO - Episode 4/500 - Reward: 865.59, Avg Reward: 950.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:06,019 - TrafficRL.Train - INFO - Episode 5/500 - Reward: 843.29, Avg Reward: 929.20, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:06,377 - TrafficRL.Train - INFO - Episode 6/500 - Reward: 802.32, Avg Reward: 908.05, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:06,707 - TrafficRL.Train - INFO - Episode 7/500 - Reward: 876.73, Avg Reward: 903.58, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:07,041 - TrafficRL.Train - INFO - Episode 8/500 - Reward: 993.87, Avg Reward: 914.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:07,374 - TrafficRL.Train - INFO - Episode 9/500 - Reward: 972.21, Avg Reward: 921.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:07,715 - TrafficRL.Train - INFO - Episode 10/500 - Reward: 973.94, Avg Reward: 926.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:08,049 - TrafficRL.Train - INFO - Episode 11/500 - Reward: 950.31, Avg Reward: 928.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:08,271 - TrafficRL.Train - INFO - Episode 315/500 - Reward: 992.36, Avg Reward: 992.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:08,375 - TrafficRL.Train - INFO - Episode 12/500 - Reward: 963.65, Avg Reward: 931.58, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:08,692 - TrafficRL.Train - INFO - Episode 13/500 - Reward: 989.57, Avg Reward: 936.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:09,012 - TrafficRL.Train - INFO - Episode 14/500 - Reward: 983.54, Avg Reward: 939.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:09,336 - TrafficRL.Train - INFO - Episode 15/500 - Reward: 995.15, Avg Reward: 943.15, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:09,672 - TrafficRL.Train - INFO - Episode 16/500 - Reward: 988.64, Avg Reward: 945.99, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:10,019 - TrafficRL.Train - INFO - Episode 17/500 - Reward: 994.90, Avg Reward: 948.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:10,364 - TrafficRL.Train - INFO - Episode 18/500 - Reward: 987.83, Avg Reward: 951.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:10,740 - TrafficRL.Train - INFO - Episode 19/500 - Reward: 989.15, Avg Reward: 953.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:11,084 - TrafficRL.Train - INFO - Episode 20/500 - Reward: 991.15, Avg Reward: 954.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:11,084 - TrafficRL.Train - INFO - Evaluating agent at episode 20...
2025-03-17 17:30:11,535 - TrafficRL.Train - INFO - Episode 316/500 - Reward: 991.22, Avg Reward: 992.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:11,967 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 166125.06
2025-03-17 17:30:11,970 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/best_model.pth
2025-03-17 17:30:11,970 - TrafficRL.Train - INFO - New best model saved with reward: 166125.06
2025-03-17 17:30:12,321 - TrafficRL.Train - INFO - Episode 21/500 - Reward: 994.15, Avg Reward: 956.81, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:12,672 - TrafficRL.Train - INFO - Episode 22/500 - Reward: 988.09, Avg Reward: 958.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:13,016 - TrafficRL.Train - INFO - Episode 23/500 - Reward: 991.33, Avg Reward: 959.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:13,369 - TrafficRL.Train - INFO - Episode 24/500 - Reward: 987.63, Avg Reward: 960.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:13,711 - TrafficRL.Train - INFO - Episode 25/500 - Reward: 995.88, Avg Reward: 962.24, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:13,714 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_25.pth
2025-03-17 17:30:13,714 - TrafficRL.Train - INFO - Model checkpoint saved at episode 25
2025-03-17 17:30:14,062 - TrafficRL.Train - INFO - Episode 26/500 - Reward: 983.79, Avg Reward: 963.07, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:14,485 - TrafficRL.Train - INFO - Episode 27/500 - Reward: 986.16, Avg Reward: 963.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:14,824 - TrafficRL.Train - INFO - Episode 317/500 - Reward: 991.28, Avg Reward: 992.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:14,828 - TrafficRL.Train - INFO - Episode 28/500 - Reward: 989.83, Avg Reward: 964.85, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:15,176 - TrafficRL.Train - INFO - Episode 29/500 - Reward: 990.69, Avg Reward: 965.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:15,523 - TrafficRL.Train - INFO - Episode 30/500 - Reward: 996.59, Avg Reward: 966.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:15,896 - TrafficRL.Train - INFO - Episode 31/500 - Reward: 988.97, Avg Reward: 967.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:16,229 - TrafficRL.Train - INFO - Episode 32/500 - Reward: 990.33, Avg Reward: 968.20, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:16,554 - TrafficRL.Train - INFO - Episode 33/500 - Reward: 992.05, Avg Reward: 968.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:16,890 - TrafficRL.Train - INFO - Episode 34/500 - Reward: 984.00, Avg Reward: 969.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:17,220 - TrafficRL.Train - INFO - Episode 35/500 - Reward: 985.54, Avg Reward: 969.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:17,555 - TrafficRL.Train - INFO - Episode 36/500 - Reward: 990.97, Avg Reward: 970.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:17,901 - TrafficRL.Train - INFO - Episode 37/500 - Reward: 978.37, Avg Reward: 970.63, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:18,140 - TrafficRL.Train - INFO - Episode 318/500 - Reward: 994.69, Avg Reward: 992.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:18,247 - TrafficRL.Train - INFO - Episode 38/500 - Reward: 980.06, Avg Reward: 970.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:18,580 - TrafficRL.Train - INFO - Episode 39/500 - Reward: 995.90, Avg Reward: 971.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:18,907 - TrafficRL.Train - INFO - Episode 40/500 - Reward: 965.59, Avg Reward: 971.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:18,907 - TrafficRL.Train - INFO - Evaluating agent at episode 40...
2025-03-17 17:30:19,784 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 6402.15
2025-03-17 17:30:19,785 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:30:20,133 - TrafficRL.Train - INFO - Episode 41/500 - Reward: 655.78, Avg Reward: 963.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:20,482 - TrafficRL.Train - INFO - Episode 42/500 - Reward: 915.35, Avg Reward: 962.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:20,827 - TrafficRL.Train - INFO - Episode 43/500 - Reward: 964.28, Avg Reward: 962.56, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:21,175 - TrafficRL.Train - INFO - Episode 44/500 - Reward: 986.87, Avg Reward: 963.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:21,343 - TrafficRL.Train - INFO - Episode 319/500 - Reward: 994.83, Avg Reward: 992.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:21,522 - TrafficRL.Train - INFO - Episode 45/500 - Reward: 985.43, Avg Reward: 963.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:21,880 - TrafficRL.Train - INFO - Episode 46/500 - Reward: 995.09, Avg Reward: 964.30, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:22,262 - TrafficRL.Train - INFO - Episode 47/500 - Reward: 985.62, Avg Reward: 964.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:22,608 - TrafficRL.Train - INFO - Episode 48/500 - Reward: 982.45, Avg Reward: 965.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:22,950 - TrafficRL.Train - INFO - Episode 49/500 - Reward: 972.29, Avg Reward: 965.27, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:23,282 - TrafficRL.Train - INFO - Episode 50/500 - Reward: 992.01, Avg Reward: 965.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:23,285 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_50.pth
2025-03-17 17:30:23,285 - TrafficRL.Train - INFO - Model checkpoint saved at episode 50
2025-03-17 17:30:23,617 - TrafficRL.Train - INFO - Episode 51/500 - Reward: 988.54, Avg Reward: 966.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:24,108 - TrafficRL.Train - INFO - Episode 52/500 - Reward: 985.58, Avg Reward: 966.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:24,446 - TrafficRL.Train - INFO - Episode 53/500 - Reward: 987.87, Avg Reward: 967.02, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:24,769 - TrafficRL.Train - INFO - Episode 320/500 - Reward: 995.18, Avg Reward: 992.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:24,769 - TrafficRL.Train - INFO - Evaluating agent at episode 320...
2025-03-17 17:30:24,771 - TrafficRL.Train - INFO - Episode 54/500 - Reward: 994.79, Avg Reward: 967.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:25,101 - TrafficRL.Train - INFO - Episode 55/500 - Reward: 985.46, Avg Reward: 967.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:25,428 - TrafficRL.Train - INFO - Episode 56/500 - Reward: 995.57, Avg Reward: 968.35, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:25,786 - TrafficRL.Train - INFO - Episode 57/500 - Reward: 987.28, Avg Reward: 968.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:26,114 - TrafficRL.Train - INFO - Episode 58/500 - Reward: 983.95, Avg Reward: 968.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:26,148 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 356288.32
2025-03-17 17:30:26,149 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-17 17:30:26,464 - TrafficRL.Train - INFO - Episode 59/500 - Reward: 988.34, Avg Reward: 969.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:26,819 - TrafficRL.Train - INFO - Episode 60/500 - Reward: 995.73, Avg Reward: 969.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:26,820 - TrafficRL.Train - INFO - Evaluating agent at episode 60...
2025-03-17 17:30:27,705 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 117171.64
2025-03-17 17:30:27,705 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:30:28,077 - TrafficRL.Train - INFO - Episode 61/500 - Reward: 985.28, Avg Reward: 969.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:28,442 - TrafficRL.Train - INFO - Episode 62/500 - Reward: 993.21, Avg Reward: 970.35, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:28,800 - TrafficRL.Train - INFO - Episode 63/500 - Reward: 985.43, Avg Reward: 970.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:29,136 - TrafficRL.Train - INFO - Episode 64/500 - Reward: 991.50, Avg Reward: 970.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:29,473 - TrafficRL.Train - INFO - Episode 321/500 - Reward: 993.55, Avg Reward: 992.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:29,513 - TrafficRL.Train - INFO - Episode 65/500 - Reward: 984.65, Avg Reward: 971.13, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:29,844 - TrafficRL.Train - INFO - Episode 66/500 - Reward: 992.13, Avg Reward: 971.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:30,187 - TrafficRL.Train - INFO - Episode 67/500 - Reward: 992.37, Avg Reward: 971.76, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:30,538 - TrafficRL.Train - INFO - Episode 68/500 - Reward: 983.85, Avg Reward: 971.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:30,888 - TrafficRL.Train - INFO - Episode 69/500 - Reward: 994.52, Avg Reward: 972.26, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:31,470 - TrafficRL.Train - INFO - Episode 70/500 - Reward: 984.68, Avg Reward: 972.44, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:31,829 - TrafficRL.Train - INFO - Episode 71/500 - Reward: 987.38, Avg Reward: 972.65, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:32,195 - TrafficRL.Train - INFO - Episode 72/500 - Reward: 985.18, Avg Reward: 972.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:32,548 - TrafficRL.Train - INFO - Episode 73/500 - Reward: 984.92, Avg Reward: 972.99, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:32,827 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:30:32,828 - TrafficRL - INFO - Random seed set to 42
2025-03-17 17:30:32,828 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:30:32,828 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:30:32,828 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:30:32,828 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:30:32,828 - TrafficRL.Utils.Benchmark - INFO - Attempting to load model from results/ppo_training/best_model.pth
2025-03-17 17:30:32,829 - TrafficRL.Utils.Benchmark - INFO - Model loaded successfully, checking for agent type indicators
2025-03-17 17:30:32,829 - TrafficRL.Utils.Benchmark - INFO - Detected PPO model structure
2025-03-17 17:30:32,829 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:30:32,897 - TrafficRL.Train - INFO - Episode 74/500 - Reward: 985.40, Avg Reward: 973.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:33,082 - TrafficRL.Train - INFO - Episode 322/500 - Reward: 993.33, Avg Reward: 992.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:33,254 - TrafficRL.Train - INFO - Episode 75/500 - Reward: 992.40, Avg Reward: 973.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:33,257 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_75.pth
2025-03-17 17:30:33,257 - TrafficRL.Train - INFO - Model checkpoint saved at episode 75
2025-03-17 17:30:33,293 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2
2025-03-17 17:30:33,295 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo_training/best_model.pth
2025-03-17 17:30:33,295 - TrafficRL.Utils.Benchmark - INFO - Successfully loaded PPO model from results/ppo_training/best_model.pth
2025-03-17 17:30:33,620 - TrafficRL.Train - INFO - Episode 76/500 - Reward: 990.90, Avg Reward: 973.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:33,980 - TrafficRL.Train - INFO - Episode 77/500 - Reward: 996.16, Avg Reward: 973.94, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:34,345 - TrafficRL.Train - INFO - Episode 78/500 - Reward: 973.51, Avg Reward: 973.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:34,702 - TrafficRL.Train - INFO - Episode 79/500 - Reward: 988.32, Avg Reward: 974.11, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:35,043 - TrafficRL.Train - INFO - Episode 80/500 - Reward: 987.13, Avg Reward: 974.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:35,043 - TrafficRL.Train - INFO - Evaluating agent at episode 80...
2025-03-17 17:30:35,965 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147129.04
2025-03-17 17:30:35,965 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:30:36,073 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:30:36,074 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 264370.09 ± 24232.82
2025-03-17 17:30:36,074 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.54
2025-03-17 17:30:36,074 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10964593.61
2025-03-17 17:30:36,074 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:30:36,337 - TrafficRL.Train - INFO - Episode 81/500 - Reward: 992.98, Avg Reward: 974.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:36,391 - TrafficRL.Train - INFO - Episode 323/500 - Reward: 993.80, Avg Reward: 992.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:36,704 - TrafficRL.Train - INFO - Episode 82/500 - Reward: 988.14, Avg Reward: 974.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:37,082 - TrafficRL.Train - INFO - Episode 83/500 - Reward: 990.70, Avg Reward: 974.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:37,448 - TrafficRL.Train - INFO - Episode 84/500 - Reward: 982.44, Avg Reward: 974.96, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:37,824 - TrafficRL.Train - INFO - Episode 85/500 - Reward: 982.21, Avg Reward: 975.04, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:38,193 - TrafficRL.Train - INFO - Episode 86/500 - Reward: 962.55, Avg Reward: 974.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:38,564 - TrafficRL.Train - INFO - Episode 87/500 - Reward: 990.00, Avg Reward: 975.07, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:38,695 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:30:38,695 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 31253.17 ± 1025.17
2025-03-17 17:30:38,695 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 237.51
2025-03-17 17:30:38,695 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8232818.17
2025-03-17 17:30:38,695 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:30:38,929 - TrafficRL.Train - INFO - Episode 88/500 - Reward: 985.34, Avg Reward: 975.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:39,290 - TrafficRL.Train - INFO - Episode 89/500 - Reward: 979.00, Avg Reward: 975.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:39,669 - TrafficRL.Train - INFO - Episode 90/500 - Reward: 966.15, Avg Reward: 975.13, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:39,825 - TrafficRL.Train - INFO - Episode 324/500 - Reward: 993.16, Avg Reward: 992.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:40,044 - TrafficRL.Train - INFO - Episode 91/500 - Reward: 984.71, Avg Reward: 975.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:40,418 - TrafficRL.Train - INFO - Episode 92/500 - Reward: 986.75, Avg Reward: 975.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:40,796 - TrafficRL.Train - INFO - Episode 93/500 - Reward: 993.40, Avg Reward: 975.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:41,180 - TrafficRL.Train - INFO - Episode 94/500 - Reward: 985.30, Avg Reward: 975.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:41,488 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for FixedTiming on weekend:
2025-03-17 17:30:41,489 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 296072.10 ± 1655.37
2025-03-17 17:30:41,489 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 149.51
2025-03-17 17:30:41,489 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10738487.97
2025-03-17 17:30:41,489 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:30:41,572 - TrafficRL.Train - INFO - Episode 95/500 - Reward: 992.59, Avg Reward: 975.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:41,933 - TrafficRL.Train - INFO - Episode 96/500 - Reward: 984.62, Avg Reward: 975.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:42,292 - TrafficRL.Train - INFO - Episode 97/500 - Reward: 988.81, Avg Reward: 976.06, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:42,648 - TrafficRL.Train - INFO - Episode 98/500 - Reward: 984.62, Avg Reward: 976.15, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:43,006 - TrafficRL.Train - INFO - Episode 99/500 - Reward: 979.18, Avg Reward: 976.18, LR: 0.000300, Traffic: uniform
2025-03-17 17:30:43,006 - TrafficRL.Train - INFO - Switching to rush_hour traffic pattern at episode 100
2025-03-17 17:30:43,294 - TrafficRL.Train - INFO - Episode 325/500 - Reward: 992.86, Avg Reward: 992.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:43,308 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_325.pth
2025-03-17 17:30:43,308 - TrafficRL.Train - INFO - Model checkpoint saved at episode 325
2025-03-17 17:30:43,373 - TrafficRL.Train - INFO - Episode 100/500 - Reward: 990.75, Avg Reward: 976.32, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:43,373 - TrafficRL.Train - INFO - Evaluating agent at episode 100...
2025-03-17 17:30:44,242 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 156290.54
2025-03-17 17:30:44,243 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:30:44,247 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_100.pth
2025-03-17 17:30:44,247 - TrafficRL.Train - INFO - Model checkpoint saved at episode 100
2025-03-17 17:30:44,285 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:30:44,286 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 253731.24 ± 15346.37
2025-03-17 17:30:44,286 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 182.90
2025-03-17 17:30:44,286 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10996580.73
2025-03-17 17:30:44,286 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=48.8%, EW=51.2%
2025-03-17 17:30:44,624 - TrafficRL.Train - INFO - Episode 101/500 - Reward: 993.92, Avg Reward: 976.33, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:44,996 - TrafficRL.Train - INFO - Episode 102/500 - Reward: 986.48, Avg Reward: 976.45, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:45,369 - TrafficRL.Train - INFO - Episode 103/500 - Reward: 996.08, Avg Reward: 976.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:45,726 - TrafficRL.Train - INFO - Episode 104/500 - Reward: 992.06, Avg Reward: 977.98, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:46,083 - TrafficRL.Train - INFO - Episode 105/500 - Reward: 990.75, Avg Reward: 979.46, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:46,465 - TrafficRL.Train - INFO - Episode 106/500 - Reward: 996.45, Avg Reward: 981.40, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:46,670 - TrafficRL.Train - INFO - Episode 326/500 - Reward: 991.66, Avg Reward: 992.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:46,825 - TrafficRL.Train - INFO - Episode 107/500 - Reward: 990.63, Avg Reward: 982.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:46,955 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:30:46,955 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 59871.55 ± 1234.64
2025-03-17 17:30:46,955 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 231.84
2025-03-17 17:30:46,955 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8624928.27
2025-03-17 17:30:46,955 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:30:47,186 - TrafficRL.Train - INFO - Episode 108/500 - Reward: 992.64, Avg Reward: 982.52, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:47,530 - TrafficRL.Train - INFO - Episode 109/500 - Reward: 993.13, Avg Reward: 982.73, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:47,873 - TrafficRL.Train - INFO - Episode 110/500 - Reward: 991.96, Avg Reward: 982.91, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:48,217 - TrafficRL.Train - INFO - Episode 111/500 - Reward: 994.47, Avg Reward: 983.36, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:48,562 - TrafficRL.Train - INFO - Episode 112/500 - Reward: 995.95, Avg Reward: 983.68, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:48,926 - TrafficRL.Train - INFO - Episode 113/500 - Reward: 993.63, Avg Reward: 983.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:49,283 - TrafficRL.Train - INFO - Episode 114/500 - Reward: 992.43, Avg Reward: 983.81, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:49,651 - TrafficRL.Train - INFO - Episode 115/500 - Reward: 994.52, Avg Reward: 983.80, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:49,700 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for AdaptiveTiming on weekend:
2025-03-17 17:30:49,700 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 235370.65 ± 15720.27
2025-03-17 17:30:49,700 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 162.52
2025-03-17 17:30:49,700 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9931804.96
2025-03-17 17:30:49,700 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:30:49,997 - TrafficRL.Train - INFO - Episode 116/500 - Reward: 983.47, Avg Reward: 983.75, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:50,043 - TrafficRL.Train - INFO - Episode 327/500 - Reward: 992.48, Avg Reward: 992.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:50,351 - TrafficRL.Train - INFO - Episode 117/500 - Reward: 987.36, Avg Reward: 983.67, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:50,692 - TrafficRL.Train - INFO - Episode 118/500 - Reward: 988.93, Avg Reward: 983.69, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:51,040 - TrafficRL.Train - INFO - Episode 119/500 - Reward: 992.66, Avg Reward: 983.72, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:51,401 - TrafficRL.Train - INFO - Episode 120/500 - Reward: 995.55, Avg Reward: 983.76, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:51,401 - TrafficRL.Train - INFO - Evaluating agent at episode 120...
2025-03-17 17:30:52,312 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 307742.13
2025-03-17 17:30:52,317 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/best_model.pth
2025-03-17 17:30:52,317 - TrafficRL.Train - INFO - New best model saved with reward: 307742.13
2025-03-17 17:30:52,516 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on uniform:
2025-03-17 17:30:52,516 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 247253.96 ± 66910.98
2025-03-17 17:30:52,516 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 174.68
2025-03-17 17:30:52,516 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10629922.56
2025-03-17 17:30:52,516 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:30:52,688 - TrafficRL.Train - INFO - Episode 121/500 - Reward: 996.36, Avg Reward: 983.79, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:53,057 - TrafficRL.Train - INFO - Episode 122/500 - Reward: 995.68, Avg Reward: 983.86, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:53,391 - TrafficRL.Train - INFO - Episode 328/500 - Reward: 991.34, Avg Reward: 992.45, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:53,425 - TrafficRL.Train - INFO - Episode 123/500 - Reward: 993.45, Avg Reward: 983.88, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:53,791 - TrafficRL.Train - INFO - Episode 124/500 - Reward: 991.03, Avg Reward: 983.92, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:54,162 - TrafficRL.Train - INFO - Episode 125/500 - Reward: 991.32, Avg Reward: 983.87, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:54,167 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_125.pth
2025-03-17 17:30:54,168 - TrafficRL.Train - INFO - Model checkpoint saved at episode 125
2025-03-17 17:30:54,525 - TrafficRL.Train - INFO - Episode 126/500 - Reward: 993.61, Avg Reward: 983.97, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:54,891 - TrafficRL.Train - INFO - Episode 127/500 - Reward: 995.18, Avg Reward: 984.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:55,256 - TrafficRL.Train - INFO - Episode 128/500 - Reward: 995.32, Avg Reward: 984.12, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:55,326 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:30:55,327 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 73370.15 ± 27332.29
2025-03-17 17:30:55,327 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 230.16
2025-03-17 17:30:55,327 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 8844837.76
2025-03-17 17:30:55,327 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=49.7%, EW=50.3%
2025-03-17 17:30:55,609 - TrafficRL.Train - INFO - Episode 129/500 - Reward: 988.02, Avg Reward: 984.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:55,955 - TrafficRL.Train - INFO - Episode 130/500 - Reward: 996.09, Avg Reward: 984.08, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:56,303 - TrafficRL.Train - INFO - Episode 131/500 - Reward: 991.94, Avg Reward: 984.11, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:56,653 - TrafficRL.Train - INFO - Episode 132/500 - Reward: 987.59, Avg Reward: 984.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:56,836 - TrafficRL.Train - INFO - Episode 329/500 - Reward: 993.84, Avg Reward: 992.44, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:30:57,048 - TrafficRL.Train - INFO - Episode 133/500 - Reward: 993.69, Avg Reward: 984.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:57,408 - TrafficRL.Train - INFO - Episode 134/500 - Reward: 991.23, Avg Reward: 984.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:57,767 - TrafficRL.Train - INFO - Episode 135/500 - Reward: 996.00, Avg Reward: 984.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:58,117 - TrafficRL.Train - INFO - Episode 136/500 - Reward: 993.06, Avg Reward: 984.30, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:58,147 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for Random on weekend:
2025-03-17 17:30:58,147 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 233212.88 ± 59472.79
2025-03-17 17:30:58,147 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 163.93
2025-03-17 17:30:58,147 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9949349.34
2025-03-17 17:30:58,147 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=50.5%, EW=49.5%
2025-03-17 17:30:58,483 - TrafficRL.Train - INFO - Episode 137/500 - Reward: 986.76, Avg Reward: 984.38, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:58,837 - TrafficRL.Train - INFO - Episode 138/500 - Reward: 992.77, Avg Reward: 984.51, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:59,222 - TrafficRL.Train - INFO - Episode 139/500 - Reward: 988.34, Avg Reward: 984.44, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:59,593 - TrafficRL.Train - INFO - Episode 140/500 - Reward: 994.57, Avg Reward: 984.73, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:30:59,593 - TrafficRL.Train - INFO - Evaluating agent at episode 140...
2025-03-17 17:31:00,252 - TrafficRL.Train - INFO - Episode 330/500 - Reward: 994.31, Avg Reward: 992.50, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:00,493 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 58479.78
2025-03-17 17:31:00,493 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:31:00,903 - TrafficRL.Train - INFO - Episode 141/500 - Reward: 993.06, Avg Reward: 988.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:01,262 - TrafficRL.Train - INFO - Episode 142/500 - Reward: 994.99, Avg Reward: 988.89, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:01,615 - TrafficRL.Train - INFO - Episode 143/500 - Reward: 991.79, Avg Reward: 989.17, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:01,971 - TrafficRL.Train - INFO - Episode 144/500 - Reward: 991.10, Avg Reward: 989.21, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:01,992 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on uniform:
2025-03-17 17:31:01,993 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 136607.63 ± 62635.40
2025-03-17 17:31:01,993 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 202.27
2025-03-17 17:31:01,993 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 9380137.60
2025-03-17 17:31:01,993 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:31:02,323 - TrafficRL.Train - INFO - Episode 145/500 - Reward: 992.28, Avg Reward: 989.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:02,689 - TrafficRL.Train - INFO - Episode 146/500 - Reward: 989.77, Avg Reward: 989.23, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:03,057 - TrafficRL.Train - INFO - Episode 147/500 - Reward: 992.75, Avg Reward: 989.30, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:03,430 - TrafficRL.Train - INFO - Episode 148/500 - Reward: 990.84, Avg Reward: 989.38, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:03,683 - TrafficRL.Train - INFO - Episode 331/500 - Reward: 993.48, Avg Reward: 992.52, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:03,781 - TrafficRL.Train - INFO - Episode 149/500 - Reward: 988.37, Avg Reward: 989.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:04,127 - TrafficRL.Train - INFO - Episode 150/500 - Reward: 995.68, Avg Reward: 989.58, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:04,133 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_150.pth
2025-03-17 17:31:04,133 - TrafficRL.Train - INFO - Model checkpoint saved at episode 150
2025-03-17 17:31:04,480 - TrafficRL.Train - INFO - Episode 151/500 - Reward: 996.35, Avg Reward: 989.66, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:04,846 - TrafficRL.Train - INFO - Episode 152/500 - Reward: 994.30, Avg Reward: 989.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:05,209 - TrafficRL.Train - INFO - Episode 153/500 - Reward: 988.55, Avg Reward: 989.75, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:05,584 - TrafficRL.Train - INFO - Episode 154/500 - Reward: 987.60, Avg Reward: 989.68, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:05,761 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 17:31:05,761 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 278261.06 ± 85641.28
2025-03-17 17:31:05,761 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 222.26
2025-03-17 17:31:05,761 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 12731984.30
2025-03-17 17:31:05,761 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=4.5%, EW=95.5%
2025-03-17 17:31:05,943 - TrafficRL.Train - INFO - Episode 155/500 - Reward: 994.75, Avg Reward: 989.77, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:06,285 - TrafficRL.Train - INFO - Episode 156/500 - Reward: 987.91, Avg Reward: 989.70, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:06,668 - TrafficRL.Train - INFO - Episode 157/500 - Reward: 992.04, Avg Reward: 989.74, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:07,032 - TrafficRL.Train - INFO - Episode 158/500 - Reward: 996.04, Avg Reward: 989.86, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:07,142 - TrafficRL.Train - INFO - Episode 332/500 - Reward: 993.39, Avg Reward: 992.52, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:07,382 - TrafficRL.Train - INFO - Episode 159/500 - Reward: 991.82, Avg Reward: 989.90, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:07,736 - TrafficRL.Train - INFO - Episode 160/500 - Reward: 994.43, Avg Reward: 989.89, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:07,736 - TrafficRL.Train - INFO - Evaluating agent at episode 160...
2025-03-17 17:31:08,625 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 46257.14
2025-03-17 17:31:08,625 - TrafficRL.Train - INFO - No improvement for 2 evaluations
2025-03-17 17:31:09,007 - TrafficRL.Train - INFO - Episode 161/500 - Reward: 994.41, Avg Reward: 989.98, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:09,408 - TrafficRL.Train - INFO - Episode 162/500 - Reward: 991.82, Avg Reward: 989.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:09,667 - TrafficRL.Utils.Benchmark - INFO - Benchmark results for PPO on weekend:
2025-03-17 17:31:09,667 - TrafficRL.Utils.Benchmark - INFO -   Average Reward: 217840.15 ± 73729.50
2025-03-17 17:31:09,667 - TrafficRL.Utils.Benchmark - INFO -   Average Waiting Time: 187.22
2025-03-17 17:31:09,667 - TrafficRL.Utils.Benchmark - INFO -   Average Throughput: 10512613.46
2025-03-17 17:31:09,667 - TrafficRL.Utils.Benchmark - INFO -   Action Distribution: NS=5.2%, EW=94.8%
2025-03-17 17:31:09,674 - TrafficRL.Utils.Benchmark - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_173033/benchmark_results.json
2025-03-17 17:31:09,782 - TrafficRL.Train - INFO - Episode 163/500 - Reward: 995.07, Avg Reward: 990.06, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:10,426 - TrafficRL.Train - INFO - Episode 164/500 - Reward: 994.61, Avg Reward: 990.09, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:10,768 - TrafficRL.Train - INFO - Episode 333/500 - Reward: 990.11, Avg Reward: 992.50, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:10,780 - TrafficRL.Train - INFO - Episode 165/500 - Reward: 982.06, Avg Reward: 990.07, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:11,156 - TrafficRL.Train - INFO - Episode 166/500 - Reward: 989.72, Avg Reward: 990.04, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:11,535 - TrafficRL.Train - INFO - Episode 167/500 - Reward: 989.53, Avg Reward: 990.01, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:11,925 - TrafficRL.Train - INFO - Episode 168/500 - Reward: 995.15, Avg Reward: 990.13, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:12,335 - TrafficRL.Train - INFO - Episode 169/500 - Reward: 992.36, Avg Reward: 990.10, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:12,656 - TrafficRL.Utils.Benchmark - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_173033/plots
2025-03-17 17:31:12,656 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:31:12,656 - TrafficRL - INFO -   FixedTiming_uniform: Reward=264370.09, Waiting=174.54
2025-03-17 17:31:12,656 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31253.17, Waiting=237.51
2025-03-17 17:31:12,656 - TrafficRL - INFO -   FixedTiming_weekend: Reward=296072.10, Waiting=149.51
2025-03-17 17:31:12,656 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=253731.24, Waiting=182.90
2025-03-17 17:31:12,656 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59871.55, Waiting=231.84
2025-03-17 17:31:12,656 - TrafficRL - INFO -   AdaptiveTiming_weekend: Reward=235370.65, Waiting=162.52
2025-03-17 17:31:12,656 - TrafficRL - INFO -   Random_uniform: Reward=247253.96, Waiting=174.68
2025-03-17 17:31:12,656 - TrafficRL - INFO -   Random_rush_hour: Reward=73370.15, Waiting=230.16
2025-03-17 17:31:12,656 - TrafficRL - INFO -   Random_weekend: Reward=233212.88, Waiting=163.93
2025-03-17 17:31:12,656 - TrafficRL - INFO -   PPO_uniform: Reward=136607.63, Waiting=202.27
2025-03-17 17:31:12,657 - TrafficRL - INFO -   PPO_rush_hour: Reward=278261.06, Waiting=222.26
2025-03-17 17:31:12,657 - TrafficRL - INFO -   PPO_weekend: Reward=217840.15, Waiting=187.22
2025-03-17 17:31:12,738 - TrafficRL.Train - INFO - Episode 170/500 - Reward: 994.91, Avg Reward: 990.21, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:13,094 - TrafficRL.Train - INFO - Episode 171/500 - Reward: 995.39, Avg Reward: 990.29, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:13,424 - TrafficRL.Train - INFO - Episode 172/500 - Reward: 990.88, Avg Reward: 990.34, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:13,763 - TrafficRL.Train - INFO - Episode 173/500 - Reward: 993.69, Avg Reward: 990.43, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:14,033 - TrafficRL.Train - INFO - Episode 334/500 - Reward: 993.36, Avg Reward: 992.52, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:14,122 - TrafficRL.Train - INFO - Episode 174/500 - Reward: 990.09, Avg Reward: 990.48, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:14,458 - TrafficRL.Train - INFO - Episode 175/500 - Reward: 994.46, Avg Reward: 990.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:14,465 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_175.pth
2025-03-17 17:31:14,465 - TrafficRL.Train - INFO - Model checkpoint saved at episode 175
2025-03-17 17:31:14,824 - TrafficRL.Train - INFO - Episode 176/500 - Reward: 990.72, Avg Reward: 990.50, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:15,175 - TrafficRL.Train - INFO - Episode 177/500 - Reward: 986.36, Avg Reward: 990.40, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:15,516 - TrafficRL.Train - INFO - Episode 178/500 - Reward: 987.82, Avg Reward: 990.54, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:15,849 - TrafficRL.Train - INFO - Episode 179/500 - Reward: 992.84, Avg Reward: 990.59, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:16,184 - TrafficRL.Train - INFO - Episode 180/500 - Reward: 993.69, Avg Reward: 990.65, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:16,184 - TrafficRL.Train - INFO - Evaluating agent at episode 180...
2025-03-17 17:31:16,930 - TrafficRL.Train - INFO - Episode 335/500 - Reward: 994.16, Avg Reward: 992.54, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:17,047 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 50514.73
2025-03-17 17:31:17,048 - TrafficRL.Train - INFO - No improvement for 3 evaluations
2025-03-17 17:31:17,410 - TrafficRL.Train - INFO - Episode 181/500 - Reward: 986.52, Avg Reward: 990.59, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:17,800 - TrafficRL.Train - INFO - Episode 182/500 - Reward: 994.98, Avg Reward: 990.66, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:18,140 - TrafficRL.Train - INFO - Episode 183/500 - Reward: 995.57, Avg Reward: 990.71, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:18,492 - TrafficRL.Train - INFO - Episode 184/500 - Reward: 995.29, Avg Reward: 990.83, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:18,837 - TrafficRL.Train - INFO - Episode 185/500 - Reward: 993.15, Avg Reward: 990.94, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:19,181 - TrafficRL.Train - INFO - Episode 186/500 - Reward: 996.26, Avg Reward: 991.28, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:19,519 - TrafficRL.Train - INFO - Episode 187/500 - Reward: 995.32, Avg Reward: 991.33, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:19,879 - TrafficRL.Train - INFO - Episode 188/500 - Reward: 993.22, Avg Reward: 991.41, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:19,937 - TrafficRL.Train - INFO - Episode 336/500 - Reward: 995.99, Avg Reward: 992.57, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:20,232 - TrafficRL.Train - INFO - Episode 189/500 - Reward: 994.53, Avg Reward: 991.57, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:20,590 - TrafficRL.Train - INFO - Episode 190/500 - Reward: 994.20, Avg Reward: 991.85, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:20,934 - TrafficRL.Train - INFO - Episode 191/500 - Reward: 996.13, Avg Reward: 991.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:21,271 - TrafficRL.Train - INFO - Episode 192/500 - Reward: 987.48, Avg Reward: 991.97, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:21,600 - TrafficRL.Train - INFO - Episode 193/500 - Reward: 992.62, Avg Reward: 991.96, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:21,967 - TrafficRL.Train - INFO - Episode 194/500 - Reward: 992.00, Avg Reward: 992.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:22,301 - TrafficRL.Train - INFO - Episode 195/500 - Reward: 992.57, Avg Reward: 992.03, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:22,638 - TrafficRL.Train - INFO - Episode 196/500 - Reward: 994.63, Avg Reward: 992.13, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:22,885 - TrafficRL.Train - INFO - Episode 337/500 - Reward: 996.15, Avg Reward: 992.61, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:22,973 - TrafficRL.Train - INFO - Episode 197/500 - Reward: 995.85, Avg Reward: 992.20, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:23,313 - TrafficRL.Train - INFO - Episode 198/500 - Reward: 995.79, Avg Reward: 992.31, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:23,656 - TrafficRL.Train - INFO - Episode 199/500 - Reward: 989.91, Avg Reward: 992.42, LR: 0.000300, Traffic: rush_hour
2025-03-17 17:31:23,657 - TrafficRL.Train - INFO - Switching to weekend traffic pattern at episode 200
2025-03-17 17:31:24,013 - TrafficRL.Train - INFO - Episode 200/500 - Reward: 985.91, Avg Reward: 992.37, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:24,013 - TrafficRL.Train - INFO - Evaluating agent at episode 200...
2025-03-17 17:31:24,904 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 151384.30
2025-03-17 17:31:24,904 - TrafficRL.Train - INFO - No improvement for 4 evaluations
2025-03-17 17:31:24,912 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_200.pth
2025-03-17 17:31:24,912 - TrafficRL.Train - INFO - Model checkpoint saved at episode 200
2025-03-17 17:31:25,284 - TrafficRL.Train - INFO - Episode 201/500 - Reward: 990.66, Avg Reward: 992.34, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:25,648 - TrafficRL.Train - INFO - Episode 202/500 - Reward: 990.34, Avg Reward: 992.38, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:25,715 - TrafficRL.Train - INFO - Episode 338/500 - Reward: 994.69, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:26,007 - TrafficRL.Train - INFO - Episode 203/500 - Reward: 987.87, Avg Reward: 992.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:26,356 - TrafficRL.Train - INFO - Episode 204/500 - Reward: 988.37, Avg Reward: 992.26, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:26,703 - TrafficRL.Train - INFO - Episode 205/500 - Reward: 989.40, Avg Reward: 992.24, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:27,072 - TrafficRL.Train - INFO - Episode 206/500 - Reward: 874.47, Avg Reward: 991.02, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:27,406 - TrafficRL.Train - INFO - Episode 207/500 - Reward: 716.83, Avg Reward: 988.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:27,740 - TrafficRL.Train - INFO - Episode 208/500 - Reward: 894.77, Avg Reward: 987.31, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:28,080 - TrafficRL.Train - INFO - Episode 209/500 - Reward: 952.38, Avg Reward: 986.90, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:28,422 - TrafficRL.Train - INFO - Episode 210/500 - Reward: 990.61, Avg Reward: 986.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:28,603 - TrafficRL.Train - INFO - Episode 339/500 - Reward: 995.03, Avg Reward: 992.69, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:28,777 - TrafficRL.Train - INFO - Episode 211/500 - Reward: 674.67, Avg Reward: 983.69, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:29,129 - TrafficRL.Train - INFO - Episode 212/500 - Reward: 985.05, Avg Reward: 983.58, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:29,468 - TrafficRL.Train - INFO - Episode 213/500 - Reward: 980.45, Avg Reward: 983.45, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:29,810 - TrafficRL.Train - INFO - Episode 214/500 - Reward: 987.11, Avg Reward: 983.39, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:30,153 - TrafficRL.Train - INFO - Episode 215/500 - Reward: 988.33, Avg Reward: 983.33, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:30,510 - TrafficRL.Train - INFO - Episode 216/500 - Reward: 990.27, Avg Reward: 983.40, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:30,862 - TrafficRL.Train - INFO - Episode 217/500 - Reward: 976.90, Avg Reward: 983.30, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:31,215 - TrafficRL.Train - INFO - Episode 218/500 - Reward: 977.55, Avg Reward: 983.18, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:31,457 - TrafficRL.Train - INFO - Episode 340/500 - Reward: 990.24, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:31,457 - TrafficRL.Train - INFO - Evaluating agent at episode 340...
2025-03-17 17:31:31,552 - TrafficRL.Train - INFO - Episode 219/500 - Reward: 976.75, Avg Reward: 983.02, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:31,955 - TrafficRL.Train - INFO - Episode 220/500 - Reward: 981.85, Avg Reward: 982.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:31,955 - TrafficRL.Train - INFO - Evaluating agent at episode 220...
2025-03-17 17:31:32,863 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 516839.90
2025-03-17 17:31:32,863 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-17 17:31:32,905 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 133598.44
2025-03-17 17:31:32,905 - TrafficRL.Train - INFO - No improvement for 5 evaluations
2025-03-17 17:31:33,390 - TrafficRL.Train - INFO - Episode 221/500 - Reward: 976.79, Avg Reward: 982.69, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:33,756 - TrafficRL.Train - INFO - Episode 222/500 - Reward: 974.69, Avg Reward: 982.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:34,131 - TrafficRL.Train - INFO - Episode 223/500 - Reward: 962.41, Avg Reward: 982.17, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:34,499 - TrafficRL.Train - INFO - Episode 224/500 - Reward: 964.15, Avg Reward: 981.90, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:34,857 - TrafficRL.Train - INFO - Episode 225/500 - Reward: 981.57, Avg Reward: 981.80, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:34,866 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_225.pth
2025-03-17 17:31:34,866 - TrafficRL.Train - INFO - Model checkpoint saved at episode 225
2025-03-17 17:31:35,225 - TrafficRL.Train - INFO - Episode 226/500 - Reward: 980.91, Avg Reward: 981.68, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:35,600 - TrafficRL.Train - INFO - Episode 227/500 - Reward: 634.63, Avg Reward: 978.07, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:35,968 - TrafficRL.Train - INFO - Episode 228/500 - Reward: 984.70, Avg Reward: 977.96, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:36,074 - TrafficRL.Train - INFO - Episode 341/500 - Reward: 993.60, Avg Reward: 992.67, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:36,324 - TrafficRL.Train - INFO - Episode 229/500 - Reward: 969.16, Avg Reward: 977.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:36,661 - TrafficRL.Train - INFO - Episode 230/500 - Reward: 991.84, Avg Reward: 977.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:37,000 - TrafficRL.Train - INFO - Episode 231/500 - Reward: 979.63, Avg Reward: 977.61, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:37,337 - TrafficRL.Train - INFO - Episode 232/500 - Reward: 988.79, Avg Reward: 977.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:37,672 - TrafficRL.Train - INFO - Episode 233/500 - Reward: 994.02, Avg Reward: 977.63, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:38,061 - TrafficRL.Train - INFO - Episode 234/500 - Reward: 988.75, Avg Reward: 977.60, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:38,415 - TrafficRL.Train - INFO - Episode 235/500 - Reward: 984.14, Avg Reward: 977.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:38,755 - TrafficRL.Train - INFO - Episode 236/500 - Reward: 977.05, Avg Reward: 977.32, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:38,976 - TrafficRL.Train - INFO - Episode 342/500 - Reward: 994.07, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:39,096 - TrafficRL.Train - INFO - Episode 237/500 - Reward: 975.28, Avg Reward: 977.21, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:39,437 - TrafficRL.Train - INFO - Episode 238/500 - Reward: 961.03, Avg Reward: 976.89, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:39,780 - TrafficRL.Train - INFO - Episode 239/500 - Reward: 976.87, Avg Reward: 976.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:40,126 - TrafficRL.Train - INFO - Episode 240/500 - Reward: 965.67, Avg Reward: 976.49, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:40,127 - TrafficRL.Train - INFO - Evaluating agent at episode 240...
2025-03-17 17:31:41,022 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 147883.08
2025-03-17 17:31:41,022 - TrafficRL.Train - INFO - No improvement for 6 evaluations
2025-03-17 17:31:41,401 - TrafficRL.Train - INFO - Episode 241/500 - Reward: 982.87, Avg Reward: 976.38, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:41,766 - TrafficRL.Train - INFO - Episode 242/500 - Reward: 993.71, Avg Reward: 976.37, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:41,917 - TrafficRL.Train - INFO - Episode 343/500 - Reward: 995.52, Avg Reward: 992.67, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:42,185 - TrafficRL.Train - INFO - Episode 243/500 - Reward: 535.70, Avg Reward: 971.81, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:42,559 - TrafficRL.Train - INFO - Episode 244/500 - Reward: 976.90, Avg Reward: 971.67, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:42,923 - TrafficRL.Train - INFO - Episode 245/500 - Reward: 975.90, Avg Reward: 971.51, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:43,263 - TrafficRL.Train - INFO - Episode 246/500 - Reward: 981.11, Avg Reward: 971.42, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:43,623 - TrafficRL.Train - INFO - Episode 247/500 - Reward: 980.00, Avg Reward: 971.29, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:44,029 - TrafficRL.Train - INFO - Episode 248/500 - Reward: 966.69, Avg Reward: 971.05, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:44,398 - TrafficRL.Train - INFO - Episode 249/500 - Reward: 989.75, Avg Reward: 971.06, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:44,743 - TrafficRL.Train - INFO - Episode 250/500 - Reward: 981.32, Avg Reward: 970.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:44,752 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_250.pth
2025-03-17 17:31:44,752 - TrafficRL.Train - INFO - Model checkpoint saved at episode 250
2025-03-17 17:31:44,985 - TrafficRL.Train - INFO - Episode 344/500 - Reward: 992.49, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:45,106 - TrafficRL.Train - INFO - Episode 251/500 - Reward: 983.02, Avg Reward: 970.79, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:45,449 - TrafficRL.Train - INFO - Episode 252/500 - Reward: 977.46, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:45,801 - TrafficRL.Train - INFO - Episode 253/500 - Reward: 985.36, Avg Reward: 970.59, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:46,175 - TrafficRL.Train - INFO - Episode 254/500 - Reward: 995.46, Avg Reward: 970.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:46,533 - TrafficRL.Train - INFO - Episode 255/500 - Reward: 990.13, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:46,890 - TrafficRL.Train - INFO - Episode 256/500 - Reward: 987.78, Avg Reward: 970.62, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:47,246 - TrafficRL.Train - INFO - Episode 257/500 - Reward: 993.34, Avg Reward: 970.63, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:47,591 - TrafficRL.Train - INFO - Episode 258/500 - Reward: 987.18, Avg Reward: 970.54, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:47,915 - TrafficRL.Train - INFO - Episode 345/500 - Reward: 994.54, Avg Reward: 992.66, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:47,935 - TrafficRL.Train - INFO - Episode 259/500 - Reward: 993.54, Avg Reward: 970.56, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:48,285 - TrafficRL.Train - INFO - Episode 260/500 - Reward: 966.16, Avg Reward: 970.28, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:48,285 - TrafficRL.Train - INFO - Evaluating agent at episode 260...
2025-03-17 17:31:49,202 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 277408.12
2025-03-17 17:31:49,203 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-17 17:31:49,611 - TrafficRL.Train - INFO - Episode 261/500 - Reward: 977.87, Avg Reward: 970.11, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:49,981 - TrafficRL.Train - INFO - Episode 262/500 - Reward: 964.65, Avg Reward: 969.84, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:50,340 - TrafficRL.Train - INFO - Episode 263/500 - Reward: 989.40, Avg Reward: 969.78, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:50,687 - TrafficRL.Train - INFO - Episode 264/500 - Reward: 982.13, Avg Reward: 969.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:50,802 - TrafficRL.Train - INFO - Episode 346/500 - Reward: 991.64, Avg Reward: 992.68, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:51,035 - TrafficRL.Train - INFO - Episode 265/500 - Reward: 984.46, Avg Reward: 969.68, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:51,390 - TrafficRL.Train - INFO - Episode 266/500 - Reward: 974.38, Avg Reward: 969.53, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:51,754 - TrafficRL.Train - INFO - Episode 267/500 - Reward: 979.32, Avg Reward: 969.43, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:52,108 - TrafficRL.Train - INFO - Episode 268/500 - Reward: 965.16, Avg Reward: 969.13, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:52,453 - TrafficRL.Train - INFO - Episode 269/500 - Reward: 982.44, Avg Reward: 969.03, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:52,812 - TrafficRL.Train - INFO - Episode 270/500 - Reward: 992.93, Avg Reward: 969.01, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:53,155 - TrafficRL.Train - INFO - Episode 271/500 - Reward: 985.65, Avg Reward: 968.91, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:53,504 - TrafficRL.Train - INFO - Episode 272/500 - Reward: 995.42, Avg Reward: 968.96, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:53,717 - TrafficRL.Train - INFO - Episode 347/500 - Reward: 996.61, Avg Reward: 992.75, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:53,849 - TrafficRL.Train - INFO - Episode 273/500 - Reward: 922.82, Avg Reward: 968.25, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:54,193 - TrafficRL.Train - INFO - Episode 274/500 - Reward: 985.29, Avg Reward: 968.20, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:54,532 - TrafficRL.Train - INFO - Episode 275/500 - Reward: 982.89, Avg Reward: 968.08, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:54,542 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_275.pth
2025-03-17 17:31:54,542 - TrafficRL.Train - INFO - Model checkpoint saved at episode 275
2025-03-17 17:31:54,914 - TrafficRL.Train - INFO - Episode 276/500 - Reward: 985.10, Avg Reward: 968.03, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:55,254 - TrafficRL.Train - INFO - Episode 277/500 - Reward: 975.81, Avg Reward: 967.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:55,596 - TrafficRL.Train - INFO - Episode 278/500 - Reward: 986.66, Avg Reward: 967.91, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:55,945 - TrafficRL.Train - INFO - Episode 279/500 - Reward: 978.70, Avg Reward: 967.77, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:56,302 - TrafficRL.Train - INFO - Episode 280/500 - Reward: 982.32, Avg Reward: 967.65, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:56,302 - TrafficRL.Train - INFO - Evaluating agent at episode 280...
2025-03-17 17:31:56,634 - TrafficRL.Train - INFO - Episode 348/500 - Reward: 987.66, Avg Reward: 992.78, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:57,204 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 260368.81
2025-03-17 17:31:57,205 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-17 17:31:57,579 - TrafficRL.Train - INFO - Episode 281/500 - Reward: 994.22, Avg Reward: 967.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:57,952 - TrafficRL.Train - INFO - Episode 282/500 - Reward: 988.21, Avg Reward: 967.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:58,322 - TrafficRL.Train - INFO - Episode 283/500 - Reward: 986.71, Avg Reward: 967.58, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:58,692 - TrafficRL.Train - INFO - Episode 284/500 - Reward: 989.53, Avg Reward: 967.52, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:59,069 - TrafficRL.Train - INFO - Episode 285/500 - Reward: 971.00, Avg Reward: 967.30, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:59,434 - TrafficRL.Train - INFO - Episode 286/500 - Reward: 977.62, Avg Reward: 967.11, LR: 0.000300, Traffic: weekend
2025-03-17 17:31:59,595 - TrafficRL.Train - INFO - Episode 349/500 - Reward: 992.64, Avg Reward: 992.79, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:31:59,801 - TrafficRL.Train - INFO - Episode 287/500 - Reward: 978.10, Avg Reward: 966.94, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:00,164 - TrafficRL.Train - INFO - Episode 288/500 - Reward: 987.82, Avg Reward: 966.88, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:00,554 - TrafficRL.Train - INFO - Episode 289/500 - Reward: 979.23, Avg Reward: 966.73, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:00,890 - TrafficRL.Train - INFO - Episode 290/500 - Reward: 986.58, Avg Reward: 966.65, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:01,227 - TrafficRL.Train - INFO - Episode 291/500 - Reward: 978.72, Avg Reward: 966.48, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:01,566 - TrafficRL.Train - INFO - Episode 292/500 - Reward: 974.48, Avg Reward: 966.35, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:01,921 - TrafficRL.Train - INFO - Episode 293/500 - Reward: 991.70, Avg Reward: 966.34, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:02,275 - TrafficRL.Train - INFO - Episode 294/500 - Reward: 963.52, Avg Reward: 966.06, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:02,549 - TrafficRL.Train - INFO - Episode 350/500 - Reward: 992.88, Avg Reward: 992.80, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:02,563 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_350.pth
2025-03-17 17:32:02,563 - TrafficRL.Train - INFO - Model checkpoint saved at episode 350
2025-03-17 17:32:02,638 - TrafficRL.Train - INFO - Episode 295/500 - Reward: 979.44, Avg Reward: 965.92, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:02,986 - TrafficRL.Train - INFO - Episode 296/500 - Reward: 979.59, Avg Reward: 965.77, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:03,325 - TrafficRL.Train - INFO - Episode 297/500 - Reward: 992.34, Avg Reward: 965.74, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:03,654 - TrafficRL.Train - INFO - Episode 298/500 - Reward: 988.61, Avg Reward: 965.67, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:03,988 - TrafficRL.Train - INFO - Episode 299/500 - Reward: 989.48, Avg Reward: 965.66, LR: 0.000300, Traffic: weekend
2025-03-17 17:32:03,989 - TrafficRL.Train - INFO - Switching to uniform traffic pattern at episode 300
2025-03-17 17:32:04,327 - TrafficRL.Train - INFO - Episode 300/500 - Reward: 986.19, Avg Reward: 965.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:04,328 - TrafficRL.Train - INFO - Evaluating agent at episode 300...
2025-03-17 17:32:05,213 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 111655.72
2025-03-17 17:32:05,213 - TrafficRL.Train - INFO - No improvement for 9 evaluations
2025-03-17 17:32:05,224 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_300.pth
2025-03-17 17:32:05,224 - TrafficRL.Train - INFO - Model checkpoint saved at episode 300
2025-03-17 17:32:05,382 - TrafficRL.Train - INFO - Episode 351/500 - Reward: 992.55, Avg Reward: 992.85, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:05,605 - TrafficRL.Train - INFO - Episode 301/500 - Reward: 984.09, Avg Reward: 965.60, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:06,002 - TrafficRL.Train - INFO - Episode 302/500 - Reward: 994.03, Avg Reward: 965.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:06,336 - TrafficRL.Train - INFO - Episode 303/500 - Reward: 995.99, Avg Reward: 965.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:06,678 - TrafficRL.Train - INFO - Episode 304/500 - Reward: 991.54, Avg Reward: 965.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:07,032 - TrafficRL.Train - INFO - Episode 305/500 - Reward: 989.33, Avg Reward: 965.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:07,378 - TrafficRL.Train - INFO - Episode 306/500 - Reward: 835.84, Avg Reward: 965.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:07,715 - TrafficRL.Train - INFO - Episode 307/500 - Reward: 991.25, Avg Reward: 968.11, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:08,052 - TrafficRL.Train - INFO - Episode 308/500 - Reward: 993.53, Avg Reward: 969.09, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:08,295 - TrafficRL.Train - INFO - Episode 352/500 - Reward: 992.72, Avg Reward: 992.89, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:08,392 - TrafficRL.Train - INFO - Episode 309/500 - Reward: 989.89, Avg Reward: 969.47, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:08,735 - TrafficRL.Train - INFO - Episode 310/500 - Reward: 991.44, Avg Reward: 969.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:09,075 - TrafficRL.Train - INFO - Episode 311/500 - Reward: 993.71, Avg Reward: 972.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:09,430 - TrafficRL.Train - INFO - Episode 312/500 - Reward: 988.42, Avg Reward: 972.70, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:09,781 - TrafficRL.Train - INFO - Episode 313/500 - Reward: 992.19, Avg Reward: 972.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:10,126 - TrafficRL.Train - INFO - Episode 314/500 - Reward: 993.35, Avg Reward: 972.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:10,463 - TrafficRL.Train - INFO - Episode 315/500 - Reward: 992.36, Avg Reward: 972.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:10,797 - TrafficRL.Train - INFO - Episode 316/500 - Reward: 991.22, Avg Reward: 972.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:11,139 - TrafficRL.Train - INFO - Episode 317/500 - Reward: 991.28, Avg Reward: 973.08, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:11,156 - TrafficRL.Train - INFO - Episode 353/500 - Reward: 991.28, Avg Reward: 992.87, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:11,480 - TrafficRL.Train - INFO - Episode 318/500 - Reward: 994.69, Avg Reward: 973.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:11,825 - TrafficRL.Train - INFO - Episode 319/500 - Reward: 993.63, Avg Reward: 973.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:12,177 - TrafficRL.Train - INFO - Episode 320/500 - Reward: 994.13, Avg Reward: 973.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:12,177 - TrafficRL.Train - INFO - Evaluating agent at episode 320...
2025-03-17 17:32:13,100 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 222227.45
2025-03-17 17:32:13,101 - TrafficRL.Train - INFO - No improvement for 10 evaluations
2025-03-17 17:32:13,468 - TrafficRL.Train - INFO - Episode 321/500 - Reward: 993.55, Avg Reward: 973.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:13,819 - TrafficRL.Train - INFO - Episode 322/500 - Reward: 993.33, Avg Reward: 973.89, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:14,090 - TrafficRL.Train - INFO - Episode 354/500 - Reward: 994.63, Avg Reward: 992.94, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:14,157 - TrafficRL.Train - INFO - Episode 323/500 - Reward: 993.80, Avg Reward: 974.21, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:14,499 - TrafficRL.Train - INFO - Episode 324/500 - Reward: 993.16, Avg Reward: 974.50, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:14,853 - TrafficRL.Train - INFO - Episode 325/500 - Reward: 992.86, Avg Reward: 974.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:14,864 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_325.pth
2025-03-17 17:32:14,864 - TrafficRL.Train - INFO - Model checkpoint saved at episode 325
2025-03-17 17:32:15,215 - TrafficRL.Train - INFO - Episode 326/500 - Reward: 991.66, Avg Reward: 974.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:15,573 - TrafficRL.Train - INFO - Episode 327/500 - Reward: 988.05, Avg Reward: 978.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:15,911 - TrafficRL.Train - INFO - Episode 328/500 - Reward: 991.34, Avg Reward: 978.32, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:16,253 - TrafficRL.Train - INFO - Episode 329/500 - Reward: 990.80, Avg Reward: 978.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:16,625 - TrafficRL.Train - INFO - Episode 330/500 - Reward: 991.82, Avg Reward: 978.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:16,972 - TrafficRL.Train - INFO - Episode 331/500 - Reward: 990.39, Avg Reward: 978.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:17,041 - TrafficRL.Train - INFO - Episode 355/500 - Reward: 992.04, Avg Reward: 992.95, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:17,317 - TrafficRL.Train - INFO - Episode 332/500 - Reward: 981.39, Avg Reward: 978.57, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:17,675 - TrafficRL.Train - INFO - Episode 333/500 - Reward: 982.38, Avg Reward: 978.45, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:18,018 - TrafficRL.Train - INFO - Episode 334/500 - Reward: 991.62, Avg Reward: 978.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:18,352 - TrafficRL.Train - INFO - Episode 335/500 - Reward: 991.52, Avg Reward: 978.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:18,688 - TrafficRL.Train - INFO - Episode 336/500 - Reward: 995.99, Avg Reward: 978.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:19,017 - TrafficRL.Train - INFO - Episode 337/500 - Reward: 996.15, Avg Reward: 978.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:19,365 - TrafficRL.Train - INFO - Episode 338/500 - Reward: 989.89, Avg Reward: 979.24, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:19,709 - TrafficRL.Train - INFO - Episode 339/500 - Reward: 994.06, Avg Reward: 979.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:19,863 - TrafficRL.Train - INFO - Episode 356/500 - Reward: 995.65, Avg Reward: 993.00, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:20,047 - TrafficRL.Train - INFO - Episode 340/500 - Reward: 980.82, Avg Reward: 979.56, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:20,048 - TrafficRL.Train - INFO - Evaluating agent at episode 340...
2025-03-17 17:32:20,934 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 78237.34
2025-03-17 17:32:20,934 - TrafficRL.Train - INFO - No improvement for 11 evaluations
2025-03-17 17:32:21,303 - TrafficRL.Train - INFO - Episode 341/500 - Reward: 989.36, Avg Reward: 979.63, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:21,692 - TrafficRL.Train - INFO - Episode 342/500 - Reward: 985.26, Avg Reward: 979.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:22,048 - TrafficRL.Train - INFO - Episode 343/500 - Reward: 995.52, Avg Reward: 984.14, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:22,394 - TrafficRL.Train - INFO - Episode 344/500 - Reward: 987.69, Avg Reward: 984.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:22,761 - TrafficRL.Train - INFO - Episode 345/500 - Reward: 992.72, Avg Reward: 984.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:22,763 - TrafficRL.Train - INFO - Episode 357/500 - Reward: 993.43, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:23,095 - TrafficRL.Train - INFO - Episode 346/500 - Reward: 985.04, Avg Reward: 984.46, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:23,427 - TrafficRL.Train - INFO - Episode 347/500 - Reward: 996.61, Avg Reward: 984.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:23,760 - TrafficRL.Train - INFO - Episode 348/500 - Reward: 990.72, Avg Reward: 984.86, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:24,099 - TrafficRL.Train - INFO - Episode 349/500 - Reward: 990.70, Avg Reward: 984.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:24,441 - TrafficRL.Train - INFO - Episode 350/500 - Reward: 994.28, Avg Reward: 985.00, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:24,453 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_350.pth
2025-03-17 17:32:24,453 - TrafficRL.Train - INFO - Model checkpoint saved at episode 350
2025-03-17 17:32:24,803 - TrafficRL.Train - INFO - Episode 351/500 - Reward: 992.55, Avg Reward: 985.10, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:25,150 - TrafficRL.Train - INFO - Episode 352/500 - Reward: 990.93, Avg Reward: 985.23, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:25,484 - TrafficRL.Train - INFO - Episode 353/500 - Reward: 993.83, Avg Reward: 985.32, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:25,601 - TrafficRL.Train - INFO - Episode 358/500 - Reward: 992.68, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:25,827 - TrafficRL.Train - INFO - Episode 354/500 - Reward: 993.30, Avg Reward: 985.30, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:26,168 - TrafficRL.Train - INFO - Episode 355/500 - Reward: 994.15, Avg Reward: 985.34, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:26,512 - TrafficRL.Train - INFO - Episode 356/500 - Reward: 995.65, Avg Reward: 985.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:26,865 - TrafficRL.Train - INFO - Episode 357/500 - Reward: 993.43, Avg Reward: 985.42, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:27,236 - TrafficRL.Train - INFO - Episode 358/500 - Reward: 994.24, Avg Reward: 985.49, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:27,581 - TrafficRL.Train - INFO - Episode 359/500 - Reward: 995.54, Avg Reward: 985.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:27,912 - TrafficRL.Train - INFO - Episode 360/500 - Reward: 995.42, Avg Reward: 985.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:27,912 - TrafficRL.Train - INFO - Evaluating agent at episode 360...
2025-03-17 17:32:28,448 - TrafficRL.Train - INFO - Episode 359/500 - Reward: 995.54, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:28,802 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 94281.69
2025-03-17 17:32:28,802 - TrafficRL.Train - INFO - No improvement for 12 evaluations
2025-03-17 17:32:29,168 - TrafficRL.Train - INFO - Episode 361/500 - Reward: 993.43, Avg Reward: 985.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:29,532 - TrafficRL.Train - INFO - Episode 362/500 - Reward: 994.24, Avg Reward: 986.25, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:29,900 - TrafficRL.Train - INFO - Episode 363/500 - Reward: 993.82, Avg Reward: 986.29, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:30,262 - TrafficRL.Train - INFO - Episode 364/500 - Reward: 993.42, Avg Reward: 986.41, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:30,626 - TrafficRL.Train - INFO - Episode 365/500 - Reward: 995.12, Avg Reward: 986.51, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:30,990 - TrafficRL.Train - INFO - Episode 366/500 - Reward: 996.76, Avg Reward: 986.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:31,356 - TrafficRL.Train - INFO - Episode 367/500 - Reward: 992.96, Avg Reward: 986.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:31,443 - TrafficRL.Train - INFO - Episode 360/500 - Reward: 995.08, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:31,443 - TrafficRL.Train - INFO - Evaluating agent at episode 360...
2025-03-17 17:32:31,698 - TrafficRL.Train - INFO - Episode 368/500 - Reward: 993.48, Avg Reward: 987.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:32,034 - TrafficRL.Train - INFO - Episode 369/500 - Reward: 994.51, Avg Reward: 987.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:32,366 - TrafficRL.Train - INFO - Episode 370/500 - Reward: 994.39, Avg Reward: 987.29, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:32,694 - TrafficRL.Train - INFO - Episode 371/500 - Reward: 993.56, Avg Reward: 987.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:32,760 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 439813.07
2025-03-17 17:32:32,760 - TrafficRL.Train - INFO - No improvement for 7 evaluations
2025-03-17 17:32:33,049 - TrafficRL.Train - INFO - Episode 372/500 - Reward: 995.15, Avg Reward: 987.37, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:33,450 - TrafficRL.Train - INFO - Episode 373/500 - Reward: 994.72, Avg Reward: 988.09, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:33,787 - TrafficRL.Train - INFO - Episode 374/500 - Reward: 995.68, Avg Reward: 988.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:34,134 - TrafficRL.Train - INFO - Episode 375/500 - Reward: 995.03, Avg Reward: 988.31, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:34,147 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_375.pth
2025-03-17 17:32:34,147 - TrafficRL.Train - INFO - Model checkpoint saved at episode 375
2025-03-17 17:32:34,487 - TrafficRL.Train - INFO - Episode 376/500 - Reward: 993.87, Avg Reward: 988.40, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:34,842 - TrafficRL.Train - INFO - Episode 377/500 - Reward: 994.75, Avg Reward: 988.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:35,188 - TrafficRL.Train - INFO - Episode 378/500 - Reward: 993.53, Avg Reward: 988.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:35,526 - TrafficRL.Train - INFO - Episode 379/500 - Reward: 996.46, Avg Reward: 988.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:35,731 - TrafficRL.Train - INFO - Episode 361/500 - Reward: 990.56, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:35,862 - TrafficRL.Train - INFO - Episode 380/500 - Reward: 994.33, Avg Reward: 988.96, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:35,862 - TrafficRL.Train - INFO - Evaluating agent at episode 380...
2025-03-17 17:32:36,748 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 31230.57
2025-03-17 17:32:36,748 - TrafficRL.Train - INFO - No improvement for 13 evaluations
2025-03-17 17:32:37,122 - TrafficRL.Train - INFO - Episode 381/500 - Reward: 995.54, Avg Reward: 988.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:37,493 - TrafficRL.Train - INFO - Episode 382/500 - Reward: 993.80, Avg Reward: 989.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:37,861 - TrafficRL.Train - INFO - Episode 383/500 - Reward: 995.79, Avg Reward: 989.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:38,243 - TrafficRL.Train - INFO - Episode 384/500 - Reward: 994.00, Avg Reward: 989.16, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:38,621 - TrafficRL.Train - INFO - Episode 385/500 - Reward: 992.66, Avg Reward: 989.38, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:38,744 - TrafficRL.Train - INFO - Episode 362/500 - Reward: 994.24, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:39,008 - TrafficRL.Train - INFO - Episode 386/500 - Reward: 992.89, Avg Reward: 989.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:39,360 - TrafficRL.Train - INFO - Episode 387/500 - Reward: 993.60, Avg Reward: 989.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:39,705 - TrafficRL.Train - INFO - Episode 388/500 - Reward: 993.97, Avg Reward: 989.75, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:40,040 - TrafficRL.Train - INFO - Episode 389/500 - Reward: 994.51, Avg Reward: 989.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:40,385 - TrafficRL.Train - INFO - Episode 390/500 - Reward: 993.35, Avg Reward: 989.97, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:40,719 - TrafficRL.Train - INFO - Episode 391/500 - Reward: 994.03, Avg Reward: 990.12, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:41,077 - TrafficRL.Train - INFO - Episode 392/500 - Reward: 981.70, Avg Reward: 990.19, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:41,437 - TrafficRL.Train - INFO - Episode 393/500 - Reward: 994.83, Avg Reward: 990.22, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:41,626 - TrafficRL.Train - INFO - Episode 363/500 - Reward: 991.38, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:41,789 - TrafficRL.Train - INFO - Episode 394/500 - Reward: 996.42, Avg Reward: 990.55, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:42,151 - TrafficRL.Train - INFO - Episode 395/500 - Reward: 992.36, Avg Reward: 990.68, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:42,494 - TrafficRL.Train - INFO - Episode 396/500 - Reward: 989.36, Avg Reward: 990.78, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:42,836 - TrafficRL.Train - INFO - Episode 397/500 - Reward: 991.58, Avg Reward: 990.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:43,174 - TrafficRL.Train - INFO - Episode 398/500 - Reward: 994.38, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:43,567 - TrafficRL.Train - INFO - Episode 399/500 - Reward: 989.92, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:43,922 - TrafficRL.Train - INFO - Episode 400/500 - Reward: 994.51, Avg Reward: 990.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:43,923 - TrafficRL.Train - INFO - Evaluating agent at episode 400...
2025-03-17 17:32:44,592 - TrafficRL.Train - INFO - Episode 364/500 - Reward: 989.84, Avg Reward: 993.02, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:44,810 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 83508.44
2025-03-17 17:32:44,810 - TrafficRL.Train - INFO - No improvement for 14 evaluations
2025-03-17 17:32:44,824 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_400.pth
2025-03-17 17:32:44,824 - TrafficRL.Train - INFO - Model checkpoint saved at episode 400
2025-03-17 17:32:45,196 - TrafficRL.Train - INFO - Episode 401/500 - Reward: 995.45, Avg Reward: 991.03, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:45,554 - TrafficRL.Train - INFO - Episode 402/500 - Reward: 985.56, Avg Reward: 990.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:45,886 - TrafficRL.Train - INFO - Episode 403/500 - Reward: 991.97, Avg Reward: 990.91, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:46,221 - TrafficRL.Train - INFO - Episode 404/500 - Reward: 993.49, Avg Reward: 990.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:46,564 - TrafficRL.Train - INFO - Episode 405/500 - Reward: 992.15, Avg Reward: 990.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:46,908 - TrafficRL.Train - INFO - Episode 406/500 - Reward: 994.42, Avg Reward: 992.54, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:47,261 - TrafficRL.Train - INFO - Episode 407/500 - Reward: 996.11, Avg Reward: 992.59, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:47,537 - TrafficRL.Train - INFO - Episode 365/500 - Reward: 994.03, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:47,649 - TrafficRL.Train - INFO - Episode 408/500 - Reward: 995.72, Avg Reward: 992.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:47,989 - TrafficRL.Train - INFO - Episode 409/500 - Reward: 994.52, Avg Reward: 992.66, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:48,331 - TrafficRL.Train - INFO - Episode 410/500 - Reward: 986.71, Avg Reward: 992.61, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:48,663 - TrafficRL.Train - INFO - Episode 411/500 - Reward: 994.82, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:48,995 - TrafficRL.Train - INFO - Episode 412/500 - Reward: 994.94, Avg Reward: 992.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:49,347 - TrafficRL.Train - INFO - Episode 413/500 - Reward: 996.05, Avg Reward: 992.72, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:49,700 - TrafficRL.Train - INFO - Episode 414/500 - Reward: 994.98, Avg Reward: 992.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:50,060 - TrafficRL.Train - INFO - Episode 415/500 - Reward: 992.46, Avg Reward: 992.74, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:50,412 - TrafficRL.Train - INFO - Episode 416/500 - Reward: 990.39, Avg Reward: 992.73, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:50,442 - TrafficRL.Train - INFO - Episode 366/500 - Reward: 996.76, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:50,747 - TrafficRL.Train - INFO - Episode 417/500 - Reward: 994.79, Avg Reward: 992.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:51,083 - TrafficRL.Train - INFO - Episode 418/500 - Reward: 986.30, Avg Reward: 992.68, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:51,426 - TrafficRL.Train - INFO - Episode 419/500 - Reward: 987.44, Avg Reward: 992.62, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:51,779 - TrafficRL.Train - INFO - Episode 420/500 - Reward: 984.60, Avg Reward: 992.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:51,779 - TrafficRL.Train - INFO - Evaluating agent at episode 420...
2025-03-17 17:32:52,672 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 73353.43
2025-03-17 17:32:52,672 - TrafficRL.Train - INFO - No improvement for 15 evaluations
2025-03-17 17:32:53,053 - TrafficRL.Train - INFO - Episode 421/500 - Reward: 994.11, Avg Reward: 992.53, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:53,387 - TrafficRL.Train - INFO - Episode 367/500 - Reward: 989.11, Avg Reward: 993.01, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:53,461 - TrafficRL.Train - INFO - Episode 422/500 - Reward: 984.56, Avg Reward: 992.45, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:53,807 - TrafficRL.Train - INFO - Episode 423/500 - Reward: 994.71, Avg Reward: 992.45, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:54,147 - TrafficRL.Train - INFO - Episode 424/500 - Reward: 996.21, Avg Reward: 992.48, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:54,478 - TrafficRL.Train - INFO - Episode 425/500 - Reward: 996.83, Avg Reward: 992.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:54,492 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_425.pth
2025-03-17 17:32:54,492 - TrafficRL.Train - INFO - Model checkpoint saved at episode 425
2025-03-17 17:32:54,836 - TrafficRL.Train - INFO - Episode 426/500 - Reward: 988.05, Avg Reward: 992.49, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:55,199 - TrafficRL.Train - INFO - Episode 427/500 - Reward: 937.28, Avg Reward: 991.98, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:55,552 - TrafficRL.Train - INFO - Episode 428/500 - Reward: 988.44, Avg Reward: 991.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:55,907 - TrafficRL.Train - INFO - Episode 429/500 - Reward: 996.51, Avg Reward: 992.01, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:56,245 - TrafficRL.Train - INFO - Episode 430/500 - Reward: 993.30, Avg Reward: 992.02, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:56,347 - TrafficRL.Train - INFO - Episode 368/500 - Reward: 991.22, Avg Reward: 992.96, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:56,585 - TrafficRL.Train - INFO - Episode 431/500 - Reward: 896.44, Avg Reward: 991.08, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:56,930 - TrafficRL.Train - INFO - Episode 432/500 - Reward: 995.33, Avg Reward: 991.22, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:57,270 - TrafficRL.Train - INFO - Episode 433/500 - Reward: 986.34, Avg Reward: 991.26, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:57,619 - TrafficRL.Train - INFO - Episode 434/500 - Reward: 992.89, Avg Reward: 991.28, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:57,964 - TrafficRL.Train - INFO - Episode 435/500 - Reward: 958.85, Avg Reward: 990.95, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:58,307 - TrafficRL.Train - INFO - Episode 436/500 - Reward: 953.19, Avg Reward: 990.52, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:58,684 - TrafficRL.Train - INFO - Episode 437/500 - Reward: 987.08, Avg Reward: 990.43, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:59,028 - TrafficRL.Train - INFO - Episode 438/500 - Reward: 980.43, Avg Reward: 990.34, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:59,208 - TrafficRL.Train - INFO - Episode 369/500 - Reward: 994.51, Avg Reward: 992.99, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:32:59,372 - TrafficRL.Train - INFO - Episode 439/500 - Reward: 996.73, Avg Reward: 990.36, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:59,713 - TrafficRL.Train - INFO - Episode 440/500 - Reward: 994.96, Avg Reward: 990.50, LR: 0.000300, Traffic: uniform
2025-03-17 17:32:59,713 - TrafficRL.Train - INFO - Evaluating agent at episode 440...
2025-03-17 17:33:00,601 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 118574.15
2025-03-17 17:33:00,602 - TrafficRL.Train - INFO - No improvement for 16 evaluations
2025-03-17 17:33:00,963 - TrafficRL.Train - INFO - Episode 441/500 - Reward: 994.75, Avg Reward: 990.56, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:01,329 - TrafficRL.Train - INFO - Episode 442/500 - Reward: 995.97, Avg Reward: 990.67, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:01,694 - TrafficRL.Train - INFO - Episode 443/500 - Reward: 993.18, Avg Reward: 990.64, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:02,063 - TrafficRL.Train - INFO - Episode 444/500 - Reward: 994.05, Avg Reward: 990.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:02,113 - TrafficRL.Train - INFO - Episode 370/500 - Reward: 992.49, Avg Reward: 992.99, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:02,426 - TrafficRL.Train - INFO - Episode 445/500 - Reward: 993.07, Avg Reward: 990.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:02,791 - TrafficRL.Train - INFO - Episode 446/500 - Reward: 993.78, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:03,162 - TrafficRL.Train - INFO - Episode 447/500 - Reward: 994.88, Avg Reward: 990.78, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:03,531 - TrafficRL.Train - INFO - Episode 448/500 - Reward: 988.92, Avg Reward: 990.76, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:03,898 - TrafficRL.Train - INFO - Episode 449/500 - Reward: 994.93, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:04,261 - TrafficRL.Train - INFO - Episode 450/500 - Reward: 994.29, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:04,276 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_450.pth
2025-03-17 17:33:04,276 - TrafficRL.Train - INFO - Model checkpoint saved at episode 450
2025-03-17 17:33:04,641 - TrafficRL.Train - INFO - Episode 451/500 - Reward: 995.01, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:05,030 - TrafficRL.Train - INFO - Episode 452/500 - Reward: 995.78, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:05,191 - TrafficRL.Train - INFO - Episode 371/500 - Reward: 990.76, Avg Reward: 992.97, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:05,383 - TrafficRL.Train - INFO - Episode 453/500 - Reward: 994.43, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:05,732 - TrafficRL.Train - INFO - Episode 454/500 - Reward: 994.91, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:06,075 - TrafficRL.Train - INFO - Episode 455/500 - Reward: 993.81, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:06,432 - TrafficRL.Train - INFO - Episode 456/500 - Reward: 995.75, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:06,768 - TrafficRL.Train - INFO - Episode 457/500 - Reward: 991.38, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:07,108 - TrafficRL.Train - INFO - Episode 458/500 - Reward: 994.25, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:07,443 - TrafficRL.Train - INFO - Episode 459/500 - Reward: 996.97, Avg Reward: 990.89, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:07,783 - TrafficRL.Train - INFO - Episode 460/500 - Reward: 996.10, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:07,783 - TrafficRL.Train - INFO - Evaluating agent at episode 460...
2025-03-17 17:33:08,033 - TrafficRL.Train - INFO - Episode 372/500 - Reward: 994.39, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:08,664 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 130907.57
2025-03-17 17:33:08,664 - TrafficRL.Train - INFO - No improvement for 17 evaluations
2025-03-17 17:33:09,042 - TrafficRL.Train - INFO - Episode 461/500 - Reward: 995.26, Avg Reward: 990.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:09,398 - TrafficRL.Train - INFO - Episode 462/500 - Reward: 993.13, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:09,736 - TrafficRL.Train - INFO - Episode 463/500 - Reward: 992.37, Avg Reward: 990.89, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:10,080 - TrafficRL.Train - INFO - Episode 464/500 - Reward: 994.52, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:10,430 - TrafficRL.Train - INFO - Episode 465/500 - Reward: 994.85, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:10,775 - TrafficRL.Train - INFO - Episode 466/500 - Reward: 996.89, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:10,902 - TrafficRL.Train - INFO - Episode 373/500 - Reward: 993.15, Avg Reward: 993.02, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:11,155 - TrafficRL.Train - INFO - Episode 467/500 - Reward: 994.62, Avg Reward: 990.92, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:11,490 - TrafficRL.Train - INFO - Episode 468/500 - Reward: 991.48, Avg Reward: 990.90, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:11,824 - TrafficRL.Train - INFO - Episode 469/500 - Reward: 993.35, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:12,160 - TrafficRL.Train - INFO - Episode 470/500 - Reward: 994.09, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:12,504 - TrafficRL.Train - INFO - Episode 471/500 - Reward: 993.86, Avg Reward: 990.88, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:12,849 - TrafficRL.Train - INFO - Episode 472/500 - Reward: 993.91, Avg Reward: 990.87, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:13,200 - TrafficRL.Train - INFO - Episode 473/500 - Reward: 991.72, Avg Reward: 990.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:13,544 - TrafficRL.Train - INFO - Episode 474/500 - Reward: 993.46, Avg Reward: 990.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:13,761 - TrafficRL.Train - INFO - Episode 374/500 - Reward: 995.36, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:13,888 - TrafficRL.Train - INFO - Episode 475/500 - Reward: 995.11, Avg Reward: 990.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:13,904 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_475.pth
2025-03-17 17:33:13,904 - TrafficRL.Train - INFO - Model checkpoint saved at episode 475
2025-03-17 17:33:14,243 - TrafficRL.Train - INFO - Episode 476/500 - Reward: 993.62, Avg Reward: 990.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:14,581 - TrafficRL.Train - INFO - Episode 477/500 - Reward: 993.97, Avg Reward: 990.81, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:14,928 - TrafficRL.Train - INFO - Episode 478/500 - Reward: 992.29, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:15,277 - TrafficRL.Train - INFO - Episode 479/500 - Reward: 995.54, Avg Reward: 990.79, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:15,631 - TrafficRL.Train - INFO - Episode 480/500 - Reward: 994.33, Avg Reward: 990.79, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:15,631 - TrafficRL.Train - INFO - Evaluating agent at episode 480...
2025-03-17 17:33:16,534 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 343372.45
2025-03-17 17:33:16,549 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/best_model.pth
2025-03-17 17:33:16,549 - TrafficRL.Train - INFO - New best model saved with reward: 343372.45
2025-03-17 17:33:16,582 - TrafficRL.Train - INFO - Episode 375/500 - Reward: 994.27, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:16,597 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_375.pth
2025-03-17 17:33:16,597 - TrafficRL.Train - INFO - Model checkpoint saved at episode 375
2025-03-17 17:33:16,928 - TrafficRL.Train - INFO - Episode 481/500 - Reward: 994.99, Avg Reward: 990.78, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:17,272 - TrafficRL.Train - INFO - Episode 482/500 - Reward: 995.66, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:17,620 - TrafficRL.Train - INFO - Episode 483/500 - Reward: 993.76, Avg Reward: 990.78, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:17,962 - TrafficRL.Train - INFO - Episode 484/500 - Reward: 994.75, Avg Reward: 990.79, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:18,304 - TrafficRL.Train - INFO - Episode 485/500 - Reward: 993.49, Avg Reward: 990.80, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:18,640 - TrafficRL.Train - INFO - Episode 486/500 - Reward: 994.91, Avg Reward: 990.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:18,975 - TrafficRL.Train - INFO - Episode 487/500 - Reward: 993.70, Avg Reward: 990.82, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:19,321 - TrafficRL.Train - INFO - Episode 488/500 - Reward: 989.46, Avg Reward: 990.77, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:19,475 - TrafficRL.Train - INFO - Episode 376/500 - Reward: 993.87, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:19,666 - TrafficRL.Train - INFO - Episode 489/500 - Reward: 986.06, Avg Reward: 990.69, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:20,004 - TrafficRL.Train - INFO - Episode 490/500 - Reward: 995.17, Avg Reward: 990.71, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:20,349 - TrafficRL.Train - INFO - Episode 491/500 - Reward: 993.34, Avg Reward: 990.70, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:20,684 - TrafficRL.Train - INFO - Episode 492/500 - Reward: 996.04, Avg Reward: 990.84, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:21,024 - TrafficRL.Train - INFO - Episode 493/500 - Reward: 995.02, Avg Reward: 990.85, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:21,369 - TrafficRL.Train - INFO - Episode 494/500 - Reward: 994.44, Avg Reward: 990.83, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:21,711 - TrafficRL.Train - INFO - Episode 495/500 - Reward: 995.00, Avg Reward: 990.85, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:22,064 - TrafficRL.Train - INFO - Episode 496/500 - Reward: 994.76, Avg Reward: 990.91, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:22,303 - TrafficRL.Train - INFO - Episode 377/500 - Reward: 993.67, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:22,410 - TrafficRL.Train - INFO - Episode 497/500 - Reward: 993.67, Avg Reward: 990.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:22,754 - TrafficRL.Train - INFO - Episode 498/500 - Reward: 994.72, Avg Reward: 990.93, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:23,085 - TrafficRL.Train - INFO - Episode 499/500 - Reward: 994.63, Avg Reward: 990.98, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:23,450 - TrafficRL.Train - INFO - Episode 500/500 - Reward: 992.56, Avg Reward: 990.96, LR: 0.000300, Traffic: uniform
2025-03-17 17:33:23,450 - TrafficRL.Train - INFO - Evaluating agent at episode 500...
2025-03-17 17:33:24,335 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 5744.57
2025-03-17 17:33:24,335 - TrafficRL.Train - INFO - No improvement for 1 evaluations
2025-03-17 17:33:24,352 - TrafficRL.Agent - INFO - Model saved to results/simple_dqn/model_episode_500.pth
2025-03-17 17:33:24,352 - TrafficRL.Train - INFO - Model checkpoint saved at episode 500
2025-03-17 17:33:24,440 - TrafficRL - INFO - Training complete, visualizing results...
2025-03-17 17:33:24,580 - TrafficRL - INFO - Training visualization saved to results/simple_dqn/training_progress.png
2025-03-17 17:33:24,582 - TrafficRL - INFO - Training metrics saved to results/simple_dqn/training_metrics.json
2025-03-17 17:33:24,582 - TrafficRL - INFO - Training Summary:
2025-03-17 17:33:24,582 - TrafficRL - INFO -   Agent Type: simple_dqn
2025-03-17 17:33:24,582 - TrafficRL - INFO -   Episodes Completed: 500
2025-03-17 17:33:24,582 - TrafficRL - INFO -   Final Average Reward: 990.9583538617924
2025-03-17 17:33:24,582 - TrafficRL - INFO -   Best Model Path: results/simple_dqn/best_model.pth
2025-03-17 17:33:25,399 - TrafficRL.Train - INFO - Episode 378/500 - Reward: 990.03, Avg Reward: 993.02, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:28,194 - TrafficRL.Train - INFO - Episode 379/500 - Reward: 996.46, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:31,084 - TrafficRL.Train - INFO - Episode 380/500 - Reward: 992.70, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:31,084 - TrafficRL.Train - INFO - Evaluating agent at episode 380...
2025-03-17 17:33:32,346 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 419248.46
2025-03-17 17:33:32,346 - TrafficRL.Train - INFO - No improvement for 8 evaluations
2025-03-17 17:33:35,241 - TrafficRL.Train - INFO - Episode 381/500 - Reward: 995.10, Avg Reward: 993.12, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:38,146 - TrafficRL.Train - INFO - Episode 382/500 - Reward: 991.46, Avg Reward: 993.09, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:41,061 - TrafficRL.Train - INFO - Episode 383/500 - Reward: 995.41, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:43,825 - TrafficRL.Train - INFO - Episode 384/500 - Reward: 991.67, Avg Reward: 993.13, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:46,623 - TrafficRL.Train - INFO - Episode 385/500 - Reward: 992.66, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:49,356 - TrafficRL.Train - INFO - Episode 386/500 - Reward: 989.18, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:52,063 - TrafficRL.Train - INFO - Episode 387/500 - Reward: 993.60, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:54,787 - TrafficRL.Train - INFO - Episode 388/500 - Reward: 993.97, Avg Reward: 993.07, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:33:57,609 - TrafficRL.Train - INFO - Episode 389/500 - Reward: 992.54, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:00,247 - TrafficRL.Train - INFO - Episode 390/500 - Reward: 990.40, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:02,948 - TrafficRL.Train - INFO - Episode 391/500 - Reward: 994.03, Avg Reward: 993.11, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:05,641 - TrafficRL.Train - INFO - Episode 392/500 - Reward: 992.37, Avg Reward: 993.13, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:08,438 - TrafficRL.Train - INFO - Episode 393/500 - Reward: 995.39, Avg Reward: 993.14, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:11,284 - TrafficRL.Train - INFO - Episode 394/500 - Reward: 996.42, Avg Reward: 993.14, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:13,917 - TrafficRL.Train - INFO - Episode 395/500 - Reward: 987.93, Avg Reward: 993.07, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:16,569 - TrafficRL.Train - INFO - Episode 396/500 - Reward: 992.01, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:19,224 - TrafficRL.Train - INFO - Episode 397/500 - Reward: 993.21, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:22,037 - TrafficRL.Train - INFO - Episode 398/500 - Reward: 994.72, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:24,899 - TrafficRL.Train - INFO - Episode 399/500 - Reward: 992.33, Avg Reward: 993.09, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:27,867 - TrafficRL.Train - INFO - Episode 400/500 - Reward: 992.55, Avg Reward: 993.11, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:27,867 - TrafficRL.Train - INFO - Evaluating agent at episode 400...
2025-03-17 17:34:29,174 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 444661.69
2025-03-17 17:34:29,174 - TrafficRL.Train - INFO - No improvement for 9 evaluations
2025-03-17 17:34:29,192 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_400.pth
2025-03-17 17:34:29,192 - TrafficRL.Train - INFO - Model checkpoint saved at episode 400
2025-03-17 17:34:32,151 - TrafficRL.Train - INFO - Episode 401/500 - Reward: 995.45, Avg Reward: 993.13, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:35,099 - TrafficRL.Train - INFO - Episode 402/500 - Reward: 989.73, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:37,992 - TrafficRL.Train - INFO - Episode 403/500 - Reward: 993.31, Avg Reward: 993.05, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:40,911 - TrafficRL.Train - INFO - Episode 404/500 - Reward: 990.66, Avg Reward: 993.01, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:43,967 - TrafficRL.Train - INFO - Episode 405/500 - Reward: 994.74, Avg Reward: 993.06, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:47,001 - TrafficRL.Train - INFO - Episode 406/500 - Reward: 993.08, Avg Reward: 993.04, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:50,003 - TrafficRL.Train - INFO - Episode 407/500 - Reward: 996.11, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:52,854 - TrafficRL.Train - INFO - Episode 408/500 - Reward: 995.30, Avg Reward: 993.08, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:55,828 - TrafficRL.Train - INFO - Episode 409/500 - Reward: 992.94, Avg Reward: 993.11, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:34:58,745 - TrafficRL.Train - INFO - Episode 410/500 - Reward: 989.90, Avg Reward: 993.10, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:01,665 - TrafficRL.Train - INFO - Episode 411/500 - Reward: 993.22, Avg Reward: 993.09, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:04,520 - TrafficRL.Train - INFO - Episode 412/500 - Reward: 993.61, Avg Reward: 993.14, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:07,460 - TrafficRL.Train - INFO - Episode 413/500 - Reward: 996.02, Avg Reward: 993.18, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:10,357 - TrafficRL.Train - INFO - Episode 414/500 - Reward: 995.14, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:13,111 - TrafficRL.Train - INFO - Episode 415/500 - Reward: 994.22, Avg Reward: 993.21, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:15,954 - TrafficRL.Train - INFO - Episode 416/500 - Reward: 993.67, Avg Reward: 993.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:18,914 - TrafficRL.Train - INFO - Episode 417/500 - Reward: 995.58, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:21,732 - TrafficRL.Train - INFO - Episode 418/500 - Reward: 991.91, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:24,635 - TrafficRL.Train - INFO - Episode 419/500 - Reward: 990.64, Avg Reward: 993.20, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:27,492 - TrafficRL.Train - INFO - Episode 420/500 - Reward: 993.56, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:27,492 - TrafficRL.Train - INFO - Evaluating agent at episode 420...
2025-03-17 17:35:28,755 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 310424.01
2025-03-17 17:35:28,755 - TrafficRL.Train - INFO - No improvement for 10 evaluations
2025-03-17 17:35:31,562 - TrafficRL.Train - INFO - Episode 421/500 - Reward: 994.86, Avg Reward: 993.20, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:34,325 - TrafficRL.Train - INFO - Episode 422/500 - Reward: 989.27, Avg Reward: 993.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:37,119 - TrafficRL.Train - INFO - Episode 423/500 - Reward: 993.56, Avg Reward: 993.16, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:39,900 - TrafficRL.Train - INFO - Episode 424/500 - Reward: 996.21, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:42,774 - TrafficRL.Train - INFO - Episode 425/500 - Reward: 996.83, Avg Reward: 993.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:42,793 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_425.pth
2025-03-17 17:35:42,793 - TrafficRL.Train - INFO - Model checkpoint saved at episode 425
2025-03-17 17:35:45,626 - TrafficRL.Train - INFO - Episode 426/500 - Reward: 991.25, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:48,507 - TrafficRL.Train - INFO - Episode 427/500 - Reward: 995.92, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:51,296 - TrafficRL.Train - INFO - Episode 428/500 - Reward: 991.17, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:54,084 - TrafficRL.Train - INFO - Episode 429/500 - Reward: 996.51, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:56,897 - TrafficRL.Train - INFO - Episode 430/500 - Reward: 993.30, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:35:59,653 - TrafficRL.Train - INFO - Episode 431/500 - Reward: 995.95, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:02,526 - TrafficRL.Train - INFO - Episode 432/500 - Reward: 995.77, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:05,481 - TrafficRL.Train - INFO - Episode 433/500 - Reward: 995.59, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:08,197 - TrafficRL.Train - INFO - Episode 434/500 - Reward: 994.90, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:10,811 - TrafficRL.Train - INFO - Episode 435/500 - Reward: 994.22, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:13,405 - TrafficRL.Train - INFO - Episode 436/500 - Reward: 987.45, Avg Reward: 993.31, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:16,287 - TrafficRL.Train - INFO - Episode 437/500 - Reward: 992.91, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:19,055 - TrafficRL.Train - INFO - Episode 438/500 - Reward: 990.58, Avg Reward: 993.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:21,814 - TrafficRL.Train - INFO - Episode 439/500 - Reward: 996.73, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:24,655 - TrafficRL.Train - INFO - Episode 440/500 - Reward: 993.90, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:24,655 - TrafficRL.Train - INFO - Evaluating agent at episode 440...
2025-03-17 17:36:25,920 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 353584.86
2025-03-17 17:36:25,921 - TrafficRL.Train - INFO - No improvement for 11 evaluations
2025-03-17 17:36:28,708 - TrafficRL.Train - INFO - Episode 441/500 - Reward: 993.15, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:31,462 - TrafficRL.Train - INFO - Episode 442/500 - Reward: 995.94, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:34,234 - TrafficRL.Train - INFO - Episode 443/500 - Reward: 989.96, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:37,016 - TrafficRL.Train - INFO - Episode 444/500 - Reward: 992.11, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:39,836 - TrafficRL.Train - INFO - Episode 445/500 - Reward: 988.67, Avg Reward: 993.18, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:42,970 - TrafficRL.Train - INFO - Episode 446/500 - Reward: 993.78, Avg Reward: 993.20, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:45,964 - TrafficRL.Train - INFO - Episode 447/500 - Reward: 994.88, Avg Reward: 993.19, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:48,905 - TrafficRL.Train - INFO - Episode 448/500 - Reward: 992.95, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:51,876 - TrafficRL.Train - INFO - Episode 449/500 - Reward: 993.72, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:54,617 - TrafficRL.Train - INFO - Episode 450/500 - Reward: 994.29, Avg Reward: 993.26, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:36:54,636 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_450.pth
2025-03-17 17:36:54,636 - TrafficRL.Train - INFO - Model checkpoint saved at episode 450
2025-03-17 17:36:57,448 - TrafficRL.Train - INFO - Episode 451/500 - Reward: 993.61, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:00,149 - TrafficRL.Train - INFO - Episode 452/500 - Reward: 995.62, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:02,955 - TrafficRL.Train - INFO - Episode 453/500 - Reward: 992.55, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:05,904 - TrafficRL.Train - INFO - Episode 454/500 - Reward: 994.91, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:08,653 - TrafficRL.Train - INFO - Episode 455/500 - Reward: 991.93, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:11,289 - TrafficRL.Train - INFO - Episode 456/500 - Reward: 995.75, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:13,914 - TrafficRL.Train - INFO - Episode 457/500 - Reward: 993.81, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:16,505 - TrafficRL.Train - INFO - Episode 458/500 - Reward: 992.45, Avg Reward: 993.32, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:19,088 - TrafficRL.Train - INFO - Episode 459/500 - Reward: 996.97, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:21,682 - TrafficRL.Train - INFO - Episode 460/500 - Reward: 996.06, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:21,682 - TrafficRL.Train - INFO - Evaluating agent at episode 460...
2025-03-17 17:37:22,920 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 529937.82
2025-03-17 17:37:22,920 - TrafficRL.Train - INFO - No improvement for 12 evaluations
2025-03-17 17:37:25,632 - TrafficRL.Train - INFO - Episode 461/500 - Reward: 995.26, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:28,490 - TrafficRL.Train - INFO - Episode 462/500 - Reward: 988.78, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:31,390 - TrafficRL.Train - INFO - Episode 463/500 - Reward: 988.37, Avg Reward: 993.31, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:34,271 - TrafficRL.Train - INFO - Episode 464/500 - Reward: 992.81, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:37,133 - TrafficRL.Train - INFO - Episode 465/500 - Reward: 993.75, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:39,982 - TrafficRL.Train - INFO - Episode 466/500 - Reward: 996.89, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:42,865 - TrafficRL.Train - INFO - Episode 467/500 - Reward: 992.95, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:45,716 - TrafficRL.Train - INFO - Episode 468/500 - Reward: 993.17, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:48,565 - TrafficRL.Train - INFO - Episode 469/500 - Reward: 990.60, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:51,484 - TrafficRL.Train - INFO - Episode 470/500 - Reward: 991.96, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:54,328 - TrafficRL.Train - INFO - Episode 471/500 - Reward: 993.86, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:37:57,222 - TrafficRL.Train - INFO - Episode 472/500 - Reward: 991.16, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:00,030 - TrafficRL.Train - INFO - Episode 473/500 - Reward: 986.55, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:02,870 - TrafficRL.Train - INFO - Episode 474/500 - Reward: 991.40, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:05,774 - TrafficRL.Train - INFO - Episode 475/500 - Reward: 994.03, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:05,796 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_475.pth
2025-03-17 17:38:05,796 - TrafficRL.Train - INFO - Model checkpoint saved at episode 475
2025-03-17 17:38:08,648 - TrafficRL.Train - INFO - Episode 476/500 - Reward: 990.52, Avg Reward: 993.21, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:11,485 - TrafficRL.Train - INFO - Episode 477/500 - Reward: 993.97, Avg Reward: 993.21, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:14,335 - TrafficRL.Train - INFO - Episode 478/500 - Reward: 992.29, Avg Reward: 993.23, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:17,236 - TrafficRL.Train - INFO - Episode 479/500 - Reward: 995.54, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:20,082 - TrafficRL.Train - INFO - Episode 480/500 - Reward: 994.33, Avg Reward: 993.24, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:20,082 - TrafficRL.Train - INFO - Evaluating agent at episode 480...
2025-03-17 17:38:21,354 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 405673.00
2025-03-17 17:38:21,354 - TrafficRL.Train - INFO - No improvement for 13 evaluations
2025-03-17 17:38:24,210 - TrafficRL.Train - INFO - Episode 481/500 - Reward: 993.44, Avg Reward: 993.22, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:27,065 - TrafficRL.Train - INFO - Episode 482/500 - Reward: 995.82, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:29,929 - TrafficRL.Train - INFO - Episode 483/500 - Reward: 993.76, Avg Reward: 993.25, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:32,932 - TrafficRL.Train - INFO - Episode 484/500 - Reward: 993.68, Avg Reward: 993.27, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:35,684 - TrafficRL.Train - INFO - Episode 485/500 - Reward: 993.49, Avg Reward: 993.28, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:38,656 - TrafficRL.Train - INFO - Episode 486/500 - Reward: 993.91, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:41,536 - TrafficRL.Train - INFO - Episode 487/500 - Reward: 991.31, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:44,540 - TrafficRL.Train - INFO - Episode 488/500 - Reward: 992.25, Avg Reward: 993.29, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:47,593 - TrafficRL.Train - INFO - Episode 489/500 - Reward: 994.13, Avg Reward: 993.30, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:50,611 - TrafficRL.Train - INFO - Episode 490/500 - Reward: 994.17, Avg Reward: 993.34, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:53,733 - TrafficRL.Train - INFO - Episode 491/500 - Reward: 993.34, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:56,602 - TrafficRL.Train - INFO - Episode 492/500 - Reward: 995.87, Avg Reward: 993.37, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:38:59,351 - TrafficRL.Train - INFO - Episode 493/500 - Reward: 993.43, Avg Reward: 993.35, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:01,986 - TrafficRL.Train - INFO - Episode 494/500 - Reward: 994.44, Avg Reward: 993.33, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:04,655 - TrafficRL.Train - INFO - Episode 495/500 - Reward: 994.54, Avg Reward: 993.39, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:07,688 - TrafficRL.Train - INFO - Episode 496/500 - Reward: 993.81, Avg Reward: 993.41, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:10,309 - TrafficRL.Train - INFO - Episode 497/500 - Reward: 993.67, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:13,069 - TrafficRL.Train - INFO - Episode 498/500 - Reward: 993.25, Avg Reward: 993.40, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:15,831 - TrafficRL.Train - INFO - Episode 499/500 - Reward: 994.63, Avg Reward: 993.42, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:18,630 - TrafficRL.Train - INFO - Episode 500/500 - Reward: 988.31, Avg Reward: 993.38, Epsilon: 0.0100, LR: 0.000000, Traffic: uniform
2025-03-17 17:39:18,630 - TrafficRL.Train - INFO - Evaluating agent at episode 500...
2025-03-17 17:39:19,894 - TrafficRL.Train - INFO - Evaluation - Avg Reward: 483990.25
2025-03-17 17:39:19,895 - TrafficRL.Train - INFO - No improvement for 14 evaluations
2025-03-17 17:39:19,917 - TrafficRL.Agent - INFO - Model saved to results/training/model_episode_500.pth
2025-03-17 17:39:19,918 - TrafficRL.Train - INFO - Model checkpoint saved at episode 500
2025-03-17 17:39:20,019 - TrafficRL - INFO - Training complete, visualizing results...
2025-03-17 17:39:20,150 - TrafficRL - INFO - Training visualization saved to results/training/training_progress.png
2025-03-17 17:39:20,153 - TrafficRL - INFO - Training metrics saved to results/training/training_metrics.json
2025-03-17 17:39:20,153 - TrafficRL - INFO - Training Summary:
2025-03-17 17:39:20,153 - TrafficRL - INFO -   Agent Type: dqn
2025-03-17 17:39:20,153 - TrafficRL - INFO -   Episodes Completed: 500
2025-03-17 17:39:20,153 - TrafficRL - INFO -   Final Average Reward: 993.3825157905356
2025-03-17 17:39:20,153 - TrafficRL - INFO -   Best Model Path: results/training/best_model.pth
2025-03-17 17:42:04,105 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:42:04,105 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:42:04,105 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:42:04,106 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:42:04,106 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:42:04,106 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:42:04,106 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:42:05,380 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:42:05,381 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:42:05,381 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:42:05,381 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:42:05,381 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:42:05,381 - TrafficRL - WARNING - Traffic pattern 'heavy_ns' not found in config. Using uniform.
2025-03-17 17:43:17,678 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:43:17,679 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:43:17,679 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:43:17,679 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:43:17,679 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:43:17,679 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:43:17,679 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:43:18,950 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:43:18,950 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:43:18,950 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:43:18,950 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:43:18,950 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:43:18,951 - TrafficRL - WARNING - Traffic pattern 'heavy_ns' not found in config. Using uniform.
2025-03-17 17:43:20,201 - TrafficRL - INFO - Benchmark results for FixedTiming on heavy_ns:
2025-03-17 17:43:20,202 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:43:20,202 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:43:20,202 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:43:20,202 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:43:20,202 - TrafficRL - WARNING - Traffic pattern 'heavy_ew' not found in config. Using uniform.
2025-03-17 17:43:21,454 - TrafficRL - INFO - Benchmark results for FixedTiming on heavy_ew:
2025-03-17 17:43:21,455 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:43:21,455 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:43:21,455 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:43:21,455 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:43:22,709 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:43:22,709 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:43:22,709 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:43:22,709 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:43:22,709 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:43:22,710 - TrafficRL - WARNING - Traffic pattern 'heavy_ns' not found in config. Using uniform.
2025-03-17 17:43:23,970 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on heavy_ns:
2025-03-17 17:43:23,971 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:43:23,971 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:43:23,971 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:43:23,971 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:43:23,971 - TrafficRL - WARNING - Traffic pattern 'heavy_ew' not found in config. Using uniform.
2025-03-17 17:43:25,228 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on heavy_ew:
2025-03-17 17:43:25,228 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:43:25,228 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:43:25,228 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:43:25,228 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:43:26,534 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 17:43:26,534 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:43:26,534 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 17:43:26,534 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 17:43:26,534 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:43:26,534 - TrafficRL - WARNING - Traffic pattern 'heavy_ns' not found in config. Using uniform.
2025-03-17 17:43:27,825 - TrafficRL - INFO - Benchmark results for Random on heavy_ns:
2025-03-17 17:43:27,826 - TrafficRL - INFO -   Average Reward: 239704.65 ± 80987.16
2025-03-17 17:43:27,826 - TrafficRL - INFO -   Average Waiting Time: 176.79
2025-03-17 17:43:27,826 - TrafficRL - INFO -   Average Throughput: 10552163.38
2025-03-17 17:43:27,826 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:43:27,826 - TrafficRL - WARNING - Traffic pattern 'heavy_ew' not found in config. Using uniform.
2025-03-17 17:43:29,098 - TrafficRL - INFO - Benchmark results for Random on heavy_ew:
2025-03-17 17:43:29,099 - TrafficRL - INFO -   Average Reward: 231186.10 ± 59279.09
2025-03-17 17:43:29,099 - TrafficRL - INFO -   Average Waiting Time: 180.54
2025-03-17 17:43:29,099 - TrafficRL - INFO -   Average Throughput: 10484512.80
2025-03-17 17:43:29,099 - TrafficRL - INFO -   Action Distribution: NS=49.6%, EW=50.4%
2025-03-17 17:43:29,104 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_174317/benchmark_results.json
2025-03-17 17:43:31,820 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_174317/plots
2025-03-17 17:43:31,820 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:43:31,820 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 17:43:31,820 - TrafficRL - INFO -   FixedTiming_heavy_ns: Reward=262140.62, Waiting=175.25
2025-03-17 17:43:31,820 - TrafficRL - INFO -   FixedTiming_heavy_ew: Reward=262140.62, Waiting=175.25
2025-03-17 17:43:31,820 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 17:43:31,820 - TrafficRL - INFO -   AdaptiveTiming_heavy_ns: Reward=248331.34, Waiting=184.56
2025-03-17 17:43:31,820 - TrafficRL - INFO -   AdaptiveTiming_heavy_ew: Reward=248331.34, Waiting=184.56
2025-03-17 17:43:31,820 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 17:43:31,820 - TrafficRL - INFO -   Random_heavy_ns: Reward=239704.65, Waiting=176.79
2025-03-17 17:43:31,821 - TrafficRL - INFO -   Random_heavy_ew: Reward=231186.10, Waiting=180.54
2025-03-17 17:46:32,232 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:46:32,232 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:46:32,232 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:46:32,232 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:46:32,232 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:46:32,232 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:46:32,233 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:46:33,510 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:46:33,511 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:46:33,511 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:46:33,511 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:46:33,511 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:46:34,714 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:46:34,714 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 17:46:34,714 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 17:46:34,714 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 17:46:34,714 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:46:35,975 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:46:35,975 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:46:35,975 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:46:35,975 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:46:35,975 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:46:37,174 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:46:37,175 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 17:46:37,175 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 17:46:37,175 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 17:46:37,175 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:46:38,446 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 17:46:38,447 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:46:38,447 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 17:46:38,447 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 17:46:38,447 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:46:39,672 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:46:39,672 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 17:46:39,672 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 17:46:39,672 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 17:46:39,672 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:46:39,677 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_174632/benchmark_results.json
2025-03-17 17:46:42,075 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_174632/plots
2025-03-17 17:46:42,076 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:46:42,076 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 17:46:42,076 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 17:46:42,076 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 17:46:42,076 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 17:46:42,076 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 17:46:42,076 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 17:50:57,425 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:50:57,425 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:50:57,425 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:50:57,425 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:50:57,425 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:50:57,425 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:50:57,425 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:50:58,690 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:50:58,691 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:50:58,691 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:50:58,691 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:50:58,691 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:50:59,885 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:50:59,885 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 17:50:59,885 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 17:50:59,885 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 17:50:59,885 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:51:01,162 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:51:01,163 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:51:01,163 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:51:01,163 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:51:01,163 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:51:02,399 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:51:02,399 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 17:51:02,399 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 17:51:02,399 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 17:51:02,399 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:51:03,692 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 17:51:03,692 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:51:03,692 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 17:51:03,692 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 17:51:03,693 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:51:04,919 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:51:04,919 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 17:51:04,919 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 17:51:04,919 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 17:51:04,919 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:51:04,925 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_175057/benchmark_results.json
2025-03-17 17:51:07,334 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_175057/plots
2025-03-17 17:51:07,334 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:51:07,334 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 17:51:07,334 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 17:51:07,334 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 17:51:07,334 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 17:51:07,334 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 17:51:07,334 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 17:51:13,845 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:51:13,845 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:51:13,845 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:51:13,845 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:51:13,845 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:51:13,845 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:51:13,845 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:51:15,108 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:51:15,108 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:51:15,108 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:51:15,108 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:51:15,109 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:51:16,309 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:51:16,309 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 17:51:16,309 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 17:51:16,309 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 17:51:16,309 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:51:17,617 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:51:17,617 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:51:17,617 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:51:17,617 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:51:17,617 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:51:18,830 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:51:18,830 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 17:51:18,830 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 17:51:18,830 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 17:51:18,830 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:51:20,120 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 17:51:20,120 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:51:20,120 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 17:51:20,120 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 17:51:20,120 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:51:21,349 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:51:21,349 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 17:51:21,349 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 17:51:21,349 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 17:51:21,349 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:51:21,354 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_175113/benchmark_results.json
2025-03-17 17:51:23,758 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_175113/plots
2025-03-17 17:51:23,758 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:51:23,758 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 17:51:23,758 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 17:51:23,758 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 17:51:23,758 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 17:51:23,758 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 17:51:23,758 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 17:52:58,407 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:52:58,407 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:52:58,407 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:52:58,407 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:52:58,408 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:52:58,408 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:52:58,408 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:54:07,144 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:54:07,144 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:54:07,145 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:54:07,145 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:54:07,145 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:54:07,145 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:54:07,145 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:55:11,876 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:55:11,876 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:55:11,876 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:55:11,876 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:55:11,876 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:55:11,876 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:55:11,876 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:55:11,876 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:55:11,876 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 17:55:19,213 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:55:19,214 - TrafficRL.Config - ERROR - Error loading configuration from configs/benchmark_config.yaml: Expecting value: line 1 column 1 (char 0)
2025-03-17 17:55:19,214 - TrafficRL.Config - INFO - Falling back to default configuration
2025-03-17 17:55:19,214 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:55:19,214 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:55:19,214 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:55:19,214 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:55:19,214 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:55:19,214 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 17:56:58,712 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:56:58,714 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 17:56:58,714 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 17:56:58,714 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:56:58,714 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:56:58,714 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:56:58,714 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:56:58,714 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:56:58,714 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 17:56:59,409 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 17:56:59,412 - TrafficRL.Agent - ERROR - Error loading model components: Error(s) in loading state_dict for DQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc1.weight: copying a param with shape torch.Size([64, 80]) from checkpoint, the shape in current model is torch.Size([128, 80]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([64, 64]) from checkpoint, the shape in current model is torch.Size([128, 128]).
	size mismatch for fc2.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([64]).
2025-03-17 17:56:59,413 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:57:58,303 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 17:57:58,305 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 17:57:58,305 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 17:57:58,306 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 17:57:58,306 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 17:57:58,306 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:57:58,306 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 17:57:58,306 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:57:58,306 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 17:57:58,676 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 17:57:58,679 - TrafficRL.Agent - ERROR - Error loading model components: Error(s) in loading state_dict for DQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 17:57:58,680 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 17:57:58,680 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 17:57:58,685 - TrafficRL.Agent - ERROR - Error loading model components: 'model_state_dict'
2025-03-17 17:57:58,686 - TrafficRL - ERROR - Failed to load SimpleDQN model from results/simple_dqn/best_model.pth
2025-03-17 17:57:58,686 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 17:57:58,686 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 17:57:58,687 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 17:57:58,687 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 17:57:59,802 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 17:57:59,802 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 17:57:59,802 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 17:57:59,802 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 17:57:59,802 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:58:00,851 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 17:58:00,852 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 17:58:00,852 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 17:58:00,852 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 17:58:00,852 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 17:58:01,944 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 17:58:01,944 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 17:58:01,944 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 17:58:01,944 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 17:58:01,944 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 17:58:03,031 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 17:58:03,031 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 17:58:03,031 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 17:58:03,031 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 17:58:03,031 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 17:58:04,135 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 17:58:04,135 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 17:58:04,135 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 17:58:04,135 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 17:58:04,135 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:58:05,199 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 17:58:05,199 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 17:58:05,199 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 17:58:05,199 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 17:58:05,199 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 17:58:06,706 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 17:58:06,706 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 17:58:06,706 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 17:58:06,706 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 17:58:06,706 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 17:58:08,197 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 17:58:08,197 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 17:58:08,197 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 17:58:08,197 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 17:58:08,197 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 17:58:08,205 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_175758/benchmark_results.json
2025-03-17 17:58:10,882 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_175758/plots
2025-03-17 17:58:10,882 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 17:58:10,882 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 17:58:10,882 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 17:58:10,882 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 17:58:10,882 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 17:58:10,882 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 17:58:10,882 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 17:58:10,882 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 17:58:10,882 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 18:00:03,448 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 18:00:03,451 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 18:00:03,451 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 18:00:03,451 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 18:00:03,451 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 18:00:03,451 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:00:03,452 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 18:00:03,452 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:00:03,452 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 18:00:03,838 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 18:00:03,841 - TrafficRL.Agent - ERROR - Error loading model components: Error(s) in loading state_dict for DQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:00:03,841 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 18:00:03,841 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:00:03,849 - TrafficRL.Agent - ERROR - Error loading model components: 'model_state_dict'
2025-03-17 18:00:03,850 - TrafficRL - ERROR - Failed to load SimpleDQN model from results/simple_dqn/best_model.pth
2025-03-17 18:00:03,850 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:00:03,850 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 18:00:03,851 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 18:00:03,851 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 18:00:05,139 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 18:00:05,139 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 18:00:05,139 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 18:00:05,139 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 18:00:05,139 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:00:06,353 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 18:00:06,353 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 18:00:06,353 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 18:00:06,353 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 18:00:06,354 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:00:07,623 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 18:00:07,623 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 18:00:07,623 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 18:00:07,623 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 18:00:07,623 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 18:00:08,823 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 18:00:08,824 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 18:00:08,824 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 18:00:08,824 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 18:00:08,824 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 18:00:10,106 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 18:00:10,106 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 18:00:10,106 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 18:00:10,106 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 18:00:10,106 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:00:11,332 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 18:00:11,332 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 18:00:11,332 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 18:00:11,332 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 18:00:11,332 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:00:13,043 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 18:00:13,043 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 18:00:13,043 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 18:00:13,043 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 18:00:13,043 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 18:00:14,727 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 18:00:14,727 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 18:00:14,727 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 18:00:14,728 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 18:00:14,728 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 18:00:14,735 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_180003/benchmark_results.json
2025-03-17 18:00:17,267 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_180003/plots
2025-03-17 18:00:17,267 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 18:00:17,267 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 18:00:17,267 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 18:00:17,268 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 18:00:17,268 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 18:00:17,268 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 18:00:17,268 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 18:00:17,268 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 18:00:17,268 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 18:03:03,556 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 18:03:03,558 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 18:03:03,558 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 18:03:03,559 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 18:03:03,559 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 18:03:03,559 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:03:03,559 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 18:03:03,559 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:03:03,559 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 18:03:03,932 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 18:03:03,935 - TrafficRL.Agent - WARNING - Error loading local network: Error(s) in loading state_dict for DQN:
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:03:03,935 - TrafficRL.Agent - INFO - Detected architecture: input=80, hidden=64, output=2
2025-03-17 18:03:03,936 - TrafficRL.Agent - ERROR - Failed to load with adjusted architecture: Error(s) in loading state_dict for DQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:03:03,936 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 18:03:03,936 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:03:03,942 - TrafficRL.Agent - INFO - Model loaded successfully from results/simple_dqn/best_model.pth
2025-03-17 18:03:03,942 - TrafficRL - INFO - SimpleDQN agent loaded successfully
2025-03-17 18:03:03,942 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:03:03,943 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 18:03:03,944 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 18:03:03,944 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 18:03:05,060 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 18:03:05,060 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 18:03:05,060 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 18:03:05,060 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 18:03:05,060 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:03:06,113 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 18:03:06,113 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 18:03:06,114 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 18:03:06,114 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 18:03:06,114 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:03:07,209 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 18:03:07,209 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 18:03:07,209 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 18:03:07,209 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 18:03:07,209 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 18:03:08,250 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 18:03:08,250 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 18:03:08,250 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 18:03:08,250 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 18:03:08,250 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 18:03:09,398 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 18:03:09,398 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 18:03:09,398 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 18:03:09,398 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 18:03:09,398 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:03:10,464 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 18:03:10,465 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 18:03:10,465 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 18:03:10,465 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 18:03:10,465 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:03:11,910 - TrafficRL - INFO - Benchmark results for SimpleDQN on uniform:
2025-03-17 18:03:11,910 - TrafficRL - INFO -   Average Reward: 318779.41 ± 52435.04
2025-03-17 18:03:11,910 - TrafficRL - INFO -   Average Waiting Time: 148.71
2025-03-17 18:03:11,910 - TrafficRL - INFO -   Average Throughput: 11295854.39
2025-03-17 18:03:11,910 - TrafficRL - INFO -   Action Distribution: NS=69.6%, EW=30.4%
2025-03-17 18:03:13,316 - TrafficRL - INFO - Benchmark results for SimpleDQN on rush_hour:
2025-03-17 18:03:13,317 - TrafficRL - INFO -   Average Reward: 46694.47 ± 16033.16
2025-03-17 18:03:13,317 - TrafficRL - INFO -   Average Waiting Time: 234.53
2025-03-17 18:03:13,317 - TrafficRL - INFO -   Average Throughput: 8446500.97
2025-03-17 18:03:13,317 - TrafficRL - INFO -   Action Distribution: NS=47.1%, EW=52.9%
2025-03-17 18:03:14,855 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 18:03:14,855 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 18:03:14,855 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 18:03:14,855 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 18:03:14,855 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 18:03:16,385 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 18:03:16,385 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 18:03:16,385 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 18:03:16,385 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 18:03:16,385 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 18:03:16,392 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_180303/benchmark_results.json
2025-03-17 18:03:19,161 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_180303/plots
2025-03-17 18:03:19,161 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 18:03:19,161 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 18:03:19,161 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 18:03:19,161 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 18:03:19,161 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 18:03:19,162 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 18:03:19,162 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 18:03:19,162 - TrafficRL - INFO -   SimpleDQN_uniform: Reward=318779.41, Waiting=148.71
2025-03-17 18:03:19,162 - TrafficRL - INFO -   SimpleDQN_rush_hour: Reward=46694.47, Waiting=234.53
2025-03-17 18:03:19,162 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 18:03:19,162 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 18:05:38,818 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 18:05:38,820 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 18:05:38,820 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 18:05:38,820 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 18:05:38,820 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 18:05:38,820 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:05:38,821 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 18:05:38,821 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:05:38,821 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 18:05:39,192 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 18:05:39,195 - TrafficRL.Agent - WARNING - Error loading local network: Error(s) in loading state_dict for DQN:
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:05:39,195 - TrafficRL.Agent - INFO - Detected architecture: input=80, hidden=64, output=2
2025-03-17 18:05:39,196 - TrafficRL.Agent - ERROR - Failed to load with adjusted architecture: Error(s) in loading state_dict for DQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:05:39,196 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 18:05:39,196 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:05:39,202 - TrafficRL.Agent - INFO - Model loaded successfully from results/simple_dqn/best_model.pth
2025-03-17 18:05:39,202 - TrafficRL - INFO - SimpleDQN agent loaded successfully
2025-03-17 18:05:39,202 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:05:39,202 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 18:05:39,203 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 18:05:39,203 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 18:05:40,335 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 18:05:40,335 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 18:05:40,335 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 18:05:40,335 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 18:05:40,335 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:05:41,421 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 18:05:41,421 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 18:05:41,421 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 18:05:41,421 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 18:05:41,421 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:05:42,538 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 18:05:42,538 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 18:05:42,538 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 18:05:42,538 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 18:05:42,539 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 18:05:43,620 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 18:05:43,620 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 18:05:43,620 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 18:05:43,620 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 18:05:43,621 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 18:05:44,735 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 18:05:44,735 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 18:05:44,735 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 18:05:44,735 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 18:05:44,735 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:05:45,804 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 18:05:45,804 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 18:05:45,804 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 18:05:45,804 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 18:05:45,804 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:05:47,297 - TrafficRL - INFO - Benchmark results for SimpleDQN on uniform:
2025-03-17 18:05:47,297 - TrafficRL - INFO -   Average Reward: 318779.41 ± 52435.04
2025-03-17 18:05:47,297 - TrafficRL - INFO -   Average Waiting Time: 148.71
2025-03-17 18:05:47,297 - TrafficRL - INFO -   Average Throughput: 11295854.39
2025-03-17 18:05:47,297 - TrafficRL - INFO -   Action Distribution: NS=69.6%, EW=30.4%
2025-03-17 18:05:48,694 - TrafficRL - INFO - Benchmark results for SimpleDQN on rush_hour:
2025-03-17 18:05:48,695 - TrafficRL - INFO -   Average Reward: 46694.47 ± 16033.16
2025-03-17 18:05:48,695 - TrafficRL - INFO -   Average Waiting Time: 234.53
2025-03-17 18:05:48,695 - TrafficRL - INFO -   Average Throughput: 8446500.97
2025-03-17 18:05:48,695 - TrafficRL - INFO -   Action Distribution: NS=47.1%, EW=52.9%
2025-03-17 18:05:50,236 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 18:05:50,236 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 18:05:50,236 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 18:05:50,236 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 18:05:50,236 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 18:05:51,766 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 18:05:51,767 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 18:05:51,767 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 18:05:51,767 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 18:05:51,767 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 18:05:51,774 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_180539/benchmark_results.json
2025-03-17 18:05:54,510 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_180539/plots
2025-03-17 18:05:54,510 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 18:05:54,510 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 18:05:54,510 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 18:05:54,510 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 18:05:54,510 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 18:05:54,510 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 18:05:54,510 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 18:05:54,510 - TrafficRL - INFO -   SimpleDQN_uniform: Reward=318779.41, Waiting=148.71
2025-03-17 18:05:54,511 - TrafficRL - INFO -   SimpleDQN_rush_hour: Reward=46694.47, Waiting=234.53
2025-03-17 18:05:54,511 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 18:05:54,511 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 18:07:43,583 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 18:07:43,585 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 18:07:43,585 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 18:07:43,586 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 18:07:43,586 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 18:07:43,586 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:07:43,586 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 18:07:43,588 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:07:43,588 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 18:07:43,968 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 18:07:43,970 - TrafficRL - ERROR - Error loading DQN model: Error(s) in loading state_dict for CustomDQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).
2025-03-17 18:07:43,973 - TrafficRL - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/benchmark.py", line 763, in create_benchmark_agents
    agent.local_network.load_state_dict(checkpoint['local_network_state_dict'])
  File "/Users/alfonsomateos/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for CustomDQN:
	Missing key(s) in state_dict: "bn1.weight", "bn1.bias", "bn1.running_mean", "bn1.running_var", "bn2.weight", "bn2.bias", "bn2.running_mean", "bn2.running_var", "bn3.weight", "bn3.bias", "bn3.running_mean", "bn3.running_var", "fc4.weight", "fc4.bias". 
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([32]).

2025-03-17 18:07:43,973 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:07:43,979 - TrafficRL.Agent - INFO - Model loaded successfully from results/simple_dqn/best_model.pth
2025-03-17 18:07:43,979 - TrafficRL - INFO - SimpleDQN agent loaded successfully
2025-03-17 18:07:43,979 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:07:43,980 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 18:07:43,981 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 18:07:43,981 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 18:07:45,101 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 18:07:45,101 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 18:07:45,101 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 18:07:45,101 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 18:07:45,101 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:07:46,247 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 18:07:46,247 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 18:07:46,247 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 18:07:46,247 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 18:07:46,247 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:07:47,355 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 18:07:47,355 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 18:07:47,355 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 18:07:47,355 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 18:07:47,355 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 18:07:48,414 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 18:07:48,414 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 18:07:48,414 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 18:07:48,415 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 18:07:48,415 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 18:07:49,530 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 18:07:49,530 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 18:07:49,530 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 18:07:49,530 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 18:07:49,530 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:07:50,600 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 18:07:50,600 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 18:07:50,600 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 18:07:50,600 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 18:07:50,600 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:07:52,066 - TrafficRL - INFO - Benchmark results for SimpleDQN on uniform:
2025-03-17 18:07:52,067 - TrafficRL - INFO -   Average Reward: 318779.41 ± 52435.04
2025-03-17 18:07:52,067 - TrafficRL - INFO -   Average Waiting Time: 148.71
2025-03-17 18:07:52,067 - TrafficRL - INFO -   Average Throughput: 11295854.39
2025-03-17 18:07:52,067 - TrafficRL - INFO -   Action Distribution: NS=69.6%, EW=30.4%
2025-03-17 18:07:53,487 - TrafficRL - INFO - Benchmark results for SimpleDQN on rush_hour:
2025-03-17 18:07:53,487 - TrafficRL - INFO -   Average Reward: 46694.47 ± 16033.16
2025-03-17 18:07:53,487 - TrafficRL - INFO -   Average Waiting Time: 234.53
2025-03-17 18:07:53,487 - TrafficRL - INFO -   Average Throughput: 8446500.97
2025-03-17 18:07:53,487 - TrafficRL - INFO -   Action Distribution: NS=47.1%, EW=52.9%
2025-03-17 18:07:55,010 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 18:07:55,010 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 18:07:55,010 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 18:07:55,010 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 18:07:55,010 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 18:07:56,515 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 18:07:56,515 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 18:07:56,515 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 18:07:56,515 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 18:07:56,515 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 18:07:56,522 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_180743/benchmark_results.json
2025-03-17 18:07:59,285 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_180743/plots
2025-03-17 18:07:59,285 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 18:07:59,285 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 18:07:59,285 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 18:07:59,285 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 18:07:59,285 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 18:07:59,285 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 18:07:59,285 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 18:07:59,285 - TrafficRL - INFO -   SimpleDQN_uniform: Reward=318779.41, Waiting=148.71
2025-03-17 18:07:59,285 - TrafficRL - INFO -   SimpleDQN_rush_hour: Reward=46694.47, Waiting=234.53
2025-03-17 18:07:59,285 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 18:07:59,285 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 18:17:48,124 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 18:17:48,126 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 18:17:48,126 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 18:17:48,127 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 18:17:48,127 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 18:17:48,127 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:17:48,127 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 18:17:48,127 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:17:48,127 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 18:17:48,560 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 18:17:48,564 - TrafficRL.Agent - WARNING - Error loading local network: Error(s) in loading state_dict for DQN:
	size mismatch for fc1.weight: copying a param with shape torch.Size([128, 80]) from checkpoint, the shape in current model is torch.Size([64, 80]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.weight: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.running_mean: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.running_var: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([128, 128]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.weight: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.running_mean: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.running_var: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc3.weight: copying a param with shape torch.Size([64, 128]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for fc4.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([2, 32]).
2025-03-17 18:17:48,564 - TrafficRL.Agent - INFO - Detected architecture: input=80, hidden=128, output=64
2025-03-17 18:17:48,566 - TrafficRL.Agent - ERROR - Failed to load with adjusted architecture: Error(s) in loading state_dict for DQN:
	size mismatch for fc4.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc4.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([64]).
2025-03-17 18:17:48,566 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 18:17:48,566 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 18:17:48,574 - TrafficRL.Agent - INFO - Model loaded successfully from results/simple_dqn/best_model.pth
2025-03-17 18:17:48,574 - TrafficRL - INFO - SimpleDQN agent loaded successfully
2025-03-17 18:17:48,574 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 18:17:48,575 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 18:17:48,576 - TrafficRL.Agents.PPO - INFO - Loaded policy state from checkpoint
2025-03-17 18:17:48,576 - TrafficRL.Agents.PPO - INFO - Loaded optimizer state
2025-03-17 18:17:48,576 - TrafficRL.Agents.PPO - INFO - Updated config from checkpoint
2025-03-17 18:17:48,576 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 18:17:48,576 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 18:17:49,911 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 18:17:49,912 - TrafficRL - INFO -   Average Reward: 262140.62 ± 18215.43
2025-03-17 18:17:49,912 - TrafficRL - INFO -   Average Waiting Time: 175.25
2025-03-17 18:17:49,912 - TrafficRL - INFO -   Average Throughput: 10944529.64
2025-03-17 18:17:49,912 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:17:51,167 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 18:17:51,167 - TrafficRL - INFO -   Average Reward: 31147.79 ± 1255.99
2025-03-17 18:17:51,167 - TrafficRL - INFO -   Average Waiting Time: 237.58
2025-03-17 18:17:51,167 - TrafficRL - INFO -   Average Throughput: 8232909.97
2025-03-17 18:17:51,167 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 18:17:52,494 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 18:17:52,495 - TrafficRL - INFO -   Average Reward: 248331.34 ± 14045.31
2025-03-17 18:17:52,495 - TrafficRL - INFO -   Average Waiting Time: 184.56
2025-03-17 18:17:52,495 - TrafficRL - INFO -   Average Throughput: 10940006.17
2025-03-17 18:17:52,495 - TrafficRL - INFO -   Action Distribution: NS=48.9%, EW=51.1%
2025-03-17 18:17:53,816 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 18:17:53,816 - TrafficRL - INFO -   Average Reward: 59717.62 ± 1526.19
2025-03-17 18:17:53,816 - TrafficRL - INFO -   Average Waiting Time: 231.81
2025-03-17 18:17:53,816 - TrafficRL - INFO -   Average Throughput: 8620905.84
2025-03-17 18:17:53,816 - TrafficRL - INFO -   Action Distribution: NS=49.0%, EW=51.0%
2025-03-17 18:17:55,160 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 18:17:55,161 - TrafficRL - INFO -   Average Reward: 251697.90 ± 55625.12
2025-03-17 18:17:55,161 - TrafficRL - INFO -   Average Waiting Time: 173.80
2025-03-17 18:17:55,161 - TrafficRL - INFO -   Average Throughput: 10681128.91
2025-03-17 18:17:55,161 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:17:56,446 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 18:17:56,446 - TrafficRL - INFO -   Average Reward: 73914.21 ± 42218.52
2025-03-17 18:17:56,446 - TrafficRL - INFO -   Average Waiting Time: 230.92
2025-03-17 18:17:56,446 - TrafficRL - INFO -   Average Throughput: 8881686.14
2025-03-17 18:17:56,446 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 18:17:58,178 - TrafficRL - INFO - Benchmark results for SimpleDQN on uniform:
2025-03-17 18:17:58,178 - TrafficRL - INFO -   Average Reward: 318779.41 ± 52435.04
2025-03-17 18:17:58,178 - TrafficRL - INFO -   Average Waiting Time: 148.71
2025-03-17 18:17:58,178 - TrafficRL - INFO -   Average Throughput: 11295854.39
2025-03-17 18:17:58,178 - TrafficRL - INFO -   Action Distribution: NS=69.6%, EW=30.4%
2025-03-17 18:17:59,867 - TrafficRL - INFO - Benchmark results for SimpleDQN on rush_hour:
2025-03-17 18:17:59,867 - TrafficRL - INFO -   Average Reward: 46694.47 ± 16033.16
2025-03-17 18:17:59,867 - TrafficRL - INFO -   Average Waiting Time: 234.53
2025-03-17 18:17:59,867 - TrafficRL - INFO -   Average Throughput: 8446500.97
2025-03-17 18:17:59,867 - TrafficRL - INFO -   Action Distribution: NS=47.1%, EW=52.9%
2025-03-17 18:18:01,661 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 18:18:01,661 - TrafficRL - INFO -   Average Reward: 160355.17 ± 64334.50
2025-03-17 18:18:01,661 - TrafficRL - INFO -   Average Waiting Time: 194.84
2025-03-17 18:18:01,661 - TrafficRL - INFO -   Average Throughput: 9614631.05
2025-03-17 18:18:01,661 - TrafficRL - INFO -   Action Distribution: NS=5.9%, EW=94.1%
2025-03-17 18:18:03,436 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 18:18:03,437 - TrafficRL - INFO -   Average Reward: 280708.34 ± 86715.18
2025-03-17 18:18:03,437 - TrafficRL - INFO -   Average Waiting Time: 220.84
2025-03-17 18:18:03,437 - TrafficRL - INFO -   Average Throughput: 12734441.39
2025-03-17 18:18:03,437 - TrafficRL - INFO -   Action Distribution: NS=5.0%, EW=95.0%
2025-03-17 18:18:03,443 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_181748/benchmark_results.json
2025-03-17 18:18:05,985 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_181748/plots
2025-03-17 18:18:05,985 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 18:18:05,985 - TrafficRL - INFO -   FixedTiming_uniform: Reward=262140.62, Waiting=175.25
2025-03-17 18:18:05,985 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=31147.79, Waiting=237.58
2025-03-17 18:18:05,985 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=248331.34, Waiting=184.56
2025-03-17 18:18:05,985 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=59717.62, Waiting=231.81
2025-03-17 18:18:05,985 - TrafficRL - INFO -   Random_uniform: Reward=251697.90, Waiting=173.80
2025-03-17 18:18:05,985 - TrafficRL - INFO -   Random_rush_hour: Reward=73914.21, Waiting=230.92
2025-03-17 18:18:05,985 - TrafficRL - INFO -   SimpleDQN_uniform: Reward=318779.41, Waiting=148.71
2025-03-17 18:18:05,985 - TrafficRL - INFO -   SimpleDQN_rush_hour: Reward=46694.47, Waiting=234.53
2025-03-17 18:18:05,986 - TrafficRL - INFO -   PPO_uniform: Reward=160355.17, Waiting=194.84
2025-03-17 18:18:05,986 - TrafficRL - INFO -   PPO_rush_hour: Reward=280708.34, Waiting=220.84
2025-03-17 19:58:22,177 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 19:58:22,179 - TrafficRL - INFO - Random seed set to 42
2025-03-17 19:59:03,021 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 19:59:03,022 - TrafficRL - INFO - Random seed set to 42
2025-03-17 19:59:03,023 - TrafficRL - INFO - No model provided, using random actions
2025-03-17 19:59:03,023 - TrafficRL - INFO - Creating environment visualization: visualizations/traffic_sim_natural_random_20250317_195903.mp4
2025-03-17 19:59:05,068 - TrafficRL - WARNING - FFmpeg writer failed: 'TrafficSimulation' object has no attribute 'traffic_density'. Trying a different approach.
2025-03-17 19:59:05,130 - TrafficRL - ERROR - Failed to save animation: 'TrafficSimulation' object has no attribute 'traffic_density'
2025-03-17 19:59:05,130 - TrafficRL - INFO - Saving individual frames to visualizations/frames...
2025-03-17 19:59:05,130 - TrafficRL - ERROR - Visualization failed: 'TrafficSimulation' object has no attribute 'traffic_density'
2025-03-17 19:59:05,136 - TrafficRL - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 784, in save_visualization
    ani.save(filename, writer=writer)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 756, in update
    ns_density = env.traffic_density[i, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 790, in save_visualization
    ani.save(filename, fps=fps, dpi=120)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 756, in update
    ns_density = env.traffic_density[i, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 801, in save_visualization
    update(i)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 756, in update
    ns_density = env.traffic_density[i, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

2025-03-17 19:59:05,137 - TrafficRL - ERROR - Failed to create visualization
2025-03-17 19:59:24,630 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 19:59:24,630 - TrafficRL.Config - INFO - Loaded JSON configuration from results/default_config.json
2025-03-17 19:59:24,630 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 19:59:24,630 - TrafficRL - INFO - Setting number of episodes to 10 (from command line)
2025-03-17 19:59:24,630 - TrafficRL - INFO - Random seed set to 42
2025-03-17 19:59:24,631 - TrafficRL.Config - INFO - Configuration saved to results/entity_based_dqn/training_config.json
2025-03-17 19:59:24,631 - TrafficRL - INFO - Starting training with dqn agent...
2025-03-17 19:59:25,293 - TrafficRL.Environment - INFO - Using hardware accelerated rendering
2025-03-17 19:59:25,299 - TrafficRL.Environment - INFO - Visualization initialized successfully
2025-03-17 19:59:25,301 - TrafficRL.Agent - INFO - Using device: mps
2025-03-17 19:59:25,301 - TrafficRL.Agent - INFO - Using Dueling DQN architecture
2025-03-17 19:59:25,915 - TrafficRL.Agent - INFO - Using prioritized experience replay
2025-03-17 19:59:25,915 - TrafficRL.Train - INFO - Using only the natural traffic pattern for the entire training
2025-03-17 19:59:28,102 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:28,541 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:28,974 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:29,406 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:29,831 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:30,256 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:30,673 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:31,106 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:31,522 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:31,964 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:32,373 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:32,806 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:33,231 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:33,657 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:34,080 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:34,512 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:34,940 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:35,348 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:35,772 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:36,198 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:36,614 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:37,031 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:37,472 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:37,889 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:38,314 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:38,731 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:39,139 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:39,539 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:39,989 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:40,431 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:40,864 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:41,298 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:41,706 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:42,148 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:42,564 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:42,990 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:43,406 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:43,814 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:44,256 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:44,664 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:45,089 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:45,506 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:45,923 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:46,348 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:46,773 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:47,207 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:47,631 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:47,631 - TrafficRL.Train - INFO - Episode 1/10 - Reward: -43.30, Avg Reward: -43.30, Epsilon: 0.3897, LR: 0.000300, Traffic: natural
2025-03-17 19:59:48,047 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:48,472 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:48,916 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:49,381 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:49,789 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:50,206 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:50,639 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:51,056 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:51,464 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:51,897 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:52,306 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:52,731 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:53,153 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:53,625 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:54,082 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:54,497 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:54,898 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:55,314 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:55,731 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:56,164 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:56,581 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:57,005 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:57,439 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:57,848 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:58,272 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:58,681 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:59,098 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:59,513 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 19:59:59,956 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:00,373 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:00,801 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:01,206 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:01,639 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:02,064 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:02,480 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:02,906 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:03,322 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:03,748 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:04,164 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:04,622 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:05,047 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:05,464 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:05,889 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:06,290 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:06,730 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:07,131 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:07,547 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:07,964 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:08,380 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:08,806 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:08,806 - TrafficRL.Train - INFO - Episode 2/10 - Reward: -53.45, Avg Reward: -48.38, Epsilon: 0.1430, LR: 0.000300, Traffic: natural
2025-03-17 20:00:09,231 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:09,641 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:10,117 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:10,564 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:11,005 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:11,439 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:11,864 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:12,306 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:12,747 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:13,173 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:13,589 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:14,005 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:14,423 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:14,877 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:15,331 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:15,797 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:16,205 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:16,614 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:17,047 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:17,420 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:17,697 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:17,963 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:18,300 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:18,767 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:19,189 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:19,622 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:20,030 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:20,447 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:20,858 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:21,289 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:21,722 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:22,155 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:22,597 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:23,023 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:23,464 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:23,914 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:24,323 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:24,764 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:25,181 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:25,614 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:26,081 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:26,506 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:26,966 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:27,414 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:27,847 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:28,239 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:28,664 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:29,097 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:29,539 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:29,997 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:29,997 - TrafficRL.Train - INFO - Episode 3/10 - Reward: -79.45, Avg Reward: -58.74, Epsilon: 0.0525, LR: 0.000300, Traffic: natural
2025-03-17 20:00:30,447 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:30,914 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:31,340 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:31,764 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:32,147 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:32,581 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:32,999 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:33,448 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:33,872 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:34,306 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:34,703 - TrafficRL.Train - INFO - Visualization disabled by user
2025-03-17 20:00:34,799 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:34,877 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:34,947 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,013 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,079 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,144 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,209 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,272 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,337 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,402 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,470 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,536 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,610 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,682 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,747 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,812 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,881 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:35,946 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,008 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,075 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,137 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,199 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,260 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,328 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,394 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,463 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,529 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,593 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,658 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,721 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,784 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,849 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,911 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:36,974 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,036 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,101 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,167 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,232 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,299 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,367 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,367 - TrafficRL.Train - INFO - Episode 4/10 - Reward: -120.37, Avg Reward: -74.15, Epsilon: 0.0193, LR: 0.000300, Traffic: natural
2025-03-17 20:00:37,434 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,498 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,567 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,637 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,706 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,774 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,839 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,903 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:37,968 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,031 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,096 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,179 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,254 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,325 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,398 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,471 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,541 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,610 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,674 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,739 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,805 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,872 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:38,938 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,006 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,072 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,157 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,227 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,295 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,363 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,431 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,499 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,567 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,639 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,707 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,777 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,843 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,910 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:39,978 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,047 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,115 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,184 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,253 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,324 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,393 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,461 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,527 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,595 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,665 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,733 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,800 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,800 - TrafficRL.Train - INFO - Episode 5/10 - Reward: -136.43, Avg Reward: -86.60, Epsilon: 0.0100, LR: 0.000300, Traffic: natural
2025-03-17 20:00:40,872 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:40,953 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,020 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,090 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,160 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,230 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,297 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,365 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,433 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,500 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,566 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,635 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,706 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,774 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,842 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,911 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:41,981 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,049 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,115 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,181 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,247 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,314 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,380 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,447 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,513 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,580 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,647 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,713 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,780 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,847 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,915 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:42,982 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,048 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,115 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,180 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,247 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,319 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,391 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,461 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,531 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,598 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,666 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,733 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,801 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,873 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:43,960 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,035 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,112 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,186 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,256 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,257 - TrafficRL.Train - INFO - Episode 6/10 - Reward: -225.27, Avg Reward: -109.71, Epsilon: 0.0100, LR: 0.000300, Traffic: natural
2025-03-17 20:00:44,329 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,398 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,470 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,534 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,599 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,672 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,738 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,802 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,864 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,927 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:44,990 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,052 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,116 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,180 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,249 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,316 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,382 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,447 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,512 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,578 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,642 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,706 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,768 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,831 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,894 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:45,957 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,020 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,087 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,160 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,231 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,299 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,367 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,436 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,506 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,575 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,642 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,707 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,772 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,839 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,905 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:46,976 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,045 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,116 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,189 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,259 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,326 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,392 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,458 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,525 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,593 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,593 - TrafficRL.Train - INFO - Episode 7/10 - Reward: -222.71, Avg Reward: -125.86, Epsilon: 0.0100, LR: 0.000300, Traffic: natural
2025-03-17 20:00:47,665 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,733 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,803 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,872 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:47,940 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,008 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,076 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,146 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,213 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,278 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,343 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,411 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,481 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,550 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,620 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,688 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,756 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,823 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,891 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:48,960 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,027 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,093 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,158 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,224 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,290 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,355 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,419 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,482 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,545 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,607 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,673 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,736 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,800 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,863 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,928 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:49,991 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,056 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,120 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,184 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,247 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,310 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,373 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,438 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,501 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,566 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,629 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,693 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,758 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,821 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,889 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:50,889 - TrafficRL.Train - INFO - Episode 8/10 - Reward: -157.85, Avg Reward: -129.86, Epsilon: 0.0100, LR: 0.000300, Traffic: natural
2025-03-17 20:00:50,957 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,023 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,093 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,158 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,222 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,287 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,351 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,418 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,484 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,551 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,617 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,683 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,747 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,812 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,878 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:51,944 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,008 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,075 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,141 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,208 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,274 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,340 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,406 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,470 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,536 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,600 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,669 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,737 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,806 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,875 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:52,943 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,024 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,093 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,163 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,231 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,301 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,370 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,439 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,511 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,579 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,647 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,715 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,786 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,854 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,921 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:53,988 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,054 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,120 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,188 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,256 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,256 - TrafficRL.Train - INFO - Episode 9/10 - Reward: -277.50, Avg Reward: -146.26, Epsilon: 0.0100, LR: 0.000300, Traffic: natural
2025-03-17 20:00:54,325 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,391 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,458 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,523 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,591 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,658 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,724 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,789 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,853 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,918 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:54,983 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:55,048 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:00:55,113 - TrafficRL.Agent - DEBUG - Target network updated
2025-03-17 20:09:38,561 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 20:09:38,564 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/entity_dqn_config.yaml
2025-03-17 20:09:38,564 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 20:09:38,565 - TrafficRL - INFO - Setting number of episodes to 10 (from command line)
2025-03-17 20:09:38,566 - TrafficRL - INFO - Random seed set to 42
2025-03-17 20:09:38,566 - TrafficRL.Config - INFO - Configuration saved to results/entity_based_dqn/training_config.json
2025-03-17 20:09:38,566 - TrafficRL - INFO - Starting training with entity_dqn agent...
2025-03-17 20:09:39,197 - TrafficRL.Environment - INFO - Using hardware accelerated rendering
2025-03-17 20:09:39,203 - TrafficRL.Environment - INFO - Visualization initialized successfully
2025-03-17 20:09:39,206 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 20:09:39,206 - TrafficRL.Agent - INFO - Using entity-aware DQN architecture
2025-03-17 20:09:39,804 - TrafficRL.Agent - INFO - Using prioritized experience replay
2025-03-17 20:09:39,804 - TrafficRL.Train - INFO - Using only the natural traffic pattern for the entire training
2025-03-17 20:09:40,662 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,664 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,704 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,705 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,750 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,750 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,795 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,795 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,838 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,839 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,882 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,882 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,927 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,927 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:40,970 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:40,970 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,015 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,015 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,059 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,059 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,105 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,105 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,149 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,149 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,193 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,193 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,239 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,239 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,281 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,281 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,324 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,324 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,367 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,368 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,412 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,412 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,455 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,456 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,501 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,501 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,545 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,545 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,589 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,590 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,635 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,636 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,680 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,680 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,725 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,725 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,769 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,770 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,815 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,815 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,859 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,860 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,906 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,906 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,950 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,951 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:41,996 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:41,997 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,044 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,044 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,087 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,088 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,133 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,134 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,178 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,178 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,222 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,223 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,266 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,266 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,308 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,309 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,354 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,354 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,397 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,398 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,444 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,445 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,489 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,490 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,534 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,534 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,579 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,579 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,623 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,623 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,665 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,666 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,711 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,711 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,755 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,755 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,799 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,800 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,843 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,844 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,891 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,891 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,934 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,935 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:42,979 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:42,980 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,023 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,023 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,067 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,067 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,109 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,110 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,154 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,154 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,200 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,200 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,246 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,246 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,246 - TrafficRL.Train - INFO - Episode 1/10 - Reward: -10.84, Avg Reward: -10.84, LR: 0.001000, Traffic: natural
2025-03-17 20:09:43,291 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,292 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,336 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,336 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,382 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,382 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,425 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,425 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,470 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,470 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,514 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,514 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,558 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,559 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,602 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,603 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,648 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,648 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,692 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,692 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,735 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,736 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,780 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,780 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,824 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,825 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,869 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,869 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,913 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,914 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:43,958 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:43,958 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,003 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,003 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,047 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,047 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,092 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,092 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,136 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,137 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,183 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,183 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,229 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,229 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,273 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,274 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,319 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,319 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,361 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,362 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,407 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,407 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,451 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,452 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,495 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,495 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,539 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,540 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,584 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,628 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,629 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,674 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,674 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,719 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,719 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,762 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,763 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,806 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,806 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,850 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,851 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,897 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,897 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,941 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,941 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:44,985 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:44,985 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,031 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,031 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,076 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,076 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,120 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,120 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,164 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,165 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,208 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,209 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,253 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,253 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,296 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,296 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,339 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,340 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,385 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,385 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,430 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,431 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,476 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,476 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,521 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,521 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,564 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,564 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,609 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,609 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,653 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,653 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,697 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,698 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,742 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,742 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,786 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,786 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,832 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,832 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,877 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,877 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,921 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,922 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:45,966 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:45,966 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,009 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,010 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,054 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,054 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,096 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,097 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,141 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,141 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,184 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,228 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,228 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,272 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,272 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,318 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,318 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,362 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,363 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,405 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,405 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,449 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,450 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,492 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,492 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,536 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,537 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,581 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,581 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,582 - TrafficRL.Train - INFO - Episode 2/10 - Reward: -7.42, Avg Reward: -9.13, LR: 0.001000, Traffic: natural
2025-03-17 20:09:46,624 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,624 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,667 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,667 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,711 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,711 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,756 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,756 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,800 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,800 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,846 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,847 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,892 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,892 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,935 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,936 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:46,980 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:46,981 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,024 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,024 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,067 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,067 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,111 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,111 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,154 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,154 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,197 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,197 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,240 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,241 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,284 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,284 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,329 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,329 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,373 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,373 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,417 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,417 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,462 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,463 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,506 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,507 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,549 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,549 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,592 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,592 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,636 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,636 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,680 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,680 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,723 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,723 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,767 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,767 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,812 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,812 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,854 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,855 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,899 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,899 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,941 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,942 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:47,985 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:47,986 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,031 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,031 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,075 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,076 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,119 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,120 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,160 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,160 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,207 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,207 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,251 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,251 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,295 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,295 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,342 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,342 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,384 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,385 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,429 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,429 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,472 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,473 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,516 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,516 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,560 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,561 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,605 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,605 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,649 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,650 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,695 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,695 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,739 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,740 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,784 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,784 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,828 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,829 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,872 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,872 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,917 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,918 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:48,959 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:48,959 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,005 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,006 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,050 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,093 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,094 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,137 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,137 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,180 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,180 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,226 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,226 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,270 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,271 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,316 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,316 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,358 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,359 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,402 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,403 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,448 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,448 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,490 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,491 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,531 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,531 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,573 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,573 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:49,615 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:49,615 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,388 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,388 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,451 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,451 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,518 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,584 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,650 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,651 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,717 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,717 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,717 - TrafficRL.Train - INFO - Episode 3/10 - Reward: -2.23, Avg Reward: -6.83, LR: 0.001000, Traffic: natural
2025-03-17 20:09:50,783 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,783 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,851 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,851 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,917 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,918 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:50,984 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:50,984 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,051 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,116 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,117 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,183 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,250 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,317 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,318 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,384 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,384 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,450 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,450 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,517 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,583 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,649 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,650 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,717 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,717 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,784 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,784 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,850 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,851 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,916 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,917 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:51,984 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:51,984 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,051 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,116 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,117 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,184 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,251 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,317 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,317 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,383 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,383 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,450 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,450 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,517 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,584 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,649 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,650 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,716 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,717 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,783 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,784 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,850 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,850 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,916 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,917 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:52,984 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:52,984 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,050 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,116 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,117 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,184 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,251 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,317 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,318 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,383 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,384 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,450 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,451 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,517 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,583 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,650 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,651 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,716 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,717 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,784 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,784 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,850 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,851 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,916 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,917 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:53,984 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:53,984 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,050 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,117 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,118 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,183 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,251 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,317 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,317 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,383 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,383 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,450 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,450 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,518 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,584 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,650 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,651 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,717 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,717 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,783 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,783 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,850 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,850 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,916 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,917 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:54,983 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:54,984 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,050 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,116 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,117 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,183 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,250 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,317 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,318 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,506 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,507 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,548 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,548 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,589 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,590 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,630 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,631 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,673 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,673 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,716 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,716 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,717 - TrafficRL.Train - INFO - Episode 4/10 - Reward: -1.50, Avg Reward: -5.50, LR: 0.001000, Traffic: natural
2025-03-17 20:09:55,758 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,759 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,799 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,799 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,840 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,841 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,881 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,881 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,922 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,922 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:55,965 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:55,966 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,006 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,006 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,049 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,049 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,093 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,094 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,133 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,134 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,176 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,177 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,218 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,218 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,260 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,261 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,303 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,304 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,344 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,345 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,388 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,388 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,445 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,446 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,522 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,523 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,566 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,566 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,609 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,609 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,653 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,653 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,697 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,698 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,740 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,740 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,782 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,782 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,825 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,825 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,869 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,869 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,912 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,912 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,954 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,955 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:56,996 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:56,996 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,038 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,039 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,080 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,080 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,122 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,123 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,164 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,165 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,208 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,208 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,252 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,253 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,295 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,296 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,337 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,338 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,379 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,380 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,423 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,424 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,464 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,465 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,505 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,505 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,548 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,549 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,592 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,592 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,633 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,633 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,678 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,679 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,720 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,721 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,761 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,762 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,806 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,807 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,852 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,853 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,893 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,894 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,937 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,937 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:57,980 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:57,980 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,021 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,021 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,062 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,063 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,106 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,106 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,149 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,149 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,191 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,192 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,235 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,236 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,277 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,278 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,320 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,321 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,361 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,361 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,402 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,402 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,443 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,443 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,484 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,485 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,525 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,525 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,567 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,567 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,608 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,609 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,651 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,652 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,696 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,697 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,740 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,740 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,781 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,781 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,824 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,824 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,867 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,868 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,907 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,908 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,948 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,948 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:58,948 - TrafficRL.Train - INFO - Episode 5/10 - Reward: -4.61, Avg Reward: -5.32, LR: 0.001000, Traffic: natural
2025-03-17 20:09:58,989 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:58,990 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,033 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,034 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,078 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,078 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,122 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,122 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,163 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,163 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,205 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,205 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,247 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,247 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,292 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,293 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,333 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,333 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,378 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,378 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,418 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,419 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,462 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,463 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,503 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,504 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,545 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,545 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,585 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,586 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,627 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,627 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,672 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,672 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,715 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,716 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,755 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,756 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,797 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,798 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,841 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,842 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,882 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,883 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,922 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,923 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:09:59,964 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:09:59,965 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,007 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,007 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,056 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,056 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,096 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,097 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,140 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,140 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,180 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,181 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,223 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,224 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,266 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,267 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,309 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,309 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,353 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,353 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,395 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,396 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,441 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,442 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,484 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,484 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,527 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,527 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,571 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,571 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,612 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,613 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,656 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,656 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,702 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,702 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,750 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,750 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,798 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,798 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,846 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,846 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,891 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,891 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,937 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,937 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:00,980 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:00,980 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,022 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,022 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,065 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,065 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,110 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,110 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,152 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,152 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,198 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,198 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,245 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,245 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,292 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,292 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,336 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,337 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,381 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,381 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,425 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,425 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,466 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,467 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,511 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,512 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,552 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,553 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,594 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,594 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,641 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,641 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,688 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,688 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,735 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,735 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,783 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,783 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,831 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,831 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,873 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,873 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,919 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,919 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:01,963 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:01,963 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,003 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,004 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,050 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,098 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,098 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,141 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,141 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,186 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,187 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,232 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,233 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,233 - TrafficRL.Train - INFO - Episode 6/10 - Reward: -3.91, Avg Reward: -5.09, LR: 0.001000, Traffic: natural
2025-03-17 20:10:02,278 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,278 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,323 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,323 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,367 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,367 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,408 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,409 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,453 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,454 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,498 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,498 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,544 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,544 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,589 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,590 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,634 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,635 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,680 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,681 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,723 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,724 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,770 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,771 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,815 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,816 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,855 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,856 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,899 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,900 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,939 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,940 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:02,986 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:02,986 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,030 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,030 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,078 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,078 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,125 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,125 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,173 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,173 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,218 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,218 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,260 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,261 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,301 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,302 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,343 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,344 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,384 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,384 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,430 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,430 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,474 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,474 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,522 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,523 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,567 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,568 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,608 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,608 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,655 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,656 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,698 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,698 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,742 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,743 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,785 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,786 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,828 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,828 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,876 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,876 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,924 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,924 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:03,970 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:03,971 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,013 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,013 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,058 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,058 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,100 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,100 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,142 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,143 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,183 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,184 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,226 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,227 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,266 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,267 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,311 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,311 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,356 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,357 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,403 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,403 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,448 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,448 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,492 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,492 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,535 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,536 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,580 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,581 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,623 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,623 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,664 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,664 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,707 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,707 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,755 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,755 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,803 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,803 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,847 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,848 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,895 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,895 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,937 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,937 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:04,985 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:04,985 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,026 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,027 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,068 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,069 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,111 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,111 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,151 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,152 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,193 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,194 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,239 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,239 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,287 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,287 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,335 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,335 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,383 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,383 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,431 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,431 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,477 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,478 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,520 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,521 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,562 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,563 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,563 - TrafficRL.Train - INFO - Episode 7/10 - Reward: -5.61, Avg Reward: -5.16, LR: 0.001000, Traffic: natural
2025-03-17 20:10:05,606 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,607 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,647 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,647 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,695 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,696 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,738 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,738 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,782 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,782 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,830 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,830 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,878 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,878 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,919 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,920 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:05,965 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:05,965 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,008 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,009 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,050 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,051 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,092 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,093 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,134 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,134 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,178 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,178 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,221 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,221 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,265 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,266 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,308 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,309 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,351 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,352 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,393 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,394 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,435 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,436 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,478 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,479 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,518 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,519 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,562 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,562 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,609 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,610 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,657 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,657 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,702 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,702 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,750 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,750 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,798 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,798 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,842 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,842 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,883 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,884 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,929 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,930 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:06,973 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:06,974 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,018 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,019 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,064 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,064 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,112 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,112 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,157 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,158 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,204 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,204 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,248 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,248 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,292 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,293 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,333 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,333 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,376 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,376 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,419 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,419 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,461 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,462 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,505 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,505 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,548 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,548 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,593 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,593 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,641 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,641 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,689 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,689 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,731 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,732 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,775 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,776 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,817 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,818 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,860 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,861 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,903 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,904 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,946 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,946 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:07,994 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:07,994 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,039 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,040 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,084 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,085 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,130 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,130 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,178 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,178 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,225 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,225 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,268 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,269 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,310 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,311 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,353 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,354 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,398 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,399 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,444 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,444 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,492 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,492 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,540 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,540 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,585 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,585 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,633 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,633 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,675 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,676 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,719 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,720 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,763 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,764 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,806 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,807 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,848 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,849 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,892 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,892 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,893 - TrafficRL.Train - INFO - Episode 8/10 - Reward: -2.97, Avg Reward: -4.89, LR: 0.001000, Traffic: natural
2025-03-17 20:10:08,940 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,940 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:08,988 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:08,988 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,031 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,031 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,077 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,078 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,121 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,122 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,163 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,163 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,206 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,207 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,248 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,249 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,288 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,289 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,333 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,333 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,377 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,378 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,424 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,424 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,472 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,472 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,519 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,519 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,560 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,560 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,603 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,604 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,643 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,644 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,687 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,687 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,728 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,729 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,769 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,770 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,814 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,814 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,858 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,859 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,901 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,902 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,947 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,948 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:09,993 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:09,993 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,038 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,039 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,081 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,082 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,124 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,124 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,165 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,166 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,209 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,209 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,257 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,257 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,301 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,302 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,347 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,347 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,395 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,395 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,438 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,438 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,480 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,481 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,524 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,524 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,568 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,569 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,610 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,611 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,652 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,652 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,693 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,693 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,740 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,740 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,785 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,786 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,830 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,830 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,878 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,878 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,926 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,926 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:10,970 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:10,970 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,013 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,014 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,055 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,055 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,098 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,099 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,140 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,141 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,181 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,182 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,229 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,229 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,272 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,272 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,316 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,316 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,367 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,367 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,410 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,410 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,453 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,454 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,498 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,498 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,539 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,540 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,583 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,583 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,631 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,631 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,678 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,678 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,723 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,723 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,769 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,769 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,815 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,816 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,860 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,860 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,905 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,905 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,945 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,946 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:11,988 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:11,989 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,033 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,034 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,075 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,075 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,120 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,121 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,167 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,168 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,214 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,214 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,214 - TrafficRL.Train - INFO - Episode 9/10 - Reward: -4.04, Avg Reward: -4.79, LR: 0.001000, Traffic: natural
2025-03-17 20:10:12,256 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,256 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,304 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,304 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,348 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,349 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,391 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,391 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,433 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,434 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,476 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,477 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,517 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,518 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,561 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,561 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,609 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,609 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,655 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,655 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,700 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,701 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,748 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,748 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,790 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,791 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,831 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,831 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,874 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,874 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,919 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,920 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:12,961 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:12,962 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,009 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,009 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,054 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,054 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,098 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,098 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,144 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,145 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,191 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,191 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,238 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,238 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,280 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,281 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,321 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,321 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,366 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,367 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,406 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,407 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,452 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,452 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,500 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,500 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,548 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,548 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,596 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,596 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,644 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,644 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,692 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,692 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,736 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,737 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,777 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,778 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,820 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,821 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,863 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,864 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,910 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,910 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:13,958 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:13,959 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,006 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,006 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,052 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,053 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,098 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,098 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,143 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,144 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,187 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,187 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,229 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,230 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,274 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,275 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,316 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,317 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,359 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,359 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,402 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,402 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,449 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,449 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,497 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,497 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,541 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,541 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,584 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,584 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,630 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,631 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,672 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,673 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,714 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,715 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,757 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,758 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,800 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,800 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,847 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,847 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,893 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,894 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,937 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,938 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:14,985 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:14,985 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,033 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,033 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,079 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,080 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,120 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,121 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,163 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,163 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,207 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,207 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,250 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,251 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,297 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,297 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,342 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,343 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,389 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,389 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,432 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,432 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,480 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,480 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,527 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,528 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,570 - TrafficRL.Agent - ERROR - Error in learn() method: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)
2025-03-17 20:10:15,571 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 227, in learn
    next_actions = self.local_network(next_states).detach().max(1)[1].unsqueeze(1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/models/entity_dqn.py", line 161, in forward
    encoded_intersections = self.intersection_encoder(intersection_features)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (5120x1 and 5x128)

2025-03-17 20:10:15,571 - TrafficRL.Train - INFO - Episode 10/10 - Reward: -3.58, Avg Reward: -4.67, LR: 0.001000, Traffic: natural
2025-03-17 20:10:15,681 - TrafficRL - INFO - Training complete, visualizing results...
2025-03-17 20:10:15,772 - TrafficRL - INFO - Training visualization saved to results/entity_based_dqn/training_progress.png
2025-03-17 20:10:15,772 - TrafficRL - INFO - Training metrics saved to results/entity_based_dqn/training_metrics.json
2025-03-17 20:10:15,772 - TrafficRL - INFO - Training Summary:
2025-03-17 20:10:15,772 - TrafficRL - INFO -   Agent Type: entity_dqn
2025-03-17 20:10:15,772 - TrafficRL - INFO -   Episodes Completed: 10
2025-03-17 20:10:15,772 - TrafficRL - INFO -   Final Average Reward: -4.671992878787879
2025-03-17 20:10:15,772 - TrafficRL - INFO -   Best Model Path: results/entity_based_dqn/best_model.pth
2025-03-17 20:34:14,631 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 20:34:14,634 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 20:34:14,634 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 20:34:14,635 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 20:34:14,635 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 20:34:14,635 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 20:34:14,635 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 20:34:14,635 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 20:34:14,635 - TrafficRL.Agent - INFO - Using standard DQN architecture
2025-03-17 20:34:15,225 - TrafficRL.Agent - INFO - Using standard experience replay
2025-03-17 20:34:15,229 - TrafficRL.Agent - WARNING - Error loading local network: Error(s) in loading state_dict for DQN:
	size mismatch for fc1.weight: copying a param with shape torch.Size([128, 80]) from checkpoint, the shape in current model is torch.Size([64, 80]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.weight: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.running_mean: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn1.running_var: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([128, 128]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.weight: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.running_mean: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for bn2.running_var: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc3.weight: copying a param with shape torch.Size([64, 128]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for fc3.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for bn3.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([32]).
	size mismatch for fc4.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([2, 32]).
2025-03-17 20:34:15,229 - TrafficRL.Agent - INFO - Detected architecture: input=80, hidden=128, output=64
2025-03-17 20:34:15,232 - TrafficRL.Agent - ERROR - Failed to load with adjusted architecture: Error(s) in loading state_dict for DQN:
	size mismatch for fc4.weight: copying a param with shape torch.Size([2, 64]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc4.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([64]).
2025-03-17 20:34:15,232 - TrafficRL - ERROR - Failed to load DQN model from results/dqn/best_model.pth
2025-03-17 20:34:15,232 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 20:34:15,236 - TrafficRL.Agent - ERROR - Error loading model components: Error(s) in loading state_dict for SimpleDQN:
	size mismatch for fc1.weight: copying a param with shape torch.Size([128, 80]) from checkpoint, the shape in current model is torch.Size([64, 80]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([128, 128]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 128]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-17 20:34:15,237 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/simple_dqn_agent.py", line 224, in load
    self.local_network.load_state_dict(checkpoint['local_network_state_dict'])
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for SimpleDQN:
	size mismatch for fc1.weight: copying a param with shape torch.Size([128, 80]) from checkpoint, the shape in current model is torch.Size([64, 80]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([128, 128]) from checkpoint, the shape in current model is torch.Size([64, 64]).
	size mismatch for fc2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc3.weight: copying a param with shape torch.Size([2, 128]) from checkpoint, the shape in current model is torch.Size([2, 64]).

2025-03-17 20:34:15,237 - TrafficRL - ERROR - Failed to load SimpleDQN model from results/simple_dqn/best_model.pth
2025-03-17 20:34:15,237 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 20:34:15,238 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 20:34:15,240 - TrafficRL.Agents.PPO - INFO - Loaded policy state from checkpoint
2025-03-17 20:34:15,240 - TrafficRL.Agents.PPO - INFO - Loaded optimizer state
2025-03-17 20:34:15,240 - TrafficRL.Agents.PPO - INFO - Updated config from checkpoint
2025-03-17 20:34:15,240 - TrafficRL.Agents.PPO - INFO - Model loaded from results/ppo/best_model.pth
2025-03-17 20:34:15,240 - TrafficRL - INFO - PPO agent loaded successfully
2025-03-17 20:34:16,062 - TrafficRL - INFO - Benchmark results for FixedTiming on uniform:
2025-03-17 20:34:16,062 - TrafficRL - INFO -   Average Reward: 16.97 ± 1.51
2025-03-17 20:34:16,063 - TrafficRL - INFO -   Average Waiting Time: 18.36
2025-03-17 20:34:16,063 - TrafficRL - INFO -   Average Throughput: 113011.00
2025-03-17 20:34:16,063 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 20:34:17,209 - TrafficRL - INFO - Benchmark results for FixedTiming on rush_hour:
2025-03-17 20:34:17,209 - TrafficRL - INFO -   Average Reward: 15.82 ± 1.66
2025-03-17 20:34:17,209 - TrafficRL - INFO -   Average Waiting Time: 19.65
2025-03-17 20:34:17,209 - TrafficRL - INFO -   Average Throughput: 185132.70
2025-03-17 20:34:17,209 - TrafficRL - INFO -   Action Distribution: NS=51.0%, EW=49.0%
2025-03-17 20:34:17,947 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on uniform:
2025-03-17 20:34:17,947 - TrafficRL - INFO -   Average Reward: 52.77 ± 2.34
2025-03-17 20:34:17,947 - TrafficRL - INFO -   Average Waiting Time: 7.51
2025-03-17 20:34:17,947 - TrafficRL - INFO -   Average Throughput: 134419.50
2025-03-17 20:34:17,947 - TrafficRL - INFO -   Action Distribution: NS=50.0%, EW=50.0%
2025-03-17 20:34:19,054 - TrafficRL - INFO - Benchmark results for AdaptiveTiming on rush_hour:
2025-03-17 20:34:19,054 - TrafficRL - INFO -   Average Reward: 52.32 ± 2.34
2025-03-17 20:34:19,054 - TrafficRL - INFO -   Average Waiting Time: 8.07
2025-03-17 20:34:19,054 - TrafficRL - INFO -   Average Throughput: 241161.70
2025-03-17 20:34:19,054 - TrafficRL - INFO -   Action Distribution: NS=49.8%, EW=50.2%
2025-03-17 20:34:19,844 - TrafficRL - INFO - Benchmark results for Random on uniform:
2025-03-17 20:34:19,844 - TrafficRL - INFO -   Average Reward: 24.54 ± 4.38
2025-03-17 20:34:19,844 - TrafficRL - INFO -   Average Waiting Time: 16.59
2025-03-17 20:34:19,844 - TrafficRL - INFO -   Average Throughput: 115923.60
2025-03-17 20:34:19,844 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 20:34:21,001 - TrafficRL - INFO - Benchmark results for Random on rush_hour:
2025-03-17 20:34:21,001 - TrafficRL - INFO -   Average Reward: 20.85 ± 4.88
2025-03-17 20:34:21,001 - TrafficRL - INFO -   Average Waiting Time: 19.84
2025-03-17 20:34:21,001 - TrafficRL - INFO -   Average Throughput: 191280.40
2025-03-17 20:34:21,001 - TrafficRL - INFO -   Action Distribution: NS=50.1%, EW=49.9%
2025-03-17 20:34:22,285 - TrafficRL - INFO - Benchmark results for PPO on uniform:
2025-03-17 20:34:22,285 - TrafficRL - INFO -   Average Reward: 51.21 ± 10.43
2025-03-17 20:34:22,285 - TrafficRL - INFO -   Average Waiting Time: 11.05
2025-03-17 20:34:22,285 - TrafficRL - INFO -   Average Throughput: 133540.10
2025-03-17 20:34:22,285 - TrafficRL - INFO -   Action Distribution: NS=46.9%, EW=53.1%
2025-03-17 20:34:23,926 - TrafficRL - INFO - Benchmark results for PPO on rush_hour:
2025-03-17 20:34:23,926 - TrafficRL - INFO -   Average Reward: 50.30 ± 14.41
2025-03-17 20:34:23,926 - TrafficRL - INFO -   Average Waiting Time: 14.51
2025-03-17 20:34:23,926 - TrafficRL - INFO -   Average Throughput: 241689.10
2025-03-17 20:34:23,926 - TrafficRL - INFO -   Action Distribution: NS=45.2%, EW=54.8%
2025-03-17 20:34:23,939 - TrafficRL - INFO - Benchmark results saved to results/benchmark/benchmark_20250317_203415/benchmark_results.json
2025-03-17 20:34:26,574 - TrafficRL - INFO - Benchmark visualizations created in results/benchmark/benchmark_20250317_203415/plots
2025-03-17 20:34:26,575 - TrafficRL - INFO - Benchmark Summary:
2025-03-17 20:34:26,575 - TrafficRL - INFO -   FixedTiming_uniform: Reward=16.97, Waiting=18.36
2025-03-17 20:34:26,575 - TrafficRL - INFO -   FixedTiming_rush_hour: Reward=15.82, Waiting=19.65
2025-03-17 20:34:26,575 - TrafficRL - INFO -   AdaptiveTiming_uniform: Reward=52.77, Waiting=7.51
2025-03-17 20:34:26,575 - TrafficRL - INFO -   AdaptiveTiming_rush_hour: Reward=52.32, Waiting=8.07
2025-03-17 20:34:26,575 - TrafficRL - INFO -   Random_uniform: Reward=24.54, Waiting=16.59
2025-03-17 20:34:26,575 - TrafficRL - INFO -   Random_rush_hour: Reward=20.85, Waiting=19.84
2025-03-17 20:34:26,575 - TrafficRL - INFO -   PPO_uniform: Reward=51.21, Waiting=11.05
2025-03-17 20:34:26,575 - TrafficRL - INFO -   PPO_rush_hour: Reward=50.30, Waiting=14.51
2025-03-17 20:42:22,294 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 20:42:22,297 - TrafficRL.Config - INFO - Loaded YAML configuration from configs/benchmark_config.yaml
2025-03-17 20:42:22,297 - TrafficRL.Config - INFO - Configuration loaded successfully
2025-03-17 20:42:22,299 - TrafficRL.Agents.FixedTiming - INFO - Fixed timing agent initialized with phase duration: 30
2025-03-17 20:42:22,299 - TrafficRL.Agents.FixedTiming - INFO - Adaptive timing agent initialized with phase duration range: 10-60
2025-03-17 20:42:22,299 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 20:42:22,300 - TrafficRL.Agents.Base - INFO - RandomAgent initialized with action space size: 2
2025-03-17 20:42:22,300 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 20:42:22,301 - TrafficRL.Agent - INFO - Using Per-Intersection DQN architecture
2025-03-17 20:42:22,933 - TrafficRL.Agent - INFO - Using prioritized experience replay
2025-03-17 20:42:22,942 - TrafficRL.Agent - INFO - Loaded local network from local_network_state_dict
2025-03-17 20:42:22,942 - TrafficRL.Agent - INFO - Loaded target network from target_network_state_dict
2025-03-17 20:42:22,942 - TrafficRL.Agent - WARNING - Error loading optimizer state: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-03-17 20:42:22,942 - TrafficRL.Agent - INFO - Loaded epsilon: 0.01
2025-03-17 20:42:22,942 - TrafficRL.Agent - INFO - Loaded q-values history
2025-03-17 20:42:22,942 - TrafficRL.Agent - INFO - Model loaded successfully from results/dqn/best_model.pth
2025-03-17 20:42:22,942 - TrafficRL - INFO - Successfully loaded model from results/dqn/best_model.pth
2025-03-17 20:42:22,943 - TrafficRL.Agent - INFO - Using device: cpu
2025-03-17 20:42:22,947 - TrafficRL.Agent - INFO - Model loaded successfully from results/simple_dqn/best_model.pth
2025-03-17 20:42:22,948 - TrafficRL - INFO - Successfully loaded model from results/simple_dqn/best_model.pth
2025-03-17 20:42:22,948 - TrafficRL.Agents.Base - INFO - BaseAgent initialized with state_size=80, action_size=2
2025-03-17 20:42:22,948 - TrafficRL.Agents.PPO - INFO - PPOAgent initialized with state_size=80, action_size=2, device=cpu
2025-03-17 20:42:22,950 - TrafficRL.Agents.PPO - ERROR - Error loading model: Error(s) in loading state_dict for ActorCritic:
	size mismatch for features.0.weight: copying a param with shape torch.Size([256, 80]) from checkpoint, the shape in current model is torch.Size([128, 80]).
	size mismatch for features.0.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for features.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 128]).
	size mismatch for features.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for actor.0.weight: copying a param with shape torch.Size([2, 256]) from checkpoint, the shape in current model is torch.Size([2, 128]).
	size mismatch for critic.weight: copying a param with shape torch.Size([1, 256]) from checkpoint, the shape in current model is torch.Size([1, 128]).
2025-03-17 20:42:22,951 - TrafficRL.Agents.PPO - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/ppo_agent.py", line 272, in load
    self.policy.load_state_dict(checkpoint['policy_state_dict'])
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for ActorCritic:
	size mismatch for features.0.weight: copying a param with shape torch.Size([256, 80]) from checkpoint, the shape in current model is torch.Size([128, 80]).
	size mismatch for features.0.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for features.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 128]).
	size mismatch for features.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for actor.0.weight: copying a param with shape torch.Size([2, 256]) from checkpoint, the shape in current model is torch.Size([2, 128]).
	size mismatch for critic.weight: copying a param with shape torch.Size([1, 256]) from checkpoint, the shape in current model is torch.Size([1, 128]).

2025-03-17 20:42:22,951 - TrafficRL - WARNING - Failed to load model from results/ppo/best_model.pth, skipping
2025-03-17 21:22:36,307 - TrafficRL - INFO - Logging initialized. Log file: logs/log
2025-03-17 21:22:36,309 - TrafficRL - INFO - Random seed set to 42
2025-03-17 21:22:36,324 - TrafficRL.Agent - INFO - Using MPS (Metal Performance Shaders) for Mac acceleration
2025-03-17 21:22:36,324 - TrafficRL.Agent - INFO - Using device: mps
2025-03-17 21:22:36,324 - TrafficRL.Agent - INFO - Using Per-Intersection DQN architecture
2025-03-17 21:22:36,837 - TrafficRL.Agent - INFO - Using prioritized experience replay
2025-03-17 21:22:36,857 - TrafficRL.Agent - INFO - Loaded local network from local_network_state_dict
2025-03-17 21:22:36,857 - TrafficRL.Agent - INFO - Loaded target network from target_network_state_dict
2025-03-17 21:22:36,857 - TrafficRL.Agent - WARNING - Error loading optimizer state: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-03-17 21:22:36,857 - TrafficRL.Agent - INFO - Loaded epsilon: 0.01
2025-03-17 21:22:36,857 - TrafficRL.Agent - INFO - Loaded q-values history
2025-03-17 21:22:36,857 - TrafficRL.Agent - INFO - Model loaded successfully from results/dqn/best_model.pth
2025-03-17 21:22:36,857 - TrafficRL - INFO - Model loaded from results/dqn/best_model.pth
2025-03-17 21:22:36,857 - TrafficRL - INFO - Creating environment visualization: visualizations/traffic_sim_dqn.mp4
2025-03-17 21:22:37,502 - TrafficRL.Agent - ERROR - Error selecting action: index 1 is out of bounds for axis 0 with size 1
2025-03-17 21:22:37,503 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 260, in act
    actions[i] = int(np.argmax(action_values_np[i]))
                               ~~~~~~~~~~~~~~~~^^^
IndexError: index 1 is out of bounds for axis 0 with size 1

2025-03-17 21:22:37,533 - TrafficRL - WARNING - FFmpeg writer failed: 'TrafficSimulation' object has no attribute 'traffic_density'. Trying a different approach.
2025-03-17 21:22:37,547 - TrafficRL.Agent - ERROR - Error selecting action: index 1 is out of bounds for axis 0 with size 1
2025-03-17 21:22:37,550 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 814, in save_visualization
    ani.save(filename, writer=writer)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 260, in act
    actions[i] = int(np.argmax(action_values_np[i]))
                               ~~~~~~~~~~~~~~~~^^^
IndexError: index 1 is out of bounds for axis 0 with size 1

2025-03-17 21:22:37,591 - TrafficRL - ERROR - Failed to save animation: 'TrafficSimulation' object has no attribute 'traffic_density'
2025-03-17 21:22:37,591 - TrafficRL - INFO - Saving individual frames to visualizations/frames...
2025-03-17 21:22:37,595 - TrafficRL.Agent - ERROR - Error selecting action: index 1 is out of bounds for axis 0 with size 1
2025-03-17 21:22:37,599 - TrafficRL.Agent - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 814, in save_visualization
    ani.save(filename, writer=writer)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 820, in save_visualization
    ani.save(filename, fps=fps, dpi=120)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/agents/dqn_agent.py", line 260, in act
    actions[i] = int(np.argmax(action_values_np[i]))
                               ~~~~~~~~~~~~~~~~^^^
IndexError: index 1 is out of bounds for axis 0 with size 1

2025-03-17 21:22:37,610 - TrafficRL - ERROR - Visualization failed: 'TrafficSimulation' object has no attribute 'traffic_density'
2025-03-17 21:22:37,615 - TrafficRL - ERROR - Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 814, in save_visualization
    ani.save(filename, writer=writer)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 820, in save_visualization
    ani.save(filename, fps=fps, dpi=120)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1109, in save
    anim._init_draw()  # Clear the initial frame
    ^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1770, in _init_draw
    self._draw_frame(frame_data)
  File "/Users/alfonsomateos/miniconda3/lib/python3.12/site-packages/matplotlib/animation.py", line 1789, in _draw_frame
    self._drawn_artists = self._func(framedata, *self._args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 831, in save_visualization
    update(i)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 797, in update
    update_main_visualization(frame)
  File "/Users/alfonsomateos/Documents/Polytechnique/M1.2/Autonomous Agents/TrafficRL/traffic_rl/utils/visualization.py", line 400, in update_main_visualization
    ns_density = env.traffic_density[idx, 0]
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TrafficSimulation' object has no attribute 'traffic_density'. Did you mean: 'traffic_config'?

2025-03-17 21:22:37,615 - TrafficRL - ERROR - Failed to create visualization
